---
layout: post
title:  Wi-Fi Pentesting Notes
description: Notes I wrote while watching Wi-Fi pentesting videos by Vivek Ramachandran from Pentester Academy.
date:   2023-01-19 
image:  '/images/wifi.jpg'
tags:   [Wi-Fi, Notes]
---

<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Wi-Fi Pentesting Notes</title>

<style>
.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style>
The PDF version of these notes can be found <a href="https://0xd4y.com/misc/Wi-Fi_Pentesting_Notes.pdf">here.</a>
</head><body><article id="7d71289c-4030-4c7b-9668-298dce547d7e" class="page sans"><header><h1 class="page-title">Wi-Fi Pentesting Notes</h1></header><div class="page-body"><h1 id="047c572c-9c8e-4b25-90ba-2a97bd54bc78" class="">Contact</h1><p id="2836decd-09f0-425a-9d9e-cd7c2e834bb6" class=""><strong><strong><strong><strong><strong><strong><strong><strong><strong>LinkedIn: </strong></strong></strong></strong></strong></strong></strong></strong></strong><a href="https://www.linkedin.com/in/segev-eliezer/">https://www.linkedin.com/in/segev-eliezer/</a></p><p id="457d67dc-6411-4b80-98a6-5d968d84483a" class=""><strong>YouTube</strong>: <a href="https://YouTube.com/@0xd4y">https://YouTube.com/@0xd4y</a> </p><p id="d523ebf1-1e31-4839-bbc1-77bec2a33a5b" class=""><strong><strong><strong><strong>Website: </strong></strong></strong></strong><a href="https://0xd4y.com">https://0xd4y.com</a> </p><p id="f4651c78-82ea-401c-90a0-775f5a7510a1" class=""><strong><strong><strong><strong><strong><strong>GitHub: </strong></strong></strong></strong></strong></strong><a href="https://GitHub.com/0xd4y">https://GitHub.com/0xd4y</a> </p><h1 id="9c0dd53b-4949-4e78-9c4c-ee3e43d3f1c7" class="">Table of Contents</h1><nav id="5014043f-e193-489a-8c43-5cc56e928996" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#047c572c-9c8e-4b25-90ba-2a97bd54bc78">Contact</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#9c0dd53b-4949-4e78-9c4c-ee3e43d3f1c7">Table of Contents</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#b4715e54-dccf-4ef8-bb24-b8fdd74b4cb3">Fragmentation and Hirte Attack </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#91f30dd1-0bda-49e9-bbda-404eae2f3f6d">Fragmentation</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#4c31a3bb-313c-472d-a844-76f9932c8406">Hirte Attack</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#578f8abb-eadc-4b7e-947f-51a7fef35cf2">Hidden SSID</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#a27d3909-38d5-4592-b604-447673f0e406">Detection Techniques</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#5b39154a-9d87-491d-8618-5fba6b6acca2">MAC Filter</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#be32fbd3-3cfa-42b4-8957-89117c97ee5c">WLAN Authentication</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#6b9e6e30-f8cc-401e-b5e2-e96401b3d506">Hotspot Attacks</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#82a3941b-45cc-46d7-ae24-d634eb5ae3f4">Hacking Isolated Clients</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#b84ea68f-77cc-415f-a104-b5a48cdd72c9">Client Authentication to Attacking Machine</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#81f7c537-8d3f-4bd5-ac83-49a586e4c089">MITM</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#8e720825-6268-4478-9d40-eb29843e107a">MITM SSL</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#42f43893-8a77-48e3-a9ef-35e19fdbe0d1">SSID</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b5b9873-8f36-43c2-a137-139637c10516">WEP (Wired Equivalent Privacy) Attacks</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#5959000b-ee52-4531-a777-1ede1d7ff6ce">Replay Attack</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#b5d00a7c-4da7-4857-8634-70715e2be29f">Caffe Latte Attack</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#bd10e671-30df-4ea1-a99e-f34ac1b497cd">Korek&#x27;s ChopChop</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#d5a22266-1a81-4119-9e6f-b2196fb6977b">Wi-Fi Gear</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#e34f6b01-274b-48f9-a72e-8b9f9bfcc649">External Wireless Card</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#5dd9e72e-5c7e-4d47-8794-67cbec35470e">WLAN Headers</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#c21a9d2d-a7fb-433d-95e1-605c25f3b6fb">Terminology</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2a57f38a-69fc-4ae6-9131-c17d691c2452">WLAN Packet Header</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#6ee5195a-7ecd-416e-bc49-d8f9f7ad72bd">Frame Control Field</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#3335e111-f41c-4d98-8990-4667682c907d">Duration / ID</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#47116a5d-b4f6-414c-b0c4-ffeb1a358cdf">Address 1-4</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#7c4edaf1-62f9-4ad8-9f1a-bec30c6e11b3">Sequence Control</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#aec44b3b-d234-46f3-a254-11ba63328aa5">QOS Control</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#9e133d71-2f6b-42e5-864c-b9ef650b9036">Frame Body</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#14549fe5-8bde-41a3-b8d1-75b516f49b90">FCS</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#3ccad7d1-ca6f-4022-bb8d-83c48674b86c">WPA2 -PSK</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#c0139b76-48d0-4690-993d-8f0a0537c497">WPA-PSK</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#cb984586-4d96-487e-9ebc-01fa3926ccfe">Cracking WPA-PSK</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#323bda25-24c4-452a-ae07-d94118ff2034">Dictionary Attack</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#59cc6f47-63c4-4218-bc8a-e39871d52daf">Keys</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#54ef2dc6-b68c-40c1-81af-3ec69131243a">WPA-PSK Authentication Further Explanation</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#e6e96896-eedf-4950-9fa6-a9dda8fadfa0">Detecting Spoofing Attacks</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#66ca8987-f182-4f19-bcca-2a5bec020e04">SSID Spoofing</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#8924ea08-d242-4547-af07-cadb07e098d8">Mac Spoofing</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#25884ae3-b113-4ab6-98cf-59c6643b7492">Wireless IDS and IPS</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#dbe474d1-e3f2-49e2-9432-323071ef92ef">Malicious SSID </a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#0462bf13-21d3-47d5-9fd9-47cc33e313a4">HTML Injection and XSS</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#56901a54-d79d-4327-a07a-f1494e13a424">SQLi</a></div></nav><h1 id="b4715e54-dccf-4ef8-bb24-b8fdd74b4cb3" class="">Fragmentation and Hirte Attack </h1><h2 id="91f30dd1-0bda-49e9-bbda-404eae2f3f6d" class="">Fragmentation</h2><ul id="ed9d282e-c608-4611-89f2-296a73261c8e" class="bulleted-list"><li style="list-style-type:disc">when large frame is to be transmitted but larger than maximum transferrable unit for network, the frame needs to be broken up into fragments</li></ul><ul id="4d3a5a2d-5f24-4711-9ee3-a47b9e477622" class="bulleted-list"><li style="list-style-type:disc">located within the &quot;Sequence Control&quot; header field<ul id="9ec46f73-6ead-4734-97f6-3ce03424534d" class="bulleted-list"><li style="list-style-type:circle">see WLAN Headers</li></ul><figure id="0b92d21f-fdc7-4c28-9325-06cbd5e5f28d" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled.png"><img style="width:1180px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled.png"/></a></figure></li></ul><ul id="c79087e5-4930-4ba8-9da2-797ece0a32e0" class="bulleted-list"><li style="list-style-type:disc">sequence number stays constant, but fragment number changes</li></ul><ul id="e17ee5ef-f5cc-4b0b-99b1-31d3cd57539b" class="bulleted-list"><li style="list-style-type:disc">&quot;more Frag&quot; (more fragmentd) bit set to 1 for all fragmented packets except for the last one!</li></ul><ul id="2808e0ed-453a-49ad-a86a-eccf450121a6" class="bulleted-list"><li style="list-style-type:disc">indicates that more fragment packets are yet to be sent (receiver waits and doesn&#x27;t reassemble packet until this bit set to 0)</li></ul><figure id="916a68e6-8aa3-490b-a0a9-49bb0eaea45a" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%201.png"><img src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%201.png"/></a></figure><h2 id="4c31a3bb-313c-472d-a844-76f9932c8406" class="">Hirte Attack</h2><ol type="1" id="68f456ed-003c-4370-a8ec-5c9886c667be" class="numbered-list" start="1"><li>Setup a fake WEP AP and wait for a client to connect</li></ol><ol type="1" id="b88cb506-20d6-4a60-b66b-d5986a80bf1d" class="numbered-list" start="2"><li>Upon connection of a client waits for auto-configuration IP address</li></ol><ol type="1" id="68092460-69a1-4ea0-aa94-e5f97e608f98" class="numbered-list" start="3"><li>Client sends an ARP packet</li></ol><ol type="1" id="8ac6be1b-86a5-4c66-b197-ea12c210d8d9" class="numbered-list" start="4"><li>Obtain the ARP packet and convert it into an ARP request for the same client<ul id="83ecd968-aaee-4597-8379-a700d67b051e" class="bulleted-list"><li style="list-style-type:disc">relocates IP address in ARP header using fragmentation</li></ul></li></ol><ol type="1" id="5769193c-66d7-4be6-9d25-80f4c5673970" class="numbered-list" start="5"><li>Client replies</li></ol><ol type="1" id="977f90c1-9cec-4a54-825d-933435777d52" class="numbered-list" start="6"><li>Collect these packets</li></ol><ol type="1" id="b7d88bea-a759-4463-87f1-50c2e2609995" class="numbered-list" start="7"><li>Crack the WEP key# Hidden SSID, MAC Filter, and Authentication</li></ol><h2 id="578f8abb-eadc-4b7e-947f-51a7fef35cf2" class="">Hidden SSID</h2><ul id="b2d00090-dfd1-45dc-bc8e-0ed564d8270b" class="bulleted-list"><li style="list-style-type:disc">SSID broadcasting off in beacon frames</li></ul><h3 id="a27d3909-38d5-4592-b604-447673f0e406" class="">Detection Techniques</h3><ol type="1" id="abe2fc8d-443a-4136-9684-42e6bcb5175f" class="numbered-list" start="1"><li>Passive<ul id="99b0a97c-2bc4-429a-924f-c2aa9b980b84" class="bulleted-list"><li style="list-style-type:disc">monitor air for new client trying to associate with access point</li></ul><ul id="78914e3d-0b27-4117-8ffd-700804f7556e" class="bulleted-list"><li style="list-style-type:disc">look for connection to the hidden SSID by monitoring probe and association packets<ul id="e1056954-06d7-4757-871a-1d9557e155cb" class="bulleted-list"><li style="list-style-type:circle">the association and probe packets contain the SSID in the &quot;Tag interpretation&quot; parameter</li></ul></li></ul></li></ol><ol type="1" id="a731e267-6e25-41a7-8526-2188ea3176d2" class="numbered-list" start="2"><li>Active<ul id="3152676c-bdfd-4402-aedc-a826d3f850b6" class="bulleted-list"><li style="list-style-type:disc">de-authenticate one or all clients and monitor reconnections<ul id="75e78c60-0e70-439c-a32b-ef4322161521" class="bulleted-list"><li style="list-style-type:circle">when clients are disconnected, they will try to reconnect and you can get the SSID as described in the &quot;Passive&quot; technique</li></ul></li></ul></li></ol><p id="eb09f443-c87a-490e-afbc-4a00332ddcf7" class=""><strong>How to Deauthenticate</strong></p><figure id="4e20a0e7-ac26-45a7-b8f9-0c69c43b598a" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%202.png"><img style="width:686px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%202.png"/></a></figure><ul id="50c3d218-a86e-4da8-b35d-d6e7a6c2103c" class="bulleted-list"><li style="list-style-type:disc">when client deauthenticates, a management packet called &quot;Deauthentication packet&quot; is sent from AP to client</li></ul><h2 id="5b39154a-9d87-491d-8618-5fba6b6acca2" class="">MAC Filter</h2><ul id="c50f873e-be4b-45de-b532-44a9d29ab8ac" class="bulleted-list"><li style="list-style-type:disc">MAC filter typically used with switches and filtering devices and firewalls<ul id="1b214454-d6a4-42f1-a730-3f2f431311fb" class="bulleted-list"><li style="list-style-type:circle">feature to whitelist MAC address on specific port</li></ul><ul id="6b3ede77-36d7-4298-87ab-80448faf24fe" class="bulleted-list"><li style="list-style-type:circle">MAC can be easily spoofed, so whitelist is not secure</li></ul></li></ul><ul id="292783b2-db7b-45ce-b51f-287b2547d873" class="bulleted-list"><li style="list-style-type:disc">MAC filter is a network layer filter</li></ul><ul id="d7fec6a8-bf5e-4dc7-beed-c3590fe2c6bf" class="bulleted-list"><li style="list-style-type:disc">MAC addresses visible in plain text in WLAN header</li></ul><ul id="600ca0d5-3776-474f-bdea-7628a823e2ef" class="bulleted-list"><li style="list-style-type:disc">some access points use captive portals and add a device to a mac filtering list after it successfully authenticates </li></ul><h2 id="be32fbd3-3cfa-42b4-8957-89117c97ee5c" class="">WLAN Authentication</h2><figure id="9c0ba0c0-9861-426e-9aa8-79cc1f8738e9" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%203.png"><img style="width:683px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%203.png"/></a></figure><ol type="1" id="2fb9296d-4858-43e4-8f80-e67f3702c566" class="numbered-list" start="1"><li>STA asks to authenticate to AP</li></ol><ol type="1" id="7a640b61-5646-4fa6-b6e1-971282b8104c" class="numbered-list" start="2"><li>AP sends challenge response</li></ol><ol type="1" id="d9b45b0a-aa53-407a-8298-d28d78c637f3" class="numbered-list" start="3"><li>STA encrypts challenge with WEP password</li></ol><ol type="1" id="e45a990c-d36f-4973-858c-ca4e4afc8f99" class="numbered-list" start="4"><li>STA decrypts challenge with WEP password. If matches, grant access</li></ol><ul id="a2880eeb-46d4-4b50-a5d2-d3db416cc137" class="bulleted-list"><li style="list-style-type:disc">shared key authentication (SKA) is broken<ul id="380a7ac7-5f3e-4b57-a8ac-714cb6efbe7f" class="bulleted-list"><li style="list-style-type:circle">possible to retrieve the key by reversing XOR operation# Hotspot Attacks and Hacking Isolated Clients (MITM)</li></ul></li></ul><h2 id="6b9e6e30-f8cc-401e-b5e2-e96401b3d506" class="">Hotspot Attacks</h2><ul id="e9e0709a-c4d8-442e-8732-87f12d3ed799" class="bulleted-list"><li style="list-style-type:disc">no encryption</li></ul><p id="cc52867e-8796-44e1-aa11-54b783f98cf4" class=""><span style="border-bottom:0.05em solid">Soft AP</span>: access point created entirely in software</p><ul id="6bfe4d51-e048-4eb1-b95f-400406435ef7" class="bulleted-list"><li style="list-style-type:disc">evil twin<ul id="cd98ba90-e6da-464d-a94e-c2256c82e878" class="bulleted-list"><li style="list-style-type:circle">same ESSID as target (can even set BSSID to be the same)</li></ul><ol type="1" id="cd5ed502-1157-473d-94b3-e03f43ed78f0" class="numbered-list" start="1"><li>Attacker sets up AP with same SSID as target AP then sends deauth packet to victim.</li></ol><ol type="1" id="92d8c38d-ab6a-494f-9718-a38a3f4bf335" class="numbered-list" start="2"><li>After victim is deauthenticated, their computer tries reconnecting to the SSID with same name and highest signal strength.</li></ol><ol type="1" id="25912ba7-b5e0-45de-a799-ee74901c8444" class="numbered-list" start="3"><li>The victim will automatically connect to attacker machine.</li></ol></li></ul><h2 id="82a3941b-45cc-46d7-ae24-d634eb5ae3f4" class="">Hacking Isolated Clients</h2><ul id="6d59b74f-ea90-492a-bfd8-5cce25d006a1" class="bulleted-list"><li style="list-style-type:disc">when client connected to SSID, that SSID is added to preferred network connection list</li></ul><ul id="a84a66a7-f5f5-441e-9601-5c4a6e11c04e" class="bulleted-list"><li style="list-style-type:disc">client automatically connects to known SSIDs<ul id="a768a4b2-ce9b-42c3-8a59-21d04f4bcb03" class="bulleted-list"><li style="list-style-type:circle">client sends probe requests packets to locate known SSIDs in the preferred network connection list<ul id="9ce60d67-1fa9-408a-bbd7-67e0ccc798f2" class="bulleted-list"><li style="list-style-type:square"><span style="border-bottom:0.05em solid">Probe Request Packet</span>: packet meant to locate available networks</li></ul><figure id="9ce313a9-6de0-4f68-9a63-35d38ed64957" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%204.png"><img style="width:692px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%204.png"/></a></figure></li></ul></li></ul><ul id="1fcc8db8-3854-49d7-bef0-1bb3c3d57632" class="bulleted-list"><li style="list-style-type:disc">if true AP has no authentication, then making a malicious AP with same SSID will likely not make the client automatically connect<ul id="e83825ad-f661-44f2-92e8-6f4953db9426" class="bulleted-list"><li style="list-style-type:circle">the client must manually connect to the malicious AP</li></ul></li></ul><h3 id="b84ea68f-77cc-415f-a104-b5a48cdd72c9" class="">Client Authentication to Attacking Machine</h3><ul id="92961228-0576-4560-8bbd-56ee97a49466" class="bulleted-list"><li style="list-style-type:disc">client cannot authenticate AP</li></ul><ul id="acc99393-7dd5-4237-9c05-f59aa34a1bee" class="bulleted-list"><li style="list-style-type:disc">SSID alone used to trust AP</li></ul><ul id="8bd3bc43-4daf-491c-b8c2-e8bdcd2d84d1" class="bulleted-list"><li style="list-style-type:disc">easiest with Hotspot as it is open authentication with no encryption</li></ul><h3 id="81f7c537-8d3f-4bd5-ac83-49a586e4c089" class="">MITM</h3><p id="73e043f5-e911-4e1a-8771-0a3914aea6bb" class="">Man in the middle</p><figure id="d49c97e1-3f2b-460e-b635-304196b1154b" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%205.png"><img style="width:688px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%205.png"/></a></figure><ul id="bdd0ebf3-2243-45d5-b103-0f8d42c4757c" class="bulleted-list"><li style="list-style-type:disc">hacker connected to internet via eth0</li></ul><ul id="8fef303b-5b90-4078-88ab-aa2f6a890089" class="bulleted-list"><li style="list-style-type:disc">hacker has fake AP on mon0</li></ul><ul id="feedfdf7-3a14-443c-891f-8fba4b53b6f3" class="bulleted-list"><li style="list-style-type:disc">create bridge between mon0 and eth0<ul id="1f2c05c1-088b-482f-b3c0-916ab5fb0b71" class="bulleted-list"><li style="list-style-type:circle"><code>brctl addbr &lt;name of bridge&gt;</code></li></ul><ul id="31a95c40-8207-46ae-a5fc-62829de28905" class="bulleted-list"><li style="list-style-type:circle"><code>ifconfig &lt;name of bridge&gt; up</code></li></ul></li></ul><h3 id="8e720825-6268-4478-9d40-eb29843e107a" class="">MITM SSL</h3><ul id="acc8479b-5e95-47fa-acb5-2793bcc0e305" class="bulleted-list"><li style="list-style-type:disc"><code>dnsspoof -i &lt;name of bridge&gt;</code></li></ul><ul id="403c4bf7-08bf-4881-93c7-56d92bb08e76" class="bulleted-list"><li style="list-style-type:disc">victim will connect to spoofed DNS upon a DNS query, because dnsspoof will respond faste than true DNS</li></ul><ul id="62ca57b2-0fa4-49aa-a6f3-f8a2eb37cb02" class="bulleted-list"><li style="list-style-type:disc">attack works even through SSL, as client&#x27;s requests are being encrypted using spoofed cert which is then decrypted by the hacker (note the hacker knows the encryption as they signed the certificate), and then the traffic is forward to the requested resource using the requested resource&#x27;s certificate<ul id="4e831cdf-d84d-4832-905e-4d15e8a2614b" class="bulleted-list"><li style="list-style-type:circle">this same traffic works in the reverse process when the requested resource responds to the request and sends the traffic back to the victim</li></ul><figure id="fe603913-bc53-45a7-b2d5-42220d76bbc6" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%206.png"><img style="width:687px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%206.png"/></a></figure><ul id="23cf1c33-b898-4f22-a660-e2d532e6f3c4" class="bulleted-list"><li style="list-style-type:circle">note that there is a certificate error on victim device (due to BurpSuite using self-generated certificate instead of certificate of requested service)# Misc Information</li></ul></li></ul><h2 id="42f43893-8a77-48e3-a9ef-35e19fdbe0d1" class="">SSID</h2><ul id="2ae65994-9ae7-4ad8-b807-1a3fa5e6a023" class="bulleted-list"><li style="list-style-type:disc">service set identifier (SSID)</li></ul><ul id="3dea07b0-dc3b-4d2a-ab5f-b81a36d56026" class="bulleted-list"><li style="list-style-type:disc">name given to an access point or network consisting of multiple access points</li></ul><ul id="7c2135e9-bd9d-4d85-833e-40e8b58fda28" class="bulleted-list"><li style="list-style-type:disc">beacon frames a.k.a broadcast frames are sent by access points to broadcast presence in current RF vicinity<ul id="d520ebcb-ab64-4bca-8a8d-ae77180ac7b7" class="bulleted-list"><li style="list-style-type:circle">this is how your computer finds nearby Wi-Fi networks to connect to</li></ul></li></ul><ul id="39ef0467-c1d6-47ec-9157-956d3ef05c0c" class="bulleted-list"><li style="list-style-type:disc">using MDK3 tool, it is possible to spoof a network by sending beacon frames (it even appears as high signal strength)<ul id="afd754b1-2d02-4840-b6e6-4f0bf44acd96" class="bulleted-list"><li style="list-style-type:circle">easy to spoof 802.11 frames because there is no encryption# Network Devices
<span style="border-bottom:0.05em solid">OSI</span></li></ul></li></ul><ul id="9583e8aa-dd3a-47ed-ab5e-49c053e94754" class="bulleted-list"><li style="list-style-type:disc">open systems interconnection model</li></ul><ul id="ef485b32-98f0-4b6a-a545-77d2abd3bba7" class="bulleted-list"><li style="list-style-type:disc">seven layers:<ol type="1" id="236654ab-5444-473b-8973-1bb4f75fa350" class="numbered-list" start="1"><li>Physical</li></ol><ol type="1" id="547a0b4e-62bb-459c-b1e6-3886e459d494" class="numbered-list" start="2"><li>Data Link</li></ol><ol type="1" id="85c08cad-f4e2-4272-9265-2ec97acd0e53" class="numbered-list" start="3"><li>Network</li></ol><ol type="1" id="ff8f131e-ee5f-43d6-a77b-f116fd708474" class="numbered-list" start="4"><li>Transport</li></ol><ol type="1" id="44b49793-4c76-48e6-8b74-76b76bfe7f4c" class="numbered-list" start="5"><li>Session</li></ol><ol type="1" id="77d54f72-0b93-4a15-b3e6-42fde735962b" class="numbered-list" start="6"><li>Presentation</li></ol><ol type="1" id="18eff5fb-4628-4583-867a-8f64497d4b12" class="numbered-list" start="7"><li>Application</li></ol></li></ul><p id="3bad9008-46f0-45f0-a4b0-987afe274bea" class=""><span style="border-bottom:0.05em solid">Switch</span></p><ul id="3b69293d-5651-4ee8-9423-b3f8c66fa0ae" class="bulleted-list"><li style="list-style-type:disc">layer 2 OSI device</li></ul><ul id="4abf07aa-4256-443b-b095-a8a066ce3015" class="bulleted-list"><li style="list-style-type:disc">only communicate with local network devices</li></ul><ul id="2bbfbe74-0243-4ce4-af1a-b0f91eaa2209" class="bulleted-list"><li style="list-style-type:disc">uses application-specific integrated circuit (ASIC) chip<ul id="441a6e50-4162-480c-a998-014943022f66" class="bulleted-list"><li style="list-style-type:circle">ASIC chip tells switch which ports a device is connected to</li></ul></li></ul><p id="2e072943-b5e6-4159-b77d-6e3a22ab068a" class=""><span style="border-bottom:0.05em solid">WAP</span></p><ul id="59b6be11-9007-48bd-bf17-70a7441d1538" class="bulleted-list"><li style="list-style-type:disc">wireless access point</li></ul><ul id="8d64cca5-4657-4bf8-bc59-f2bc0396179e" class="bulleted-list"><li style="list-style-type:disc">layer 2 OSI device</li></ul><ul id="5273e8a4-252f-47c0-a160-eb0ab5f947f8" class="bulleted-list"><li style="list-style-type:disc">only communicates with local network devices</li></ul><p id="8818166e-245c-452e-9566-c4910c5ea497" class=""><span style="border-bottom:0.05em solid">MLS</span></p><ul id="1b9c3e2d-0653-454f-bb7a-80cbef2cf1e3" class="bulleted-list"><li style="list-style-type:disc">multilayer switch</li></ul><ul id="b65c16a1-28e1-47ff-aa8c-32c344af4996" class="bulleted-list"><li style="list-style-type:disc">provides layer 2 switching services and layer 3 or high OSI model services</li></ul><ul id="eb363de6-57a7-4cd6-a083-8083aabc42bb" class="bulleted-list"><li style="list-style-type:disc">most common MLS is layer 3 switch</li></ul><ul id="3a9576e7-e088-483f-90b2-20de053dcb2d" class="bulleted-list"><li style="list-style-type:disc">uses ASIC chip for switching and handling routing functions</li></ul><p id="9a28cc5c-64d8-4b55-812a-969e3af3c9ed" class=""><span style="border-bottom:0.05em solid">Router</span></p><ul id="90bb9be4-80d7-4bcb-96a7-537b2c4b4421" class="bulleted-list"><li style="list-style-type:disc">layer 3 OSI device</li></ul><ul id="b9f63ed0-c88d-494a-8104-95d8a14a6e7b" class="bulleted-list"><li style="list-style-type:disc">uses software for decision making</li></ul><p id="f3ea8a14-7f3a-46d2-b620-7e4d1799ec60" class=""><span style="border-bottom:0.05em solid">Firewall</span></p><ul id="346f72bb-1c24-4305-a3c4-be2472407ea8" class="bulleted-list"><li style="list-style-type:disc">can be software based or network appliance</li></ul><ul id="4313601f-8821-4895-8a4b-1f46db040f86" class="bulleted-list"><li style="list-style-type:disc">functions at multiple OSI model layers (usually 2,3,4, and 7)</li></ul><ul id="769a8a33-dc52-4f36-8c84-af47e3f606c0" class="bulleted-list"><li style="list-style-type:disc">blocks packets in 2 different ways:<ul id="8762d4d3-a4d1-4b8d-b2f3-d89ee7312931" class="bulleted-list"><li style="list-style-type:circle"><em>Stateless inspection</em>: examines every packet against set of rules</li></ul><ul id="07a36ab7-5b20-44e1-9b3d-10d971d81560" class="bulleted-list"><li style="list-style-type:circle"><em>Stateful Inspection</em>: examines state of connection between networks as general rules (e.g. firewall blocks any outgoing traffic on port xxxx)</li></ul></li></ul><p id="c51a85c0-5463-422c-9735-c1a2bfab589c" class=""><span style="border-bottom:0.05em solid">Load Balancer</span></p><ul id="285d0a1a-cb75-4ca4-a740-dd24d29744ed" class="bulleted-list"><li style="list-style-type:disc">also called content switch or content filter</li></ul><ul id="4202538b-915c-4641-b99d-4dcc1f0360f1" class="bulleted-list"><li style="list-style-type:disc">used to ensure no single gets overloaded with traffic</li></ul><p id="25cf97a5-f393-489a-a7ef-7d1dda52953c" class=""><span style="border-bottom:0.05em solid">Proxy Server</span></p><ul id="bac12d47-4a19-46a7-8675-d263aaac6698" class="bulleted-list"><li style="list-style-type:disc">often used to retrieve resources from outside untrusted networks<ul id="350d73c6-784d-4c6d-ab5b-554765e1d896" class="bulleted-list"><li style="list-style-type:circle">can also be used to filter allowed content# Useful Links
<a href="https://bootcamps.pentesteracademy.com/course/wifi-pentesting-july-21">Syllabus</a><a href="https://www.youtube.com/watch?v=BWILgDt6jz0">Sequence Number</a></li></ul></li></ul><h1 id="2b5b9873-8f36-43c2-a137-139637c10516" class="">WEP (Wired Equivalent Privacy) Attacks</h1><ul id="38ac54e9-2861-4ed9-a7aa-2720cf3bd017" class="bulleted-list"><li style="list-style-type:disc">first encryption scheme for Wi-Fi</li></ul><ul id="59b08d49-33b5-49a7-aa22-5c38dbac67b8" class="bulleted-list"><li style="list-style-type:disc">insecure (uses RC4 encryption)<ul id="9a045da6-b1ff-4aaf-801a-9f7323540c0f" class="bulleted-list"><li style="list-style-type:circle">symmetric encryption (transmitter and receiver have identical key for decrypting and encrypting)</li></ul><ul id="55e3907d-1314-43b2-8793-08316b20245e" class="bulleted-list"><li style="list-style-type:circle">possible to tamper data<figure id="ffee5c66-cf92-4e99-809f-be410d72758a" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%207.png"><img style="width:637px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%207.png"/></a></figure></li></ul></li></ul><ul id="808eaf7f-603d-4387-b279-299cedfc02af" class="bulleted-list"><li style="list-style-type:disc">check &quot;Protected flag&quot; to see if it is set (if set that means encryption is in place)
Example of encrypted package:</li></ul><figure id="a2b5182e-3cad-4c1d-afad-8e1363b9d185" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%208.png"><img style="width:685px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%208.png"/></a></figure><h2 id="5959000b-ee52-4531-a777-1ede1d7ff6ce" class="">Replay Attack</h2><ul id="dce45b95-6429-4c75-93ed-4d5e4a5d1f62" class="bulleted-list"><li style="list-style-type:disc">noisy and easily detectable</li></ul><ul id="5d217054-8149-4236-8a30-98a094486356" class="bulleted-list"><li style="list-style-type:disc">encrypted ARP packet can be identified due to its fixed length<ul id="bf518cba-4354-4c76-b998-f9fab3a50ade" class="bulleted-list"><li style="list-style-type:circle">these ARP packets are captured by hacker and constantly replayed to AP until the AP responds with enough weak IVs in the ARP responses to crack the key</li></ul><figure id="83b717b8-c4a0-4d1f-8e0c-24184e5f911f" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%209.png"><img style="width:692px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%209.png"/></a></figure></li></ul><h2 id="b5d00a7c-4da7-4857-8634-70715e2be29f" class="">Caffe Latte Attack</h2><ul id="f7c110c7-7a41-43c8-a47e-d731a60bdcf2" class="bulleted-list"><li style="list-style-type:disc">this scenario assumes that the regular AP on which the client connects to contains a WEP key in its PNL</li></ul><ol type="1" id="0291d44b-1728-4759-bfa9-3c2e8ee9ec19" class="numbered-list" start="1"><li>set up AP (evil twin) and deauth client</li></ol><ol type="1" id="c0a8b5c5-01e8-4cc5-a2d1-45d7196bc307" class="numbered-list" start="2"><li>client tries to reconnect to AP with same SSID and highest signal strength</li></ol><ol type="1" id="ad129745-d9a8-4eb1-97df-7e04e77e8d1a" class="numbered-list" start="3"><li>WEP key sent by client to malicious AP</li></ol><ol type="1" id="a295268d-213f-4a81-be94-16b97816d322" class="numbered-list" start="4"><li>malicious AP accepts all WEP keys and grants authentication</li></ol><h2 id="bd10e671-30df-4ea1-a99e-f34ac1b497cd" class="">Korek&#x27;s ChopChop</h2><ul id="06ea7030-019d-4b70-a47e-e8835c2a3de6" class="bulleted-list"><li style="list-style-type:disc">last byte of encrypted data packet is chopped off. The byte of the data is then guessed and ICV is calculated. If guess is correct, ICV matches and encrypted data is accepted<ul id="40988e6e-ac84-4b94-957c-1324f0a721ce" class="bulleted-list"><li style="list-style-type:circle">process is repeated for all the bytes of the encrypted packet to obtain the full packet</li></ul><figure id="f425e626-666f-430b-bd87-0351f1df715c" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2010.png"><img style="width:668px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2010.png"/></a></figure></li></ul><h1 id="d5a22266-1a81-4119-9e6f-b2196fb6977b" class="">Wi-Fi Gear</h1><h2 id="e34f6b01-274b-48f9-a72e-8b9f9bfcc649" class="">External Wireless Card</h2><ul id="de925059-4292-4a75-ab40-8faec71b22f9" class="bulleted-list"><li style="list-style-type:disc">allows for packet sniffing and packet injection</li></ul><ul id="c04fedc4-517c-422d-bc0a-780559b9114e" class="bulleted-list"><li style="list-style-type:disc">wireless cards can only be on one channel at a time# Wi-Fi Sniffing</li></ul><ul id="807fc4cb-2e0c-4cd3-bb57-52d894ce13db" class="bulleted-list"><li style="list-style-type:disc">WLANS operate in 3 different frequencies:<ol type="1" id="a4609e78-419e-4cf5-ba12-94b5f6ce2e5d" class="numbered-list" start="1"><li>2.4 GHz (802.11b/g/n)</li></ol><ol type="1" id="e7b2e3a2-65ea-4531-9b8f-0ac69d316dd4" class="numbered-list" start="2"><li>3.6 GHz (802.11y)</li></ol><ol type="1" id="3a3f0e57-bb25-473d-b36e-bc4d52189f7f" class="numbered-list" start="3"><li>3.9/5.0 GHz (802.11a/h/j/n)</li></ol></li></ul><ul id="c2fcabb1-4bd6-4502-b810-556f701969d3" class="bulleted-list"><li style="list-style-type:disc">3 types of WLAN packets:<ol type="1" id="62fe315c-c9e1-41ac-abdc-7caf782f47ff" class="numbered-list" start="1"><li>Management</li></ol><ol type="1" id="09546dca-295a-48b1-b342-fe22e43e545c" class="numbered-list" start="2"><li>Control</li></ol><ol type="1" id="bf860c86-e900-41ec-b8d2-10e640f1ab20" class="numbered-list" start="3"><li>Data</li></ol></li></ul><h1 id="5dd9e72e-5c7e-4d47-8794-67cbec35470e" class="">WLAN Headers</h1><h2 id="c21a9d2d-a7fb-433d-95e1-605c25f3b6fb" class="">Terminology</h2><p id="f971752e-b308-4c7b-81bb-c29c97ce9417" class=""><span style="border-bottom:0.05em solid">Ad Hoc Network</span></p><ul id="6af8f5b0-f4ee-41d6-bf89-fac9a5f35be1" class="bulleted-list"><li style="list-style-type:disc">decentralized network</li></ul><ul id="e2c9014e-ef18-4d98-a392-ead2e67a1692" class="bulleted-list"><li style="list-style-type:disc">devices communicate directly with each other instead of using bridge (e.g. access point)</li></ul><ul id="9be6c17d-b700-4aea-a0aa-b03f34364f13" class="bulleted-list"><li style="list-style-type:disc">communicates peer to peer (which is why ad hoc is also called peer to peer mode)</li></ul><ul id="764c13de-60f5-461c-acdd-2106b366f1bf" class="bulleted-list"><li style="list-style-type:disc">cheap and quick, but performance decreases as more users join network</li></ul><ul id="7ff076fe-94d2-487b-bb2d-8184200a624d" class="bulleted-list"><li style="list-style-type:disc">can have some security risks</li></ul><p id="45d600c7-2ab1-458d-8cb6-3bcff4772126" class=""><span style="border-bottom:0.05em solid">Infrastructure Network</span></p><ul id="c9419a2d-dc34-4349-a68a-cce5557fce71" class="bulleted-list"><li style="list-style-type:disc">communicate with access point (typically covers between 100 to 200 feet)</li></ul><ul id="18429dc8-9183-4062-a2ff-f66b1562f3d5" class="bulleted-list"><li style="list-style-type:disc">centralized network</li></ul><ul id="852fa3f0-4718-4bcc-8717-adb669e48e3f" class="bulleted-list"><li style="list-style-type:disc">requires constant administration</li></ul><p id="fc0eda7b-3bc7-4590-bc64-9d89df442b38" class=""><span style="border-bottom:0.05em solid">STA</span>: STAtion (wireless client)
<span style="border-bottom:0.05em solid">BSS</span>: set of wireless client nodes communicating with each other</p><ul id="16da4f93-6e02-4e6a-889c-d19871305891" class="bulleted-list"><li style="list-style-type:disc">two types</li></ul><ul id="a5c71920-bf09-4c91-bee5-afa0bea53cd2" class="bulleted-list"><li style="list-style-type:disc">infrastructure BSS (AP and clients)</li></ul><ul id="e9722a73-6d4d-4fe1-bac2-7482ef9a597b" class="bulleted-list"><li style="list-style-type:disc">independent BSS (Ad-Hoc Client)</li></ul><figure id="3f6f10c7-de16-4c23-ae58-6a40ec30143e" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2011.png"><img style="width:688px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2011.png"/></a></figure><p id="96743fdd-c422-4f88-bb22-69bd06293996" class=""><span style="border-bottom:0.05em solid">ESS</span>: set of connected BSSs
<span style="border-bottom:0.05em solid">BSSID</span></p><ul id="98c49231-2abc-45fe-9a30-79f7bf3be622" class="bulleted-list"><li style="list-style-type:disc">basic service set identifier</li></ul><ul id="5ba744fc-ec9d-4112-833c-36c98add0279" class="bulleted-list"><li style="list-style-type:disc">in the case of an infrastructure BSS it is the MAC address of AP</li></ul><ul id="d85aa5a7-8c61-420e-b5a5-fb51b15c6119" class="bulleted-list"><li style="list-style-type:disc">in the case of an IBSS (independent BSS) it is the randomly chosen MAC address</li></ul><p id="2ffedfc8-ebc1-449a-981e-f4e5c45faf62" class=""><span style="border-bottom:0.05em solid">Distribution System (DSU):</span>  connects APs in an ESS</p><h2 id="2a57f38a-69fc-4ae6-9131-c17d691c2452" class="">WLAN Packet Header</h2><h3 id="6ee5195a-7ecd-416e-bc49-d8f9f7ad72bd" class="">Frame Control Field</h3><ul id="e60e7da3-d244-49c4-8a97-ba6f13c958d9" class="bulleted-list"><li style="list-style-type:disc">header starts at frame control which is two bytes (as opposed to two bits)
</li></ul><figure id="7671ba78-0888-4d96-b360-66b3754c6936" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2012.png"><img style="width:682px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2012.png"/></a></figure><p id="65111c8f-fdbe-4aa4-9fda-55fc3018fc94" class=""><span style="border-bottom:0.05em solid">Protocol</span></p><ul id="d90e0fbd-6f10-4a83-b1d2-74b10c21dba3" class="bulleted-list"><li style="list-style-type:disc">default to 0 value (may change when a major revision is incompatible with a previous version)</li></ul><p id="1f2f8ae3-4785-4545-a6a0-4d67e0e36a82" class=""><span style="border-bottom:0.05em solid">Type and Sub Type</span></p><ul id="4a1c4246-15ae-49cc-af12-42265b4874da" class="bulleted-list"><li style="list-style-type:disc">type<ul id="a9e66be7-67cf-40a0-bd48-779a0a36afa9" class="bulleted-list"><li style="list-style-type:circle">management, control, and data frames (each one of these has a sub type)<ul id="4d8bb9cb-56e2-4192-94ce-013ae702331e" class="bulleted-list"><li style="list-style-type:square">note each one of these fields is a bit</li></ul></li></ul></li></ul><p id="b1ea7d0c-2788-4544-8fe8-5d7d51a3bf93" class=""><span style="border-bottom:0.05em solid">To and From DS</span></p><p id="0759ab1c-d1ed-4780-b3bf-2759f4b492cd" class=""><span style="border-bottom:0.05em solid">Retry Bit</span></p><ul id="f1c4c672-288f-4623-8d30-f3ea03c3579a" class="bulleted-list"><li style="list-style-type:disc">retry bit indicates if current frame is a retransmission</li></ul><ul id="a938524e-1ae2-450a-89f7-6fc3aa72738a" class="bulleted-list"><li style="list-style-type:disc">applicable only to management and data frames</li></ul><p id="e2299b0c-c540-413b-84b1-7da1ed5ff5eb" class=""><span style="border-bottom:0.05em solid">Power Management</span></p><ul id="e36f087b-fb92-4279-90b8-c103b2bc968e" class="bulleted-list"><li style="list-style-type:disc">indicates if STA is in power save mode or active mode</li></ul><p id="a5e3bd5a-6530-4a8c-aa08-28ffe907c631" class=""><span style="border-bottom:0.05em solid">More Data</span></p><ul id="09d77f9c-d88e-4fa8-bcfa-425df68ca4e5" class="bulleted-list"><li style="list-style-type:disc">indicates to STA in power save mode that more data is to follow<ul id="9d497901-e009-4be8-b23a-3c68f458bdfd" class="bulleted-list"><li style="list-style-type:circle">such as in situations when data is to be sent, but sender is low on battery</li></ul></li></ul><ul id="68cd7369-080b-4090-b5d7-f02f58d7c02b" class="bulleted-list"><li style="list-style-type:disc">data is queued up on AP</li></ul><p id="610b98ac-30d6-4254-b51d-bab84299ede5" class=""><span style="border-bottom:0.05em solid">Protected Frame</span></p><ul id="a5ddb4cc-158c-435f-8ee5-0db76a71f7ba" class="bulleted-list"><li style="list-style-type:disc">1 indicates Frame Body is encrypted<ul id="cf535a5e-8cfd-49cd-86df-5833c56ea3fd" class="bulleted-list"><li style="list-style-type:circle">applicable to data frames and management frames of type authentication</li></ul></li></ul><ul id="bb6c60cb-a0fe-4a3c-b85d-b8ed139a6af1" class="bulleted-list"><li style="list-style-type:disc">0 indicates no encryption</li></ul><p id="a8adde8b-98a6-47fe-9d49-a54a6b797169" class=""><span style="border-bottom:0.05em solid">Order</span></p><ul id="f6fe9e43-8a33-42ac-8d34-cbb45275c748" class="bulleted-list"><li style="list-style-type:disc">indicates that all received frames must be processed in order</li></ul><h3 id="3335e111-f41c-4d98-8990-4667682c907d" class="">Duration / ID</h3><ul id="7e8d3ad1-7639-49c2-ae5b-73007b9ab1ab" class="bulleted-list"><li style="list-style-type:disc">slash is there to indicate that this field could be used either as a duration field or ID field</li></ul><ul id="b51674e7-713f-4a97-8b18-9085d9a93929" class="bulleted-list"><li style="list-style-type:disc">duration field used to set Network Allocation Vector (NAV)<ul id="aecc2897-64b0-46da-809c-fa868a6a923f" class="bulleted-list"><li style="list-style-type:circle">NAV is the minimum amount of time a STA needs to wait before attempting transmission</li></ul></li></ul><h3 id="47116a5d-b4f6-414c-b0c4-ffeb1a358cdf" class="">Address 1-4</h3><ul id="b3e1397b-f16d-48c6-912a-c9a8a62ffa1d" class="bulleted-list"><li style="list-style-type:disc">WLAN has more than one address<ul id="a25b18e2-1370-404f-8c6a-a2240f003938" class="bulleted-list"><li style="list-style-type:circle">Source Address</li></ul><ul id="d02e3440-e2b6-4db0-97fa-e6be97de43e5" class="bulleted-list"><li style="list-style-type:circle">Destination Address</li></ul><ul id="8cdbe45d-dbe5-4ff4-af65-9a244a3e1d05" class="bulleted-list"><li style="list-style-type:circle">BSSID</li></ul><ul id="61ec382f-c18e-4176-b3ff-d3d72b98e070" class="bulleted-list"><li style="list-style-type:circle">Address 4 is used in a WDS</li></ul></li></ul><ul id="4149ceb7-0ebe-4073-9bb4-71d6112acccc" class="bulleted-list"><li style="list-style-type:disc">value and presence of addresses 2-4 depend on type / subtype</li></ul><h3 id="7c4edaf1-62f9-4ad8-9f1a-bec30c6e11b3" class="">Sequence Control</h3><ul id="b94e152f-31d3-4001-8d87-cb04b000bc50" class="bulleted-list"><li style="list-style-type:disc">broken up into two fields:<ol type="1" id="628fde25-e955-4c87-aada-59d23c831312" class="numbered-list" start="1"><li>Sequence number of packet<ul id="74093e4b-e83f-4bbf-aae4-ddb78cb9c2ad" class="bulleted-list"><li style="list-style-type:disc">number of packet transmitted by wireless entity</li></ul><ul id="c6f07cc4-6afa-45a3-a9ed-73fda12c32e5" class="bulleted-list"><li style="list-style-type:disc"><a href="https://www.youtube.com/watch?v=BWILgDt6jz0">Sequence Number</a></li></ul></li></ol><ol type="1" id="7c4d97fc-c1e7-4406-90b7-49b56d0c7d1c" class="numbered-list" start="2"><li>Fragment number of packet<ul id="a63ccb17-df7f-438a-a17f-bf2963aaa728" class="bulleted-list"><li style="list-style-type:disc">which fragment is current frame of larger packet (if applicable)</li></ul></li></ol></li></ul><h3 id="aec44b3b-d234-46f3-a254-11ba63328aa5" class="">QOS Control</h3><ul id="21701b92-d2d2-4396-a527-9e30fc4d01fb" class="bulleted-list"><li style="list-style-type:disc">quality of service related</li></ul><h3 id="9e133d71-2f6b-42e5-864c-b9ef650b9036" class="">Frame Body</h3><ul id="b81b7e62-db95-4952-8bad-07731f6f2cc8" class="bulleted-list"><li style="list-style-type:disc">contains data payload<ul id="3b1c3991-e74d-4c7d-a437-e95ce834dbe6" class="bulleted-list"><li style="list-style-type:circle">can contain management subheader of packet</li></ul></li></ul><ul id="6347dc88-708b-4754-b61f-9b4474b5f8bf" class="bulleted-list"><li style="list-style-type:disc">consists of Logical-Link Control (LLC) and Address Resolution Protocol (ARP)</li></ul><h3 id="14549fe5-8bde-41a3-b8d1-75b516f49b90" class="">FCS</h3><ul id="525a24ff-c177-4dda-a4fe-e83c3d9b31c7" class="bulleted-list"><li style="list-style-type:disc">Cyclic Redundancy Check (CRC) over MAC header and Frame Body<ul id="2fa62a57-c450-4ab5-8b17-f7a564d16f4d" class="bulleted-list"><li style="list-style-type:circle">detects accidental changes to raw data</li></ul></li></ul><ul id="84921975-b5c2-4d44-9dff-00ec14f43233" class="bulleted-list"><li style="list-style-type:disc">4 bytes</li></ul><h1 id="3ccad7d1-ca6f-4022-bb8d-83c48674b86c" class="">WPA2 -PSK</h1><ul id="03c259bd-cfc4-44d8-86ea-8ae46355ef40" class="bulleted-list"><li style="list-style-type:disc">encryption algorithm in the probe response</li></ul><ul id="19083610-79f1-4a1b-bb5d-10e25ee602f2" class="bulleted-list"><li style="list-style-type:disc">method of cracking is the same as in WPA-PSK<ul id="96dff5e5-4d3f-44b8-a9ec-21b9757489fb" class="bulleted-list"><li style="list-style-type:circle">just as vulnerable as WPA-PSK if weak password is chosen	#</li></ul></li></ul><h1 id="c0139b76-48d0-4690-993d-8f0a0537c497" class="">WPA-PSK</h1><ul id="ac5491a2-e589-4d70-be78-5ae399ac064d" class="bulleted-list"><li style="list-style-type:disc">used for personal use typically</li></ul><ul id="b1660c0e-896d-452a-acf9-626b585a1b5f" class="bulleted-list"><li style="list-style-type:disc">based on WEP</li></ul><ul id="e00a5d8c-0275-4990-8a44-e11d9dad2730" class="bulleted-list"><li style="list-style-type:disc">uses TKIP (encryption method)</li></ul><ul id="919023aa-65c7-406c-be35-76183b649c8f" class="bulleted-list"><li style="list-style-type:disc">personal networks typically use PSK while enterprise uses 802.1x + Radius
<span style="border-bottom:0.05em solid">PTK (Pairwise Transit Key)</span></li></ul><ul id="2cc9e9f1-31ff-477b-96a5-6858a0261483" class="bulleted-list"><li style="list-style-type:disc">used for encryption of packets between client and AP</li></ul><p id="3b4bdc0c-4296-4ecc-926c-002e80e870d8" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.2/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>T</mi><mi>K</mi><mo>=</mo><mi>P</mi><mi>M</mi><mi>K</mi><mo>+</mo><mi>A</mi><mi>N</mi><mi>O</mi><mi>N</mi><mi>C</mi><mi>E</mi><mo>+</mo><mi>S</mi><mi>N</mi><mi>O</mi><mi>N</mi><mi>C</mi><mi>E</mi><mo>+</mo><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mi>A</mi><mi>A</mi><mo stretchy="false">)</mo><mo>+</mo><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mi>S</mi><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">PTK = PMK + ANONCE + SNONCE + MAC(AA) + MAC(SA)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">PT</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">PM</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05764em;">NONCE</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">SNONCE</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal">AA</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span></span><span>﻿</span></span></p><ul id="74dc088f-ae80-4641-8690-77067dffe8a6" class="bulleted-list"><li style="list-style-type:disc">PMK (Pairwise Master Key): comprised of SSID and passphrase</li></ul><ul id="eb21008a-f799-43a3-acac-3403abae2dd2" class="bulleted-list"><li style="list-style-type:disc">ANONCE: random number AP has made<ul id="b833d159-b89b-48c2-aa7d-dee8fd4d547a" class="bulleted-list"><li style="list-style-type:circle">present in packets 1 and 3</li></ul></li></ul><ul id="3209136a-0c51-40e6-9074-06d1e289600e" class="bulleted-list"><li style="list-style-type:disc">SNONCE: random number client has made<ul id="9cbbef32-5d90-4b7d-9ece-81137d1b24d6" class="bulleted-list"><li style="list-style-type:circle">present in packet 2</li></ul></li></ul><ul id="8a4e43c1-9aa4-449c-be80-bd4f26a55fe6" class="bulleted-list"><li style="list-style-type:disc">MAC(AA): MAC address of AP (authenticator)</li></ul><ul id="064d9a58-e231-4910-95db-5beb7fbadd40" class="bulleted-list"><li style="list-style-type:disc">MAC(SA): MAC address of client (supplicant)<ul id="efa5aff4-d1a9-46fc-a011-735b8c8d1283" class="bulleted-list"><li style="list-style-type:circle">MAC(AA) and MAC(SA) present in all packets</li></ul></li></ul><h2 id="cb984586-4d96-487e-9ebc-01fa3926ccfe" class="">Cracking WPA-PSK</h2><h3 id="323bda25-24c4-452a-ae07-d94118ff2034" class="">Dictionary Attack</h3><figure id="5ff53d53-656f-4747-956d-61765138970e" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2013.png"><img style="width:692px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2013.png"/></a></figure><ul id="cfab77a2-a3a0-4bb8-8a8f-36b96b09db3d" class="bulleted-list"><li style="list-style-type:disc">reconstruct the MIC using the PTK, if MIC matches the one in packet, then the PTK is correct and the passphrase was successfully guessed
<span style="border-bottom:0.05em solid">MIC (Message Integrity Code)</span>
Value dependent on following parameters:<ol type="1" id="cd03405b-53fc-4b6a-90d1-d6ea7f0daa76" class="numbered-list" start="1"><li>message body</li></ol><ol type="1" id="04c0bf01-f979-4def-ac00-f53a7d0afc17" class="numbered-list" start="2"><li>PTK</li></ol></li></ul><h2 id="59cc6f47-63c4-4218-bc8a-e39871d52daf" class="">Keys</h2><pre id="f9b29285-6fb6-467a-9a01-9ba660ff1df3" class="code code-wrap"><code>#! /usr/bin/env python
from pbkdf2 import PBKDF2

ssid = raw_input(&#x27;SSID: &#x27;)
passphrase = raw_input(&#x27;Passphrase: &#x27;)

print (&quot;Pairwise Master Key: &quot; + PBKDF2(passphrase, ssid, 4096).read(32).encode(&quot;hex&quot;))
</code></pre><ul id="7d69cb1a-8daa-4175-a257-590dbc292dd4" class="bulleted-list"><li style="list-style-type:disc">PBKDF2 takes in the following five parameters:<ol type="1" id="d8bb94bd-19c9-484b-8502-0b976223f64e" class="numbered-list" start="1"><li>Passphrase</li></ol><ol type="1" id="aed4bacf-70ee-4c8e-8165-79608258e805" class="numbered-list" start="2"><li>SSID of AP</li></ol><ol type="1" id="2efe1916-605d-485b-96a2-13346ab2dd90" class="numbered-list" start="3"><li>SSID length</li></ol><ol type="1" id="87fd9714-22a1-4ea7-b5aa-b56646bdb3f1" class="numbered-list" start="4"><li>4096 - number of times passphrase is hashed</li></ol><ol type="1" id="b3003433-bee9-4f2a-894e-fc70648a44f8" class="numbered-list" start="5"><li>256 - intended key length of PSK (in bits)</li></ol></li></ul><ul id="15292681-618e-43fb-a97c-385e47fec3d7" class="bulleted-list"><li style="list-style-type:disc">WPA uses dynamic keys for encryption<ul id="420b2cd0-7511-400f-bcab-f73427ea215d" class="bulleted-list"><li style="list-style-type:circle">keys generated on per connection basis</li></ul></li></ul><ul id="a1de7796-1d53-4fde-9800-5e9001a1164f" class="bulleted-list"><li style="list-style-type:disc">in WPA and WPA2 personal, the PSK and PMK is the same</li></ul><h3 id="54ef2dc6-b68c-40c1-81af-3ec69131243a" class="">WPA-PSK Authentication Further Explanation</h3><figure id="2d29d392-4428-4bea-a766-0ab496a81b41" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2014.png"><img style="width:695px" src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2014.png"/></a></figure><ol type="1" id="aeaf7832-8c83-4bbc-9e23-afed539a7710" class="numbered-list" start="1"><li>Supplicant enters password and through the password a PSK is derived<ul id="8fdd842c-8186-4d17-8d5c-bd0d4b19cce9" class="bulleted-list"><li style="list-style-type:disc">note AP already has a PSK because AP knows its own password</li></ul></li></ol><ol type="1" id="e9de9878-29cf-43b2-8297-4dbc7e19a6c3" class="numbered-list" start="2"><li>AP sends to supplicant ANounce</li></ol><ol type="1" id="e81f9888-304a-4c30-916d-19c11de3b86b" class="numbered-list" start="3"><li>Client uses ANounce and its own SNounce to generate PTK and MIC. SNounce and MIC is then sent to AP</li></ol><ol type="1" id="1bed28e5-8355-4576-aa4a-1326bdefb7da" class="numbered-list" start="4"><li>AP uses the added SNounce information to generate the MIC and PTK and checks if the generated MIC matches the one that the client sent</li></ol><ol type="1" id="3a661cdc-ad3c-4742-aed8-4a5ec7baafab" class="numbered-list" start="5"><li>If matches, the AP sends a key installation message to the supplicant and data transfer starts. Otherwise, the supplicant is deauthenticated.</li></ol><ol type="1" id="39a786ca-d654-4844-a5a7-80fdc15dee31" class="numbered-list" start="6"><li>Supplicant installs key and sends key acknowledgement to AP</li></ol><table id="fdb4c517-92a4-4737-ac1c-3dd18705b5e0" class="simple-table"><tbody></tbody></table><h1 id="e6e96896-eedf-4950-9fa6-a9dda8fadfa0" class="">Detecting Spoofing Attacks</h1><h2 id="66ca8987-f182-4f19-bcca-2a5bec020e04" class="">SSID Spoofing</h2><ul id="225f78f4-4b45-4693-aaa9-cfbb3017a5dc" class="bulleted-list"><li style="list-style-type:disc">when not spoofing the mac address, you can see multiple MAC addresses broadcasting the same SSID<ul id="ee335be5-3306-4035-87be-7f88b528a94e" class="bulleted-list"><li style="list-style-type:circle">not necessarily malicious, such as if a business has multiple access points with the same name, and would like to allow a client to roam around a building without having to manually reconnect to other APs</li></ul><ul id="7a24defb-d6e1-40da-9620-9ccc31e587e9" class="bulleted-list"><li style="list-style-type:circle">if the MAC address is not in a list of authorized MAC addresses, then it might be malicious (this only works if the attacker did not spoof the MAC address)</li></ul></li></ul><ul id="28d4a6b8-24e9-4d7b-82d0-4fe53ef4587c" class="bulleted-list"><li style="list-style-type:disc">could potentially be detected by monitoring the power usage of the real AP versus the potential rogue APs</li></ul><h2 id="8924ea08-d242-4547-af07-cadb07e098d8" class="">Mac Spoofing</h2><ul id="0f740d03-b1b7-4c4c-8d94-543eca510f98" class="bulleted-list"><li style="list-style-type:disc">could still be detected if the length of beacon frames from the legitimate AP and illegitimate AP differ<ul id="d3181acf-1a7a-44ba-a91f-f91d2a1b5fd1" class="bulleted-list"><li style="list-style-type:circle">the rogue AP will have the bare minimum information in the beacon frames, and will typically be less in length than the legitimate AP</li></ul></li></ul><ul id="0468a2ea-038e-4529-a885-8a134ab3c09e" class="bulleted-list"><li style="list-style-type:disc">this could still in theory be bypassed by cloning the beacon frames, however there is no known tool (as far as I know) that does this<ul id="9597074a-3b11-4e8a-b8b9-e121c5c5ee00" class="bulleted-list"><li style="list-style-type:circle">note that air*-ng does not perform this feature</li></ul></li></ul><ul id="a6adf3a6-e71d-4bab-ac7d-5879ff1899f6" class="bulleted-list"><li style="list-style-type:disc">sequence numbers between the rogue and legitimate AP differ (typically by a lot e.g. rogue = 324 and counting while legitimate = 1235 and counting)</li></ul><h1 id="25884ae3-b113-4ab6-98cf-59c6643b7492" class="">Wireless IDS and IPS</h1><ul id="50f78baa-eaa7-4f24-86c7-4083ba06bf13" class="bulleted-list"><li style="list-style-type:disc">the IDS and IPS detect when a client connects to an unauthorized AP, in which case it sends a deauth packet to the client to disconnect it<ol type="1" id="edfd592e-483a-44e6-b8a6-cac6d60ba5bc" class="numbered-list" start="1"><li>This can be sort of circumvented by creating multiple rogue APs across multiple channels </li></ol><ol type="1" id="4387fe30-ac8b-45d3-82e7-8da6697ef735" class="numbered-list" start="2"><li>When the client gets disconnected from the rogue AP, it searches for another AP with the same ESSID, and automatically connects to it   </li></ol></li></ul><ul id="518eacc4-8acf-4771-926d-5fcec8f54f63" class="bulleted-list"><li style="list-style-type:disc">typically channels 1,6, and 11 are good channels to use as they do not overlap each other<figure id="a59e572f-ad0e-4ff4-8082-056a34313885" class="image"><a href="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2015.png"><img src="../../../../images/Wi-Fi%20Pentesting%20Notes%207d71289c40304c7b9668298dce547d7e/Untitled%2015.png"/></a></figure><p id="082798a5-c555-446d-8feb-8f0a85af0e8a" class="">
</p></li></ul><h1 id="dbe474d1-e3f2-49e2-9432-323071ef92ef" class="">Malicious SSID </h1><h2 id="0462bf13-21d3-47d5-9fd9-47cc33e313a4" class="">HTML Injection and XSS</h2><ul id="ed547db2-1281-410c-a147-f2d7035d9e77" class="bulleted-list"><li style="list-style-type:disc">insecure web consoles displaying SSID names could potentially be vulnerable to SSIDs with injected HTML code</li></ul><h2 id="56901a54-d79d-4327-a07a-f1494e13a424" class="">SQLi</h2><ul id="d7a445c2-e3ce-4744-9c27-75b9a1b45346" class="bulleted-list"><li style="list-style-type:disc">an SQLi statement can be put as the ESSID to cause a monitoring device to reboot, or to delete all entries in a database</li></ul><p id="648e7699-7b3e-489b-a09e-72e03f1df93a" class="">
</p><p id="6f9f6c91-dd6b-48a3-8c2f-8e9bcaf38108" class="">
</p></div></article></body></html>
